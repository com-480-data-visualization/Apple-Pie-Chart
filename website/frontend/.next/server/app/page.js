(()=>{var t={};t.id=974,t.ids=[974],t.modules={18:(t,e,n)=>{Promise.resolve().then(n.bind(n,5891))},440:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});var i=n(1658);let r=async t=>[{type:"image/x-icon",sizes:"16x16",url:(0,i.fillMetadataSegment)(".",await t.params,"favicon.ico")+""}]},554:(t,e)=>{"use strict";function n(t){return t.endsWith("/route")}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"isAppRouteRoute",{enumerable:!0,get:function(){return n}})},561:(t,e,n)=>{"use strict";n.r(e),n.d(e,{GlobalError:()=>a.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>p,tree:()=>u});var i=n(5239),r=n(8088),s=n(8170),a=n.n(s),o=n(893),l={};for(let t in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(t)&&(l[t]=()=>o[t]);n.d(e,l);let u={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,1204)),"/Users/liuyiwei/python/Apple-Pie-Chart/website/frontend/src/app/page.tsx"],metadata:{icon:[async t=>(await Promise.resolve().then(n.bind(n,440))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(n.bind(n,4431)),"/Users/liuyiwei/python/Apple-Pie-Chart/website/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(n.t.bind(n,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(n.t.bind(n,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async t=>(await Promise.resolve().then(n.bind(n,440))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/liuyiwei/python/Apple-Pie-Chart/website/frontend/src/app/page.tsx"],h={require:n,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},576:(t,e,n)=>{Promise.resolve().then(n.t.bind(n,6444,23)),Promise.resolve().then(n.t.bind(n,6042,23)),Promise.resolve().then(n.t.bind(n,8170,23)),Promise.resolve().then(n.t.bind(n,9477,23)),Promise.resolve().then(n.t.bind(n,9345,23)),Promise.resolve().then(n.t.bind(n,2089,23)),Promise.resolve().then(n.t.bind(n,6577,23)),Promise.resolve().then(n.t.bind(n,1307,23))},660:(t,e)=>{"use strict";function n(t){let e=5381;for(let n=0;n<t.length;n++)e=(e<<5)+e+t.charCodeAt(n)|0;return e>>>0}function i(t){return n(t).toString(36).slice(0,5)}Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{djb2Hash:function(){return n},hexHash:function(){return i}})},846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1135:()=>{},1204:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});let i=(0,n(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/liuyiwei/python/Apple-Pie-Chart/website/frontend/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/liuyiwei/python/Apple-Pie-Chart/website/frontend/src/app/page.tsx","default")},1437:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{INTERCEPTION_ROUTE_MARKERS:function(){return r},extractInterceptionRouteInformation:function(){return a},isInterceptionRouteAppPath:function(){return s}});let i=n(4722),r=["(..)(..)","(.)","(..)","(...)"];function s(t){return void 0!==t.split("/").find(t=>r.find(e=>t.startsWith(e)))}function a(t){let e,n,s;for(let i of t.split("/"))if(n=r.find(t=>i.startsWith(t))){[e,s]=t.split(n,2);break}if(!e||!n||!s)throw Object.defineProperty(Error("Invalid interception route: "+t+". Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>"),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(e=(0,i.normalizeAppPath)(e),n){case"(.)":s="/"===e?"/"+s:e+"/"+s;break;case"(..)":if("/"===e)throw Object.defineProperty(Error("Invalid interception route: "+t+". Cannot use (..) marker at the root level, use (.) instead."),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});s=e.split("/").slice(0,-1).concat(s).join("/");break;case"(...)":s="/"+s;break;case"(..)(..)":let a=e.split("/");if(a.length<=2)throw Object.defineProperty(Error("Invalid interception route: "+t+". Cannot use (..)(..) marker at the root level or one level up."),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});s=a.slice(0,-2).concat(s).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:e,interceptedRoute:s}}},1658:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{fillMetadataSegment:function(){return p},normalizeMetadataPageToRoute:function(){return f},normalizeMetadataRoute:function(){return d}});let i=n(8304),r=function(t){return t&&t.__esModule?t:{default:t}}(n(8671)),s=n(6341),a=n(4396),o=n(660),l=n(4722),u=n(2958),c=n(5499);function h(t){let e=r.default.dirname(t);if(t.endsWith("/sitemap"))return"";let n="";return e.split("/").some(t=>(0,c.isGroupSegment)(t)||(0,c.isParallelRouteSegment)(t))&&(n=(0,o.djb2Hash)(e).toString(36).slice(0,6)),n}function p(t,e,n){let i=(0,l.normalizeAppPath)(t),o=(0,a.getNamedRouteRegex)(i,{prefixRouteKeys:!1}),c=(0,s.interpolateDynamicPath)(i,e,o),{name:p,ext:d}=r.default.parse(n),f=h(r.default.posix.join(t,p)),m=f?`-${f}`:"";return(0,u.normalizePathSep)(r.default.join(c,`${p}${m}${d}`))}function d(t){if(!(0,i.isMetadataPage)(t))return t;let e=t,n="";if("/robots"===t?e+=".txt":"/manifest"===t?e+=".webmanifest":n=h(t),!e.endsWith("/route")){let{dir:t,name:i,ext:s}=r.default.parse(e);e=r.default.posix.join(t,`${i}${n?`-${n}`:""}${s}`,"route")}return e}function f(t,e){let n=t.endsWith("/route"),i=n?t.slice(0,-6):t,r=i.endsWith("/sitemap")?".xml":"";return(e?`${i}/[__metadata_id__]`:`${i}${r}`)+(n?"/route":"")}},2437:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getPathMatch",{enumerable:!0,get:function(){return r}});let i=n(5362);function r(t,e){let n=[],r=(0,i.pathToRegexp)(t,n,{delimiter:"/",sensitive:"boolean"==typeof(null==e?void 0:e.sensitive)&&e.sensitive,strict:null==e?void 0:e.strict}),s=(0,i.regexpToFunction)((null==e?void 0:e.regexModifier)?new RegExp(e.regexModifier(r.source),r.flags):r,n);return(t,i)=>{if("string"!=typeof t)return!1;let r=s(t);if(!r)return!1;if(null==e?void 0:e.removeUnnamedParams)for(let t of n)"number"==typeof t.name&&delete r.params[t.name];return{...i,...r.params}}}},2667:t=>{t.exports={main:"page_main__GlU4n",brand:"page_brand__f_q1F",title:"page_title__3jonF",gallery:"page_gallery__sJw99",genreExplorer:"page_genreExplorer__mEB43",genreExplorerTitle:"page_genreExplorerTitle__BFKbg",genreBubblesContainer:"page_genreBubblesContainer__y2w_S",bubble:"page_bubble__XiY2Y",genreName:"page_genreName__ZvEKw","usa-general":"page_usa-general___HB8K",france:"page_france__bhdhA","usa-south":"page_usa-south__U69bu","argentina-latin-america":"page_argentina-latin-america__pqAOt",caribbean:"page_caribbean__xo9Fs",brazil:"page_brazil__xdbS3","uk-scotland-ireland":"page_uk-scotland-ireland__McmY9",germany:"page_germany__qZ9O9","uk-england":"page_uk-england__BhgRh",mexico:"page_mexico__gq_DD",spain:"page_spain__i2mdp",nordic:"page_nordic__42M5l",portugal:"page_portugal__KfiXh",italy:"page_italy__1dOJx",japan:"page_japan__jNLyk",turkey:"page_turkey__SiSQ5",genreDetailPanel:"page_genreDetailPanel__M7Wzn",chordAndEmojiContainer:"page_chordAndEmojiContainer__U8Ycj",chordGraph:"page_chordGraph__TS7Oi",emojiBoard:"page_emojiBoard__O51id",emojiContainer:"page_emojiContainer__JcbEh",emojiItem:"page_emojiItem__TLgxh",emoji:"page_emoji__AOGjQ",percentage:"page_percentage__CpU53",chordContainer:"page_chordContainer__316Ie",chordCircle:"page_chordCircle___rdmg",songSelector:"page_songSelector__fawQE",songContainer:"page_songContainer__VgDZH",panelSubTitle:"page_panelSubTitle__5X2Iq",detailPanelTitle:"page_detailPanelTitle__SLDbf",chordColumnContainer:"page_chordColumnContainer__pAgLQ",chordColumn:"page_chordColumn__SVdHd",chordActive:"page_chordActive__QO8Fs",contactSection:"page_contactSection__TxMLV",contactTitle:"page_contactTitle__f9zlz",contactBox:"page_contactBox__sJivB",teamName:"page_teamName__6FxOC",memberList:"page_memberList__XXbZ_",buttonContainer:"page_buttonContainer__XCXUY",button:"page_button__vnlhW",activeButton:"page_activeButton__QMdXl",moodToHarmonyLayout:"page_moodToHarmonyLayout__s7BbR",leftBox:"page_leftBox__oucaR",rightColumn:"page_rightColumn__j8an9",rightTopBox:"page_rightTopBox__ksecX",rightBottomBox:"page_rightBottomBox__nsJqa",sliderContainer:"page_sliderContainer__9hu_f",sliderLabel:"page_sliderLabel__D6Mca",slider:"page_slider__ByN4U"}},2785:(t,e)=>{"use strict";function n(t){let e={};for(let[n,i]of t.entries()){let t=e[n];void 0===t?e[n]=i:Array.isArray(t)?t.push(i):e[n]=[t,i]}return e}function i(t){return"string"==typeof t?t:("number"!=typeof t||isNaN(t))&&"boolean"!=typeof t?"":String(t)}function r(t){let e=new URLSearchParams;for(let[n,r]of Object.entries(t))if(Array.isArray(r))for(let t of r)e.append(n,i(t));else e.set(n,i(r));return e}function s(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(let e of n){for(let n of e.keys())t.delete(n);for(let[n,i]of e.entries())t.append(n,i)}return t}Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{assign:function(){return s},searchParamsToUrlQuery:function(){return n},urlQueryToSearchParams:function(){return r}})},2958:(t,e)=>{"use strict";function n(t){return t.replace(/\\/g,"/")}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"normalizePathSep",{enumerable:!0,get:function(){return n}})},3033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3293:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"escapeStringRegexp",{enumerable:!0,get:function(){return r}});let n=/[|\\{}()[\]^$+*?.-]/,i=/[|\\{}()[\]^$+*?.-]/g;function r(t){return n.test(t)?t.replace(i,"\\$&"):t}},3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3736:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"parseRelativeUrl",{enumerable:!0,get:function(){return r}}),n(4827);let i=n(2785);function r(t,e,n){void 0===n&&(n=!0);let r=new URL("http://n"),s=e?new URL(e,r):t.startsWith(".")?new URL("http://n"):r,{pathname:a,searchParams:o,search:l,hash:u,href:c,origin:h}=new URL(t,s);if(h!==r.origin)throw Object.defineProperty(Error("invariant: invalid relative URL, router received "+t),"__NEXT_ERROR_CODE",{value:"E159",enumerable:!1,configurable:!0});return{pathname:a,query:n?(0,i.searchParamsToUrlQuery)(o):void 0,search:l,hash:u,href:c.slice(h.length)}}},3873:t=>{"use strict";t.exports=require("path")},4396:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{getNamedMiddlewareRegex:function(){return m},getNamedRouteRegex:function(){return f},getRouteRegex:function(){return h},parseParameter:function(){return l}});let i=n(6143),r=n(1437),s=n(3293),a=n(2887),o=/^([^[]*)\[((?:\[[^\]]*\])|[^\]]+)\](.*)$/;function l(t){let e=t.match(o);return e?u(e[2]):u(t)}function u(t){let e=t.startsWith("[")&&t.endsWith("]");e&&(t=t.slice(1,-1));let n=t.startsWith("...");return n&&(t=t.slice(3)),{key:t,repeat:n,optional:e}}function c(t,e,n){let i={},l=1,c=[];for(let h of(0,a.removeTrailingSlash)(t).slice(1).split("/")){let t=r.INTERCEPTION_ROUTE_MARKERS.find(t=>h.startsWith(t)),a=h.match(o);if(t&&a&&a[2]){let{key:e,optional:n,repeat:r}=u(a[2]);i[e]={pos:l++,repeat:r,optional:n},c.push("/"+(0,s.escapeStringRegexp)(t)+"([^/]+?)")}else if(a&&a[2]){let{key:t,repeat:e,optional:r}=u(a[2]);i[t]={pos:l++,repeat:e,optional:r},n&&a[1]&&c.push("/"+(0,s.escapeStringRegexp)(a[1]));let o=e?r?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)";n&&a[1]&&(o=o.substring(1)),c.push(o)}else c.push("/"+(0,s.escapeStringRegexp)(h));e&&a&&a[3]&&c.push((0,s.escapeStringRegexp)(a[3]))}return{parameterizedRoute:c.join(""),groups:i}}function h(t,e){let{includeSuffix:n=!1,includePrefix:i=!1,excludeOptionalTrailingSlash:r=!1}=void 0===e?{}:e,{parameterizedRoute:s,groups:a}=c(t,n,i),o=s;return r||(o+="(?:/)?"),{re:RegExp("^"+o+"$"),groups:a}}function p(t){let e,{interceptionMarker:n,getSafeRouteKey:i,segment:r,routeKeys:a,keyPrefix:o,backreferenceDuplicateKeys:l}=t,{key:c,optional:h,repeat:p}=u(r),d=c.replace(/\W/g,"");o&&(d=""+o+d);let f=!1;(0===d.length||d.length>30)&&(f=!0),isNaN(parseInt(d.slice(0,1)))||(f=!0),f&&(d=i());let m=d in a;o?a[d]=""+o+c:a[d]=c;let g=n?(0,s.escapeStringRegexp)(n):"";return e=m&&l?"\\k<"+d+">":p?"(?<"+d+">.+?)":"(?<"+d+">[^/]+?)",h?"(?:/"+g+e+")?":"/"+g+e}function d(t,e,n,l,u){let c,h=(c=0,()=>{let t="",e=++c;for(;e>0;)t+=String.fromCharCode(97+(e-1)%26),e=Math.floor((e-1)/26);return t}),d={},f=[];for(let c of(0,a.removeTrailingSlash)(t).slice(1).split("/")){let t=r.INTERCEPTION_ROUTE_MARKERS.some(t=>c.startsWith(t)),a=c.match(o);if(t&&a&&a[2])f.push(p({getSafeRouteKey:h,interceptionMarker:a[1],segment:a[2],routeKeys:d,keyPrefix:e?i.NEXT_INTERCEPTION_MARKER_PREFIX:void 0,backreferenceDuplicateKeys:u}));else if(a&&a[2]){l&&a[1]&&f.push("/"+(0,s.escapeStringRegexp)(a[1]));let t=p({getSafeRouteKey:h,segment:a[2],routeKeys:d,keyPrefix:e?i.NEXT_QUERY_PARAM_PREFIX:void 0,backreferenceDuplicateKeys:u});l&&a[1]&&(t=t.substring(1)),f.push(t)}else f.push("/"+(0,s.escapeStringRegexp)(c));n&&a&&a[3]&&f.push((0,s.escapeStringRegexp)(a[3]))}return{namedParameterizedRoute:f.join(""),routeKeys:d}}function f(t,e){var n,i,r;let s=d(t,e.prefixRouteKeys,null!=(n=e.includeSuffix)&&n,null!=(i=e.includePrefix)&&i,null!=(r=e.backreferenceDuplicateKeys)&&r),a=s.namedParameterizedRoute;return e.excludeOptionalTrailingSlash||(a+="(?:/)?"),{...h(t,e),namedRegex:"^"+a+"$",routeKeys:s.routeKeys}}function m(t,e){let{parameterizedRoute:n}=c(t,!1,!1),{catchAll:i=!0}=e;if("/"===n)return{namedRegex:"^/"+(i?".*":"")+"$"};let{namedParameterizedRoute:r}=d(t,!1,!1,!1,!1);return{namedRegex:"^"+r+(i?"(?:(/.*)?)":"")+"$"}}},4431:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o,metadata:()=>a});var i=n(7413),r=n(7339),s=n.n(r);n(1135);let a={title:"Music Chords World",description:"Explore the beautiful world of music chords"};function o({children:t}){return(0,i.jsxs)("html",{lang:"en",children:[(0,i.jsx)("head",{children:(0,i.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@700&display=swap",rel:"stylesheet"})}),(0,i.jsx)("body",{className:s().className,children:t})]})}},4722:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return a}});let i=n(5531),r=n(5499);function s(t){return(0,i.ensureLeadingSlash)(t.split("/").reduce((t,e,n,i)=>!e||(0,r.isGroupSegment)(e)||"@"===e[0]||("page"===e||"route"===e)&&n===i.length-1?t:t+"/"+e,""))}function a(t){return t.replace(/\.rsc($|\?)/,"$1")}},4827:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{DecodeError:function(){return f},MiddlewareNotFoundError:function(){return y},MissingStaticPage:function(){return v},NormalizeError:function(){return m},PageNotFoundError:function(){return g},SP:function(){return p},ST:function(){return d},WEB_VITALS:function(){return n},execOnce:function(){return i},getDisplayName:function(){return l},getLocationOrigin:function(){return a},getURL:function(){return o},isAbsoluteUrl:function(){return s},isResSent:function(){return u},loadGetInitialProps:function(){return h},normalizeRepeatedSlashes:function(){return c},stringifyError:function(){return x}});let n=["CLS","FCP","FID","INP","LCP","TTFB"];function i(t){let e,n=!1;return function(){for(var i=arguments.length,r=Array(i),s=0;s<i;s++)r[s]=arguments[s];return n||(n=!0,e=t(...r)),e}}let r=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,s=t=>r.test(t);function a(){let{protocol:t,hostname:e,port:n}=window.location;return t+"//"+e+(n?":"+n:"")}function o(){let{href:t}=window.location,e=a();return t.substring(e.length)}function l(t){return"string"==typeof t?t:t.displayName||t.name||"Unknown"}function u(t){return t.finished||t.headersSent}function c(t){let e=t.split("?");return e[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(e[1]?"?"+e.slice(1).join("?"):"")}async function h(t,e){let n=e.res||e.ctx&&e.ctx.res;if(!t.getInitialProps)return e.ctx&&e.Component?{pageProps:await h(e.Component,e.ctx)}:{};let i=await t.getInitialProps(e);if(n&&u(n))return i;if(!i)throw Object.defineProperty(Error('"'+l(t)+'.getInitialProps()" should resolve to an object. But found "'+i+'" instead.'),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return i}let p="undefined"!=typeof performance,d=p&&["mark","measure","getEntriesByName"].every(t=>"function"==typeof performance[t]);class f extends Error{}class m extends Error{}class g extends Error{constructor(t){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+t}}class v extends Error{constructor(t,e){super(),this.message="Failed to load static file for page: "+t+" "+e}}class y extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function x(t){return JSON.stringify({message:t.message,stack:t.stack})}},5362:t=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var e={};(()=>{function t(t,e){void 0===e&&(e={});for(var n=function(t){for(var e=[],n=0;n<t.length;){var i=t[n];if("*"===i||"+"===i||"?"===i){e.push({type:"MODIFIER",index:n,value:t[n++]});continue}if("\\"===i){e.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});continue}if("{"===i){e.push({type:"OPEN",index:n,value:t[n++]});continue}if("}"===i){e.push({type:"CLOSE",index:n,value:t[n++]});continue}if(":"===i){for(var r="",s=n+1;s<t.length;){var a=t.charCodeAt(s);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||95===a){r+=t[s++];continue}break}if(!r)throw TypeError("Missing parameter name at "+n);e.push({type:"NAME",index:n,value:r}),n=s;continue}if("("===i){var o=1,l="",s=n+1;if("?"===t[s])throw TypeError('Pattern cannot start with "?" at '+s);for(;s<t.length;){if("\\"===t[s]){l+=t[s++]+t[s++];continue}if(")"===t[s]){if(0==--o){s++;break}}else if("("===t[s]&&(o++,"?"!==t[s+1]))throw TypeError("Capturing groups are not allowed at "+s);l+=t[s++]}if(o)throw TypeError("Unbalanced pattern at "+n);if(!l)throw TypeError("Missing pattern at "+n);e.push({type:"PATTERN",index:n,value:l}),n=s;continue}e.push({type:"CHAR",index:n,value:t[n++]})}return e.push({type:"END",index:n,value:""}),e}(t),i=e.prefixes,s=void 0===i?"./":i,a="[^"+r(e.delimiter||"/#?")+"]+?",o=[],l=0,u=0,c="",h=function(t){if(u<n.length&&n[u].type===t)return n[u++].value},p=function(t){var e=h(t);if(void 0!==e)return e;var i=n[u];throw TypeError("Unexpected "+i.type+" at "+i.index+", expected "+t)},d=function(){for(var t,e="";t=h("CHAR")||h("ESCAPED_CHAR");)e+=t;return e};u<n.length;){var f=h("CHAR"),m=h("NAME"),g=h("PATTERN");if(m||g){var v=f||"";-1===s.indexOf(v)&&(c+=v,v=""),c&&(o.push(c),c=""),o.push({name:m||l++,prefix:v,suffix:"",pattern:g||a,modifier:h("MODIFIER")||""});continue}var y=f||h("ESCAPED_CHAR");if(y){c+=y;continue}if(c&&(o.push(c),c=""),h("OPEN")){var v=d(),x=h("NAME")||"",b=h("PATTERN")||"",w=d();p("CLOSE"),o.push({name:x||(b?l++:""),pattern:x&&!b?a:b,prefix:v,suffix:w,modifier:h("MODIFIER")||""});continue}p("END")}return o}function n(t,e){void 0===e&&(e={});var n=s(e),i=e.encode,r=void 0===i?function(t){return t}:i,a=e.validate,o=void 0===a||a,l=t.map(function(t){if("object"==typeof t)return RegExp("^(?:"+t.pattern+")$",n)});return function(e){for(var n="",i=0;i<t.length;i++){var s=t[i];if("string"==typeof s){n+=s;continue}var a=e?e[s.name]:void 0,u="?"===s.modifier||"*"===s.modifier,c="*"===s.modifier||"+"===s.modifier;if(Array.isArray(a)){if(!c)throw TypeError('Expected "'+s.name+'" to not repeat, but got an array');if(0===a.length){if(u)continue;throw TypeError('Expected "'+s.name+'" to not be empty')}for(var h=0;h<a.length;h++){var p=r(a[h],s);if(o&&!l[i].test(p))throw TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but got "'+p+'"');n+=s.prefix+p+s.suffix}continue}if("string"==typeof a||"number"==typeof a){var p=r(String(a),s);if(o&&!l[i].test(p))throw TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but got "'+p+'"');n+=s.prefix+p+s.suffix;continue}if(!u){var d=c?"an array":"a string";throw TypeError('Expected "'+s.name+'" to be '+d)}}return n}}function i(t,e,n){void 0===n&&(n={});var i=n.decode,r=void 0===i?function(t){return t}:i;return function(n){var i=t.exec(n);if(!i)return!1;for(var s=i[0],a=i.index,o=Object.create(null),l=1;l<i.length;l++)!function(t){if(void 0!==i[t]){var n=e[t-1];"*"===n.modifier||"+"===n.modifier?o[n.name]=i[t].split(n.prefix+n.suffix).map(function(t){return r(t,n)}):o[n.name]=r(i[t],n)}}(l);return{path:s,index:a,params:o}}}function r(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function s(t){return t&&t.sensitive?"":"i"}function a(t,e,n){void 0===n&&(n={});for(var i=n.strict,a=void 0!==i&&i,o=n.start,l=n.end,u=n.encode,c=void 0===u?function(t){return t}:u,h="["+r(n.endsWith||"")+"]|$",p="["+r(n.delimiter||"/#?")+"]",d=void 0===o||o?"^":"",f=0;f<t.length;f++){var m=t[f];if("string"==typeof m)d+=r(c(m));else{var g=r(c(m.prefix)),v=r(c(m.suffix));if(m.pattern)if(e&&e.push(m),g||v)if("+"===m.modifier||"*"===m.modifier){var y="*"===m.modifier?"?":"";d+="(?:"+g+"((?:"+m.pattern+")(?:"+v+g+"(?:"+m.pattern+"))*)"+v+")"+y}else d+="(?:"+g+"("+m.pattern+")"+v+")"+m.modifier;else d+="("+m.pattern+")"+m.modifier;else d+="(?:"+g+v+")"+m.modifier}}if(void 0===l||l)a||(d+=p+"?"),d+=n.endsWith?"(?="+h+")":"$";else{var x=t[t.length-1],b="string"==typeof x?p.indexOf(x[x.length-1])>-1:void 0===x;a||(d+="(?:"+p+"(?="+h+"))?"),b||(d+="(?="+p+"|"+h+")")}return new RegExp(d,s(n))}function o(e,n,i){if(e instanceof RegExp){if(!n)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var l=0;l<r.length;l++)n.push({name:l,prefix:"",suffix:"",modifier:"",pattern:""});return e}return Array.isArray(e)?RegExp("(?:"+e.map(function(t){return o(t,n,i).source}).join("|")+")",s(i)):a(t(e,i),n,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.parse=t,e.compile=function(e,i){return n(t(e,i),i)},e.tokensToFunction=n,e.match=function(t,e){var n=[];return i(o(t,n,e),n,e)},e.regexpToFunction=i,e.tokensToRegexp=a,e.pathToRegexp=o})(),t.exports=e})()},5526:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{compileNonPath:function(){return c},matchHas:function(){return u},parseDestination:function(){return h},prepareDestination:function(){return p}});let i=n(5362),r=n(3293),s=n(6759),a=n(1437),o=n(8212);function l(t){return t.replace(/__ESC_COLON_/gi,":")}function u(t,e,n,i){void 0===n&&(n=[]),void 0===i&&(i=[]);let r={},s=n=>{let i,s=n.key;switch(n.type){case"header":s=s.toLowerCase(),i=t.headers[s];break;case"cookie":i="cookies"in t?t.cookies[n.key]:(0,o.getCookieParser)(t.headers)()[n.key];break;case"query":i=e[s];break;case"host":{let{host:e}=(null==t?void 0:t.headers)||{};i=null==e?void 0:e.split(":",1)[0].toLowerCase()}}if(!n.value&&i)return r[function(t){let e="";for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);(i>64&&i<91||i>96&&i<123)&&(e+=t[n])}return e}(s)]=i,!0;if(i){let t=RegExp("^"+n.value+"$"),e=Array.isArray(i)?i.slice(-1)[0].match(t):i.match(t);if(e)return Array.isArray(e)&&(e.groups?Object.keys(e.groups).forEach(t=>{r[t]=e.groups[t]}):"host"===n.type&&e[0]&&(r.host=e[0])),!0}return!1};return!(!n.every(t=>s(t))||i.some(t=>s(t)))&&r}function c(t,e){if(!t.includes(":"))return t;for(let n of Object.keys(e))t.includes(":"+n)&&(t=t.replace(RegExp(":"+n+"\\*","g"),":"+n+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+n+"\\?","g"),":"+n+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+n+"\\+","g"),":"+n+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+n+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+n));return t=t.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,i.compile)("/"+t,{validate:!1})(e).slice(1)}function h(t){let e=t.destination;for(let n of Object.keys({...t.params,...t.query}))n&&(e=e.replace(RegExp(":"+(0,r.escapeStringRegexp)(n),"g"),"__ESC_COLON_"+n));let n=(0,s.parseUrl)(e),i=n.pathname;i&&(i=l(i));let a=n.href;a&&(a=l(a));let o=n.hostname;o&&(o=l(o));let u=n.hash;return u&&(u=l(u)),{...n,pathname:i,hostname:o,href:a,hash:u}}function p(t){let e,n,r=Object.assign({},t.query),s=h(t),{hostname:o,query:u}=s,p=s.pathname;s.hash&&(p=""+p+s.hash);let d=[],f=[];for(let t of((0,i.pathToRegexp)(p,f),f))d.push(t.name);if(o){let t=[];for(let e of((0,i.pathToRegexp)(o,t),t))d.push(e.name)}let m=(0,i.compile)(p,{validate:!1});for(let[n,r]of(o&&(e=(0,i.compile)(o,{validate:!1})),Object.entries(u)))Array.isArray(r)?u[n]=r.map(e=>c(l(e),t.params)):"string"==typeof r&&(u[n]=c(l(r),t.params));let g=Object.keys(t.params).filter(t=>"nextInternalLocale"!==t);if(t.appendParamsToQuery&&!g.some(t=>d.includes(t)))for(let e of g)e in u||(u[e]=t.params[e]);if((0,a.isInterceptionRouteAppPath)(p))for(let e of p.split("/")){let n=a.INTERCEPTION_ROUTE_MARKERS.find(t=>e.startsWith(t));if(n){"(..)(..)"===n?(t.params["0"]="(..)",t.params["1"]="(..)"):t.params["0"]=n;break}}try{let[i,r]=(n=m(t.params)).split("#",2);e&&(s.hostname=e(t.params)),s.pathname=i,s.hash=(r?"#":"")+(r||""),delete s.search}catch(t){if(t.message.match(/Expected .*? to not repeat, but got an array/))throw Object.defineProperty(Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match"),"__NEXT_ERROR_CODE",{value:"E329",enumerable:!1,configurable:!0});throw t}return s.query={...r,...s.query},{newUrl:n,destQuery:u,parsedDestination:s}}},5531:(t,e)=>{"use strict";function n(t){return t.startsWith("/")?t:"/"+t}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ensureLeadingSlash",{enumerable:!0,get:function(){return n}})},5738:(t,e,n)=>{Promise.resolve().then(n.bind(n,1204))},5891:(t,e,n)=>{"use strict";let i,r,s,a,o,l,u,c,h,p,d,f,m,g;n.r(e),n.d(e,{default:()=>u8});var v,y,x,b,w,T,A,C,k=n(687),S=n(2667),M=n.n(S),E=n(3210);function O(t,e){let n,i;if(void 0===e)for(let e of t)null!=e&&(void 0===n?e>=e&&(n=i=e):(n>e&&(n=e),i<e&&(i=e)));else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(void 0===n?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}var R=Array.prototype,N=R.slice;function P(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function D(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function I(t){let e,n,i;function r(t,i,s=0,a=t.length){if(s<a){if(0!==e(i,i))return a;do{let e=s+a>>>1;0>n(t[e],i)?s=e+1:a=e}while(s<a)}return s}return 2!==t.length?(e=P,n=(e,n)=>P(t(e),n),i=(e,n)=>t(e)-n):(e=t===P||t===D?t:j,n=t,i=t),{left:r,center:function(t,e,n=0,s=t.length){let a=r(t,e,n,s-1);return a>n&&i(t[a-1],e)>-i(t[a],e)?a-1:a},right:function(t,i,r=0,s=t.length){if(r<s){if(0!==e(i,i))return s;do{let e=r+s>>>1;0>=n(t[e],i)?r=e+1:s=e}while(r<s)}return r}}}function j(){return 0}R.map;let V=I(P),F=V.right;V.left,I(function(t){return null===t?NaN:+t}).center;function q(t){return t}let $=Math.sqrt(50),B=Math.sqrt(10),L=Math.sqrt(2);function W(t,e,n){let i,r,s,a=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(a)),l=a/Math.pow(10,o),u=l>=$?10:l>=B?5:l>=L?2:1;return(o<0?(i=Math.round(t*(s=Math.pow(10,-o)/u)),r=Math.round(e*s),i/s<t&&++i,r/s>e&&--r,s=-s):(i=Math.round(t/(s=Math.pow(10,o)*u)),r=Math.round(e/s),i*s<t&&++i,r*s>e&&--r),r<i&&.5<=n&&n<2)?W(t,e,2*n):[i,r,s]}function z(t,e,n){if(e*=1,t*=1,!((n*=1)>0))return[];if(t===e)return[t];let i=e<t,[r,s,a]=i?W(e,t,n):W(t,e,n);if(!(s>=r))return[];let o=s-r+1,l=Array(o);if(i)if(a<0)for(let t=0;t<o;++t)l[t]=-((s-t)/a);else for(let t=0;t<o;++t)l[t]=(s-t)*a;else if(a<0)for(let t=0;t<o;++t)l[t]=-((r+t)/a);else for(let t=0;t<o;++t)l[t]=(r+t)*a;return l}function U(t,e,n){return W(t*=1,e*=1,n*=1)[2]}function X(t){return Math.max(1,Math.ceil(Math.log(function(t,e){let n=0;for(let e of t)null!=e&&(e*=1)>=e&&++n;return n}(t))/Math.LN2)+1)}function G(){var t=q,e=O,n=X;function i(i){Array.isArray(i)||(i=Array.from(i));var r,s,a,o=i.length,l=Array(o);for(r=0;r<o;++r)l[r]=t(i[r],r,i);var u=e(l),c=u[0],h=u[1],p=n(l,c,h);if(!Array.isArray(p)){let t=h,n=+p;if(e===O&&([c,h]=function(t,e,n){let i;for(;;){let r=U(t,e,n);if(r===i||0===r||!isFinite(r))return[t,e];r>0?(t=Math.floor(t/r)*r,e=Math.ceil(e/r)*r):r<0&&(t=Math.ceil(t*r)/r,e=Math.floor(e*r)/r),i=r}}(c,h,n)),(p=z(c,h,n))[0]<=c&&(a=U(c,h,n)),p[p.length-1]>=h)if(t>=h&&e===O){let t=U(c,h,n);isFinite(t)&&(t>0?h=(Math.floor(h/t)+1)*t:t<0&&(h=-((Math.ceil(-(h*t))+1)/t)))}else p.pop()}for(var d=p.length,f=0,m=d;p[f]<=c;)++f;for(;p[m-1]>h;)--m;(f||m<d)&&(p=p.slice(f,m),d=m-f);var g,v=Array(d+1);for(r=0;r<=d;++r)(g=v[r]=[]).x0=r>0?p[r-1]:c,g.x1=r<d?p[r]:h;if(isFinite(a)){if(a>0)for(r=0;r<o;++r)null!=(s=l[r])&&c<=s&&s<=h&&v[Math.min(d,Math.floor((s-c)/a))].push(i[r]);else if(a<0){for(r=0;r<o;++r)if(null!=(s=l[r])&&c<=s&&s<=h){let t=Math.floor((c-s)*a);v[Math.min(d,t+(p[t]<=s))].push(i[r])}}}else for(r=0;r<o;++r)null!=(s=l[r])&&c<=s&&s<=h&&v[F(p,s,0,d)].push(i[r]);return v}return i.value=function(e){return arguments.length?(t="function"==typeof e?e:()=>e,i):t},i.domain=function(t){var n;return arguments.length?(e="function"==typeof t?t:(n=[t[0],t[1]],()=>n),i):e},i.thresholds=function(t){var e;return arguments.length?(n="function"==typeof t?t:(e=Array.isArray(t)?N.call(t):t,()=>e),i):n},i}function H(t,e){let n;if(void 0===e)for(let e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function Y(t,e){let n=0,i=0;if(void 0===e)for(let e of t)null!=e&&(e*=1)>=e&&(++n,i+=e);else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(s*=1)>=s&&(++n,i+=s)}if(n)return i/n}function Z(t,e){let n;if(void 0===e)for(let e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function Q(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:+(t>e))}function K(t,e,n){let i=t[e];t[e]=t[n],t[n]=i}function J(t,e){var n=t,i=.5;if(!(!(r=(n=Float64Array.from(function*(t,e){if(void 0===e)for(let e of t)null!=e&&(e*=1)>=e&&(yield e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(i*=1)>=i&&(yield i)}}(n,e))).length)||isNaN(i*=1))){if(i<=0||r<2)return Z(n);if(i>=1)return H(n);var r,s=(r-1)*i,a=Math.floor(s),o=H((function t(e,n,i=0,r=1/0,s){if(n=Math.floor(n),i=Math.floor(Math.max(0,i)),r=Math.floor(Math.min(e.length-1,r)),!(i<=n&&n<=r))return e;for(s=void 0===s?Q:function(t=P){if(t===P)return Q;if("function"!=typeof t)throw TypeError("compare is not a function");return(e,n)=>{let i=t(e,n);return i||0===i?i:(0===t(n,n))-(0===t(e,e))}}(s);r>i;){if(r-i>600){let a=r-i+1,o=n-i+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(o-a/2<0?-1:1),h=Math.max(i,Math.floor(n-o*u/a+c)),p=Math.min(r,Math.floor(n+(a-o)*u/a+c));t(e,n,h,p,s)}let a=e[n],o=i,l=r;for(K(e,i,n),s(e[r],a)>0&&K(e,i,r);o<l;){for(K(e,o,l),++o,--l;0>s(e[o],a);)++o;for(;s(e[l],a)>0;)--l}0===s(e[i],a)?K(e,i,l):K(e,++l,r),l<=n&&(i=l+1),n<=l&&(r=l-1)}return e})(n,a).subarray(0,a+1));return o+(Z(n.subarray(a+1))-o)*(s-a)}}function tt(t){return t}function te(t){return"translate("+t+",0)"}function tn(t){return"translate(0,"+t+")"}function ti(){return!this.__axis}function tr(t,e){var n=[],i=null,r=null,s=6,a=6,o=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,u=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",h=1===t||3===t?te:tn;function p(p){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,f=null==r?e.tickFormat?e.tickFormat.apply(e,n):tt:r,m=Math.max(s,0)+o,g=e.range(),v=+g[0]+l,y=+g[g.length-1]+l,x=(e.bandwidth?function(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}:function(t){return e=>+t(e)})(e.copy(),l),b=p.selection?p.selection():p,w=b.selectAll(".domain").data([null]),T=b.selectAll(".tick").data(d,e).order(),A=T.exit(),C=T.enter().append("g").attr("class","tick"),k=T.select("line"),S=T.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),T=T.merge(C),k=k.merge(C.append("line").attr("stroke","currentColor").attr(c+"2",u*s)),S=S.merge(C.append("text").attr("fill","currentColor").attr(c,u*m).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),p!==b&&(w=w.transition(p),T=T.transition(p),k=k.transition(p),S=S.transition(p),A=A.transition(p).attr("opacity",1e-6).attr("transform",function(t){return isFinite(t=x(t))?h(t+l):this.getAttribute("transform")}),C.attr("opacity",1e-6).attr("transform",function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:x(t))+l)})),A.remove(),w.attr("d",4===t||2===t?a?"M"+u*a+","+v+"H"+l+"V"+y+"H"+u*a:"M"+l+","+v+"V"+y:a?"M"+v+","+u*a+"V"+l+"H"+y+"V"+u*a:"M"+v+","+l+"H"+y),T.attr("opacity",1).attr("transform",function(t){return h(x(t)+l)}),k.attr(c+"2",u*s),S.attr(c,u*m).text(f),b.filter(ti).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each(function(){this.__axis=x})}return p.scale=function(t){return arguments.length?(e=t,p):e},p.ticks=function(){return n=Array.from(arguments),p},p.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),p):n.slice()},p.tickValues=function(t){return arguments.length?(i=null==t?null:Array.from(t),p):i&&i.slice()},p.tickFormat=function(t){return arguments.length?(r=t,p):r},p.tickSize=function(t){return arguments.length?(s=a=+t,p):s},p.tickSizeInner=function(t){return arguments.length?(s=+t,p):s},p.tickSizeOuter=function(t){return arguments.length?(a=+t,p):a},p.tickPadding=function(t){return arguments.length?(o=+t,p):o},p.offset=function(t){return arguments.length?(l=+t,p):l},p}function ts(){}function ta(t){return null==t?ts:function(){return this.querySelector(t)}}function to(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function tl(){return[]}function tu(t){return null==t?tl:function(){return this.querySelectorAll(t)}}function tc(t){return function(){return this.matches(t)}}function th(t){return function(e){return e.matches(t)}}var tp=Array.prototype.find;function td(){return this.firstElementChild}var tf=Array.prototype.filter;function tm(){return Array.from(this.children)}function tg(t){return Array(t.length)}function t_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function tv(t,e,n,i,r,s){for(var a,o=0,l=e.length,u=s.length;o<u;++o)(a=e[o])?(a.__data__=s[o],i[o]=a):n[o]=new t_(t,s[o]);for(;o<l;++o)(a=e[o])&&(r[o]=a)}function ty(t,e,n,i,r,s,a){var o,l,u,c=new Map,h=e.length,p=s.length,d=Array(h);for(o=0;o<h;++o)(l=e[o])&&(d[o]=u=a.call(l,l.__data__,o,e)+"",c.has(u)?r[o]=l:c.set(u,l));for(o=0;o<p;++o)u=a.call(t,s[o],o,s)+"",(l=c.get(u))?(i[o]=l,l.__data__=s[o],c.delete(u)):n[o]=new t_(t,s[o]);for(o=0;o<h;++o)(l=e[o])&&c.get(d[o])===l&&(r[o]=l)}function tx(t){return t.__data__}function tb(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}t_.prototype={constructor:t_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var tw="http://www.w3.org/1999/xhtml";let tT={svg:"http://www.w3.org/2000/svg",xhtml:tw,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function tA(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),tT.hasOwnProperty(e)?{space:tT[e],local:t}:t}function tC(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function tk(t,e){return t.style.getPropertyValue(e)||tC(t).getComputedStyle(t,null).getPropertyValue(e)}function tS(t){return t.trim().split(/^|\s+/)}function tM(t){return t.classList||new tE(t)}function tE(t){this._node=t,this._names=tS(t.getAttribute("class")||"")}function tO(t,e){for(var n=tM(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function tR(t,e){for(var n=tM(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function tN(){this.textContent=""}function tP(){this.innerHTML=""}function tD(){this.nextSibling&&this.parentNode.appendChild(this)}function tI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function tj(t){var e=tA(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===tw&&e.documentElement.namespaceURI===tw?e.createElement(t):e.createElementNS(n,t)}})(e)}function tV(){return null}function tF(){var t=this.parentNode;t&&t.removeChild(this)}function tq(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function t$(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tB(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)(n=e[i],t.type&&n.type!==t.type||n.name!==t.name)?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function tL(t,e,n){return function(){var i,r=this.__on,s=function(t){e.call(this,t,this.__data__)};if(r){for(var a=0,o=r.length;a<o;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function tW(t,e,n){var i=tC(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}tE.prototype={add:function(t){0>this._names.indexOf(t)&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var tz=[null];function tU(t,e){this._groups=t,this._parents=e}function tX(){return new tU([[document.documentElement]],tz)}tU.prototype=tX.prototype={constructor:tU,select:function(t){"function"!=typeof t&&(t=ta(t));for(var e=this._groups,n=e.length,i=Array(n),r=0;r<n;++r)for(var s,a,o=e[r],l=o.length,u=i[r]=Array(l),c=0;c<l;++c)(s=o[c])&&(a=t.call(s,s.__data__,c,o))&&("__data__"in s&&(a.__data__=s.__data__),u[c]=a);return new tU(i,this._parents)},selectAll:function(t){if("function"==typeof t){var e;e=t,t=function(){return to(e.apply(this,arguments))}}else t=tu(t);for(var n=this._groups,i=n.length,r=[],s=[],a=0;a<i;++a)for(var o,l=n[a],u=l.length,c=0;c<u;++c)(o=l[c])&&(r.push(t.call(o,o.__data__,c,l)),s.push(o));return new tU(r,s)},selectChild:function(t){var e;return this.select(null==t?td:(e="function"==typeof t?t:th(t),function(){return tp.call(this.children,e)}))},selectChildren:function(t){var e;return this.selectAll(null==t?tm:(e="function"==typeof t?t:th(t),function(){return tf.call(this.children,e)}))},filter:function(t){"function"!=typeof t&&(t=tc(t));for(var e=this._groups,n=e.length,i=Array(n),r=0;r<n;++r)for(var s,a=e[r],o=a.length,l=i[r]=[],u=0;u<o;++u)(s=a[u])&&t.call(s,s.__data__,u,a)&&l.push(s);return new tU(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,tx);var n=e?ty:tv,i=this._parents,r=this._groups;"function"!=typeof t&&(y=t,t=function(){return y});for(var s=r.length,a=Array(s),o=Array(s),l=Array(s),u=0;u<s;++u){var c=i[u],h=r[u],p=h.length,d="object"==typeof(v=t.call(c,c&&c.__data__,u,i))&&"length"in v?v:Array.from(v),f=d.length,m=o[u]=Array(f),g=a[u]=Array(f);n(c,h,m,g,l[u]=Array(p),d,e);for(var v,y,x,b,w=0,T=0;w<f;++w)if(x=m[w]){for(w>=T&&(T=w+1);!(b=g[T])&&++T<f;);x._next=b||null}}return(a=new tU(a,i))._enter=o,a._exit=l,a},enter:function(){return new tU(this._enter||this._groups.map(tg),this._parents)},exit:function(){return new tU(this._exit||this._groups.map(tg),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,a=Math.min(r,s),o=Array(r),l=0;l<a;++l)for(var u,c=n[l],h=i[l],p=c.length,d=o[l]=Array(p),f=0;f<p;++f)(u=c[f]||h[f])&&(d[f]=u);for(;l<r;++l)o[l]=n[l];return new tU(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,a=r[s];--s>=0;)(i=r[s])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=tb);for(var n=this._groups,i=n.length,r=Array(i),s=0;s<i;++s){for(var a,o=n[s],l=o.length,u=r[s]=Array(l),c=0;c<l;++c)(a=o[c])&&(u[c]=a);u.sort(e)}return new tU(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var a=i[r];if(a)return a}return null},size:function(){let t=0;for(let e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],a=0,o=s.length;a<o;++a)(r=s[a])&&t.call(r,r.__data__,a,s);return this},attr:function(t,e){var n=tA(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):tk(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=tS(t+"");if(arguments.length<2){for(var i=tM(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?tO:tR)(this,t)}}:e?function(t){return function(){tO(this,t)}}:function(t){return function(){tR(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?tN:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?tP:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(tD)},lower:function(){return this.each(tI)},append:function(t){var e="function"==typeof t?t:tj(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:tj(t),i=null==e?tV:"function"==typeof e?e:ta(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(tF)},clone:function(t){return this.select(t?t$:tq)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),a=s.length;if(arguments.length<2){var o=this.node().__on;if(o){for(var l,u=0,c=o.length;u<c;++u)for(i=0,l=o[u];i<a;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value}return}for(i=0,o=e?tL:tB;i<a;++i)this.each(o(s[i],e,n));return this},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return tW(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return tW(this,t,e)}})(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,a=r.length;s<a;++s)(i=r[s])&&(yield i)}};var tG={value:()=>{}};function tH(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw Error("illegal type: "+t);i[t]=[]}return new tY(i)}function tY(t){this._=t}function tZ(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=tG,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}tY.prototype=tH.prototype={constructor:tY,on:function(t,e){var n,i=this._,r=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw Error("unknown type: "+t);return{type:t,name:e}}),s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((n=(t=r[s]).type)&&(n=function(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}(i[n],t.name)))return n;return}if(null!=e&&"function"!=typeof e)throw Error("invalid callback: "+e);for(;++s<a;)if(n=(t=r[s]).type)i[n]=tZ(i[n],t.name,e);else if(null==e)for(n in i)i[n]=tZ(i[n],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new tY(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(i=this._[t],s=0,n=i.length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};var tQ,tK,tJ=0,t0=0,t1=0,t2=0,t3=0,t4=0,t5="object"==typeof performance&&performance.now?performance:Date,t8="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function t6(){return t3||(t8(t9),t3=t5.now()+t4)}function t9(){t3=0}function t7(){this._call=this._time=this._next=null}function et(t,e,n){var i=new t7;return i.restart(t,e,n),i}function ee(){t3=(t2=t5.now())+t4,tJ=t0=0;try{t6(),++tJ;for(var t,e=tQ;e;)(t=t3-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tJ}finally{tJ=0,function(){for(var t,e,n=tQ,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:tQ=e);tK=t,ei(i)}(),t3=0}}function en(){var t=t5.now(),e=t-t2;e>1e3&&(t4-=e,t2=t)}function ei(t){!tJ&&(t0&&(t0=clearTimeout(t0)),t-t3>24?(t<1/0&&(t0=setTimeout(ee,t-t5.now()-t4)),t1&&(t1=clearInterval(t1))):(t1||(t2=t5.now(),t1=setInterval(en,1e3)),tJ=1,t8(ee)))}function er(t,e,n){var i=new t7;return e=null==e?0:+e,i.restart(n=>{i.stop(),t(n+e)},e,n),i}t7.prototype=et.prototype={constructor:t7,restart:function(t,e,n){if("function"!=typeof t)throw TypeError("callback is not a function");n=(null==n?t6():+n)+(null==e?0:+e),this._next||tK===this||(tK?tK._next=this:tQ=this,tK=this),this._call=t,this._time=n,ei()},stop:function(){this._call&&(this._call=null,this._time=1/0,ei())}};var es=tH("start","end","cancel","interrupt"),ea=[];function eo(t,e,n,i,r,s){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function s(l){var u,c,h,p;if(1!==n.state)return o();for(u in r)if((p=r[u]).name===n.name){if(3===p.state)return er(s);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete r[u]):+u<e&&(p.state=6,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete r[u])}if(er(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(u=0,n.state=3,i=Array(h=n.tween.length),c=-1;u<h;++u)(p=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=p);i.length=c+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(o),n.state=5,1),s=-1,a=i.length;++s<a;)i[s].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),o())}function o(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=et(function(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)},0,n.time)}(t,n,{name:e,index:i,group:r,on:es,tween:ea,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function el(t,e){var n=ec(t,e);if(n.state>0)throw Error("too late; already scheduled");return n}function eu(t,e){var n=ec(t,e);if(n.state>3)throw Error("too late; already running");return n}function ec(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw Error("transition not found");return n}function eh(t,e){return t*=1,e*=1,function(n){return t*(1-n)+e*n}}var ep=180/Math.PI,ed={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ef(t,e,n,i,r,s){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*ep,skewX:Math.atan(l)*ep,scaleX:a,scaleY:o}}function em(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(s,a){var o,l,u,c,h=[],p=[];return s=t(s),a=t(a),!function(t,i,r,s,a,o){if(t!==r||i!==s){var l=a.push("translate(",null,e,null,n);o.push({i:l-4,x:eh(t,r)},{i:l-2,x:eh(i,s)})}else(r||s)&&a.push("translate("+r+e+s+n)}(s.translateX,s.translateY,a.translateX,a.translateY,h,p),o=s.rotate,l=a.rotate,o!==l?(o-l>180?l+=360:l-o>180&&(o+=360),p.push({i:h.push(r(h)+"rotate(",null,i)-2,x:eh(o,l)})):l&&h.push(r(h)+"rotate("+l+i),u=s.skewX,c=a.skewX,u!==c?p.push({i:h.push(r(h)+"skewX(",null,i)-2,x:eh(u,c)}):c&&h.push(r(h)+"skewX("+c+i),!function(t,e,n,i,s,a){if(t!==n||e!==i){var o=s.push(r(s)+"scale(",null,",",null,")");a.push({i:o-4,x:eh(t,n)},{i:o-2,x:eh(e,i)})}else(1!==n||1!==i)&&s.push(r(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,a.scaleX,a.scaleY,h,p),s=a=null,function(t){for(var e,n=-1,i=p.length;++n<i;)h[(e=p[n]).i]=e.x(t);return h.join("")}}}var eg=em(function(t){let e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ed:ef(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),e_=em(function(t){return null==t?ed:(b||(b=document.createElementNS("http://www.w3.org/2000/svg","g")),b.setAttribute("transform",t),t=b.transform.baseVal.consolidate())?ef((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ed},", ",")",")");function ev(t,e,n){var i=t._id;return t.each(function(){var t=eu(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return ec(t,i).value[e]}}function ey(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ex(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function eb(){}var ew="\\s*([+-]?\\d+)\\s*",eT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",eA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eC=/^#([0-9a-f]{3,8})$/,ek=RegExp(`^rgb\\(${ew},${ew},${ew}\\)$`),eS=RegExp(`^rgb\\(${eA},${eA},${eA}\\)$`),eM=RegExp(`^rgba\\(${ew},${ew},${ew},${eT}\\)$`),eE=RegExp(`^rgba\\(${eA},${eA},${eA},${eT}\\)$`),eO=RegExp(`^hsl\\(${eT},${eA},${eA}\\)$`),eR=RegExp(`^hsla\\(${eT},${eA},${eA},${eT}\\)$`),eN={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function eP(){return this.rgb().formatHex()}function eD(){return this.rgb().formatRgb()}function eI(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=eC.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ej(e):3===n?new eq(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?eV(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?eV(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ek.exec(t))?new eq(e[1],e[2],e[3],1):(e=eS.exec(t))?new eq(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=eM.exec(t))?eV(e[1],e[2],e[3],e[4]):(e=eE.exec(t))?eV(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=eO.exec(t))?eU(e[1],e[2]/100,e[3]/100,1):(e=eR.exec(t))?eU(e[1],e[2]/100,e[3]/100,e[4]):eN.hasOwnProperty(t)?ej(eN[t]):"transparent"===t?new eq(NaN,NaN,NaN,0):null}function ej(t){return new eq(t>>16&255,t>>8&255,255&t,1)}function eV(t,e,n,i){return i<=0&&(t=e=n=NaN),new eq(t,e,n,i)}function eF(t,e,n,i){var r;return 1==arguments.length?((r=t)instanceof eb||(r=eI(r)),r)?new eq((r=r.rgb()).r,r.g,r.b,r.opacity):new eq:new eq(t,e,n,null==i?1:i)}function eq(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function e$(){return`#${ez(this.r)}${ez(this.g)}${ez(this.b)}`}function eB(){let t=eL(this.opacity);return`${1===t?"rgb(":"rgba("}${eW(this.r)}, ${eW(this.g)}, ${eW(this.b)}${1===t?")":`, ${t})`}`}function eL(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function eW(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ez(t){return((t=eW(t))<16?"0":"")+t.toString(16)}function eU(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new eG(t,e,n,i)}function eX(t){if(t instanceof eG)return new eG(t.h,t.s,t.l,t.opacity);if(t instanceof eb||(t=eI(t)),!t)return new eG;if(t instanceof eG)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,o=s-r,l=(s+r)/2;return o?(a=e===s?(n-i)/o+(n<i)*6:n===s?(i-e)/o+2:(e-n)/o+4,o/=l<.5?s+r:2-s-r,a*=60):o=l>0&&l<1?0:a,new eG(a,o,l,t.opacity)}function eG(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function eH(t){return(t=(t||0)%360)<0?t+360:t}function eY(t){return Math.max(0,Math.min(1,t||0))}function eZ(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function eQ(t,e,n,i,r){var s=t*t,a=s*t;return((1-3*t+3*s-a)*e+(4-6*s+3*a)*n+(1+3*t+3*s-3*a)*i+a*r)/6}ey(eb,eI,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:eP,formatHex:eP,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return eX(this).formatHsl()},formatRgb:eD,toString:eD}),ey(eq,eF,ex(eb,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new eq(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new eq(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new eq(eW(this.r),eW(this.g),eW(this.b),eL(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:e$,formatHex:e$,formatHex8:function(){return`#${ez(this.r)}${ez(this.g)}${ez(this.b)}${ez((isNaN(this.opacity)?1:this.opacity)*255)}`},formatRgb:eB,toString:eB})),ey(eG,function(t,e,n,i){return 1==arguments.length?eX(t):new eG(t,e,n,null==i?1:i)},ex(eb,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new eG(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new eG(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new eq(eZ(t>=240?t-240:t+120,r,i),eZ(t,r,i),eZ(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new eG(eH(this.h),eY(this.s),eY(this.l),eL(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=eL(this.opacity);return`${1===t?"hsl(":"hsla("}${eH(this.h)}, ${100*eY(this.s)}%, ${100*eY(this.l)}%${1===t?")":`, ${t})`}`}}));let eK=t=>()=>t;function eJ(t,e){var n,i,r=e-t;return r?(n=t,i=r,function(t){return n+t*i}):eK(isNaN(t)?e:t)}let e0=function t(e){var n,i=1==(n=+e)?eJ:function(t,e){var i,r,s;return e-t?(i=t,r=e,i=Math.pow(i,s=n),r=Math.pow(r,s)-i,s=1/s,function(t){return Math.pow(i+t*r,s)}):eK(isNaN(t)?e:t)};function r(t,e){var n=i((t=eF(t)).r,(e=eF(e)).r),r=i(t.g,e.g),s=i(t.b,e.b),a=eJ(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=s(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function e1(t){return function(e){var n,i,r=e.length,s=Array(r),a=Array(r),o=Array(r);for(n=0;n<r;++n)i=eF(e[n]),s[n]=i.r||0,a[n]=i.g||0,o[n]=i.b||0;return s=t(s),a=t(a),o=t(o),i.opacity=1,function(t){return i.r=s(t),i.g=a(t),i.b=o(t),i+""}}}e1(function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],a=i>0?t[i-1]:2*r-s,o=i<e-1?t[i+2]:2*s-r;return eQ((n-i/e)*e,a,r,s,o)}}),e1(function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],s=t[i%e],a=t[(i+1)%e],o=t[(i+2)%e];return eQ((n-i/e)*e,r,s,a,o)}});var e2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,e3=RegExp(e2.source,"g");function e4(t,e){var n,i,r,s,a,o=e2.lastIndex=e3.lastIndex=0,l=-1,u=[],c=[];for(t+="",e+="";(r=e2.exec(t))&&(s=e3.exec(e));)(a=s.index)>o&&(a=e.slice(o,a),u[l]?u[l]+=a:u[++l]=a),(r=r[0])===(s=s[0])?u[l]?u[l]+=s:u[++l]=s:(u[++l]=null,c.push({i:l,x:eh(r,s)})),o=e3.lastIndex;return o<e.length&&(a=e.slice(o),u[l]?u[l]+=a:u[++l]=a),u.length<2?c[0]?(n=c[0].x,function(t){return n(t)+""}):(i=e,function(){return i}):(e=c.length,function(t){for(var n,i=0;i<e;++i)u[(n=c[i]).i]=n.x(t);return u.join("")})}function e5(t,e){var n;return("number"==typeof e?eh:e instanceof eI?e0:(n=eI(e))?(e=n,e0):e4)(t,e)}var e8=tX.prototype.constructor;function e6(t){return function(){this.style.removeProperty(t)}}var e9=0;function e7(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}var nt=tX.prototype;e7.prototype=(function(t){return tX().transition(t)}).prototype={constructor:e7,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ta(t));for(var i=this._groups,r=i.length,s=Array(r),a=0;a<r;++a)for(var o,l,u=i[a],c=u.length,h=s[a]=Array(c),p=0;p<c;++p)(o=u[p])&&(l=t.call(o,o.__data__,p,u))&&("__data__"in o&&(l.__data__=o.__data__),h[p]=l,eo(h[p],e,n,p,h,ec(o,n)));return new e7(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=tu(t));for(var i=this._groups,r=i.length,s=[],a=[],o=0;o<r;++o)for(var l,u=i[o],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var p,d=t.call(l,l.__data__,h,u),f=ec(l,n),m=0,g=d.length;m<g;++m)(p=d[m])&&eo(p,e,n,m,d,f);s.push(d),a.push(l)}return new e7(s,a,e,n)},selectChild:nt.selectChild,selectChildren:nt.selectChildren,filter:function(t){"function"!=typeof t&&(t=tc(t));for(var e=this._groups,n=e.length,i=Array(n),r=0;r<n;++r)for(var s,a=e[r],o=a.length,l=i[r]=[],u=0;u<o;++u)(s=a[u])&&t.call(s,s.__data__,u,a)&&l.push(s);return new e7(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw Error();for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),a=Array(i),o=0;o<s;++o)for(var l,u=e[o],c=n[o],h=u.length,p=a[o]=Array(h),d=0;d<h;++d)(l=u[d]||c[d])&&(p[d]=l);for(;o<i;++o)a[o]=e[o];return new e7(a,this._parents,this._name,this._id)},selection:function(){return new e8(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=++e9,i=this._groups,r=i.length,s=0;s<r;++s)for(var a,o=i[s],l=o.length,u=0;u<l;++u)if(a=o[u]){var c=ec(a,e);eo(a,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new e7(i,this._parents,t,n)},call:nt.call,nodes:nt.nodes,node:nt.node,size:nt.size,empty:nt.empty,each:nt.each,on:function(t,e){var n,i,r,s,a,o,l=this._id;return arguments.length<2?ec(this.node(),l).on.on(t):this.each((n=l,i=t,r=e,o=(i+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})?el:eu,function(){var t=o(this,n),e=t.on;e!==s&&(a=(s=e).copy()).on(i,r),t.on=a}))},attr:function(t,e){var n=tA(t),i="transform"===n?e_:e5;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var i,r,s;return function(){var a,o,l=n(this);return null==l?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:a===i&&o===r?s:(r=o,s=e(i=a,l))}}:function(t,e,n){var i,r,s;return function(){var a,o,l=n(this);return null==l?void this.removeAttribute(t):(a=this.getAttribute(t))===(o=l+"")?null:a===i&&o===r?s:(r=o,s=e(i=a,l))}})(n,i,ev(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var i,r,s=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===s?null:a===i?r:r=e(i=a,n)}}:function(t,e,n){var i,r,s=n+"";return function(){var a=this.getAttribute(t);return a===s?null:a===i?r:r=e(i=a,n)}})(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw Error();var i=tA(t);return this.tween(n,(i.local?function(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e){this.setAttributeNS(t.space,t.local,r.call(this,e))}),n}return r._value=e,r}:function(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e){this.setAttribute(t,r.call(this,e))}),n}return r._value=e,r})(i,e))},style:function(t,e,n){var i,r,s,a,o,l,u,c,h,p,d,f,m,g,v,y,x,b,w,T,A,C="transform"==(t+="")?eg:e5;return null==e?this.styleTween(t,(i=t,function(){var t=tk(this,i),e=(this.style.removeProperty(i),tk(this,i));return t===e?null:t===r&&e===s?a:a=C(r=t,s=e)})).on("end.style."+t,e6(t)):"function"==typeof e?this.styleTween(t,(o=t,l=ev(this,"style."+t,e),function(){var t=tk(this,o),e=l(this),n=e+"";return null==e&&(this.style.removeProperty(o),n=e=tk(this,o)),t===n?null:t===u&&n===c?h:(c=n,h=C(u=t,e))})).each((p=this._id,x="end."+(y="style."+(d=t)),function(){var t=eu(this,p),e=t.on,n=null==t.value[y]?v||(v=e6(d)):void 0;(e!==f||g!==n)&&(m=(f=e).copy()).on(x,g=n),t.on=m})):this.styleTween(t,(b=t,A=e+"",function(){var t=tk(this,b);return t===A?null:t===w?T:T=C(w=t,e)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw Error();return this.tween(i,function(t,e,n){var i,r;function s(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&function(e){this.style.setProperty(t,s.call(this,e),n)}),i}return s._value=e,s}(t,e,null==n?"":n))},text:function(t){var e,n;return this.tween("text","function"==typeof t?(e=ev(this,"text",t),function(){var t=e(this);this.textContent=null==t?"":t}):(n=null==t?"":t+"",function(){this.textContent=n}))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw Error();return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){this.textContent=i.call(this,t)}),e}return i._value=t,i}(t))},remove:function(){var t;return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=ec(this.node(),n).tween,s=0,a=r.length;s<a;++s)if((i=r[s]).name===t)return i.value;return null}return this.each((null==e?function(t,e){var n,i;return function(){var r=eu(this,t),s=r.tween;if(s!==n){i=n=s;for(var a=0,o=i.length;a<o;++a)if(i[a].name===e){(i=i.slice()).splice(a,1);break}}r.tween=i}}:function(t,e,n){var i,r;if("function"!=typeof n)throw Error();return function(){var s=eu(this,t),a=s.tween;if(a!==i){r=(i=a).slice();for(var o={name:e,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===e){r[l]=o;break}l===u&&r.push(o)}s.tween=r}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){el(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e*=1,function(){el(this,t).delay=e}})(e,t)):ec(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){eu(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e*=1,function(){eu(this,t).duration=e}})(e,t)):ec(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw Error();return function(){eu(this,t).ease=e}}(e,t)):ec(this.node(),e).ease},easeVarying:function(t){var e;if("function"!=typeof t)throw Error();return this.each((e=this._id,function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw Error();eu(this,e).ease=n}))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,a){var o={value:a},l={value:function(){0==--r&&s()}};n.each(function(){var n=eu(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),n.on=e}),0===r&&s()})},[Symbol.iterator]:nt[Symbol.iterator]};var ne={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};tX.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,i,r,s=t.__transition,a=!0;if(s){for(r in e=null==e?null:e+"",s){if((n=s[r]).name!==e){a=!1;continue}i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[r]}a&&delete t.__transition}}(this,t)})},tX.prototype.transition=function(t){var e,n;t instanceof e7?(e=t._id,t=t._name):(e=++e9,(n=ne).time=t6(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var a,o=i[s],l=o.length,u=0;u<l;++u)(a=o[u])&&eo(a,t,e,u,o,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw Error(`transition ${e} not found`);return n}(a,e));return new e7(i,this._parents,t,e)};var nn={name:"drag"},ni={name:"space"},nr={name:"handle"},ns={name:"center"};let{abs:na,max:no,min:nl}=Math;function nu(t){return[+t[0],+t[1]]}function nc(t){return[nu(t[0]),nu(t[1])]}var nh={name:"x",handles:["w","e"].map(nv),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},np={name:"y",handles:["n","s"].map(nv),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},nd=(["n","w","e","s","nw","ne","sw","se"].map(nv),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),nf={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},nm={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},ng={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},n_={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function nv(t){return{type:t}}function ny(t){return!t.ctrlKey&&!t.button}function nx(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function nb(){return navigator.maxTouchPoints||"ontouchstart"in this}function nw(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function nT(t){return"string"==typeof t?new tU([[document.querySelector(t)]],[document.documentElement]):new tU([[t]],tz)}function nA(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}let nC={passive:!1},nk={capture:!0,passive:!1};function nS(t){t.stopImmediatePropagation()}function nM(t){t.preventDefault(),t.stopImmediatePropagation()}let nE=t=>()=>t;function nO(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:a,y:o,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}function nR(t){return!t.ctrlKey&&!t.button}function nN(){return this.parentNode}function nP(t,e){return null==e?{x:t.x,y:t.y}:e}function nD(){return navigator.maxTouchPoints||"ontouchstart"in this}function nI(){var t,e,n,i,r=nR,s=nN,a=nP,o=nD,l={},u=tH("start","drag","end"),c=0,h=0;function p(t){t.on("mousedown.drag",d).filter(o).on("touchstart.drag",g).on("touchmove.drag",v,nC).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(a,o){if(!i&&r.call(this,a,o)){var l,u,c,h=x(this,s.call(this,a,o),a,o,"mouse");h&&(nT(a.view).on("mousemove.drag",f,nk).on("mouseup.drag",m,nk),u=(l=a.view).document.documentElement,c=nT(l).on("dragstart.drag",nM,nk),"onselectstart"in u?c.on("selectstart.drag",nM,nk):(u.__noselect=u.style.MozUserSelect,u.style.MozUserSelect="none"),nS(a),n=!1,t=a.clientX,e=a.clientY,h("start",a))}}function f(i){if(nM(i),!n){var r=i.clientX-t,s=i.clientY-e;n=r*r+s*s>h}l.mouse("drag",i)}function m(t){var e,i,r,s;nT(t.view).on("mousemove.drag mouseup.drag",null),e=t.view,i=n,r=e.document.documentElement,s=nT(e).on("dragstart.drag",null),i&&(s.on("click.drag",nM,nk),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in r?s.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect),nM(t),l.mouse("end",t)}function g(t,e){if(r.call(this,t,e)){var n,i,a=t.changedTouches,o=s.call(this,t,e),l=a.length;for(n=0;n<l;++n)(i=x(this,o,t,e,a[n].identifier,a[n]))&&(nS(t),i("start",t,a[n]))}}function v(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=l[i[e].identifier])&&(nM(t),n("drag",t,i[e]))}function y(t){var e,n,r=t.changedTouches,s=r.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),e=0;e<s;++e)(n=l[r[e].identifier])&&(nS(t),n("end",t,r[e]))}function x(t,e,n,i,r,s){var o,h,d,f=u.copy(),m=nA(s||n,e);if(null!=(d=a.call(t,new nO("beforestart",{sourceEvent:n,target:p,identifier:r,active:c,x:m[0],y:m[1],dx:0,dy:0,dispatch:f}),i)))return o=d.x-m[0]||0,h=d.y-m[1]||0,function n(s,a,u){var g,v=m;switch(s){case"start":l[r]=n,g=c++;break;case"end":delete l[r],--c;case"drag":m=nA(u||a,e),g=c}f.call(s,t,new nO(s,{sourceEvent:a,subject:d,target:p,identifier:r,active:g,x:m[0]+o,y:m[1]+h,dx:m[0]-v[0],dy:m[1]-v[1],dispatch:f}),i)}}return p.filter=function(t){return arguments.length?(r="function"==typeof t?t:nE(!!t),p):r},p.container=function(t){return arguments.length?(s="function"==typeof t?t:nE(t),p):s},p.subject=function(t){return arguments.length?(a="function"==typeof t?t:nE(t),p):a},p.touchable=function(t){return arguments.length?(o="function"==typeof t?t:nE(!!t),p):o},p.on=function(){var t=u.on.apply(u,arguments);return t===u?p:t},p.clickDistance=function(t){return arguments.length?(h=(t*=1)*t,p):Math.sqrt(h)},p}function nj(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,s,a,o,l,u,c,h,p,d=t._root,f={data:i},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!d)return t._root=f,t;for(;d.length;)if((u=e>=(s=(m+v)/2))?m=s:v=s,(c=n>=(a=(g+y)/2))?g=a:y=a,r=d,!(d=d[h=c<<1|u]))return r[h]=f,t;if(o=+t._x.call(null,d.data),l=+t._y.call(null,d.data),e===o&&n===l)return f.next=d,r?r[h]=f:t._root=f,t;do r=r?r[h]=[,,,,]:t._root=[,,,,],(u=e>=(s=(m+v)/2))?m=s:v=s,(c=n>=(a=(g+y)/2))?g=a:y=a;while((h=c<<1|u)==(p=(l>=a)<<1|o>=s));return r[p]=d,r[h]=f,t}function nV(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function nF(t){return t[0]}function nq(t){return t[1]}function n$(t,e,n){var i=new nB(null==e?nF:e,null==n?nq:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function nB(t,e,n,i,r,s){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function nL(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}nO.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var nW=n$.prototype=nB.prototype;function nz(t){return function(){return t}}function nU(t){return(t()-.5)*1e-6}function nX(t){return t.x+t.vx}function nG(t){return t.y+t.vy}function nH(t){return t.index}function nY(t,e){var n=t.get(e);if(!n)throw Error("node not found: "+e);return n}function nZ(t){return t.x}function nQ(t){return t.y}nW.copy=function(){var t,e,n=new nB(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=nL(i),n;for(t=[{source:i,target:n._root=[,,,,]}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=[,,,,]}):i.target[r]=nL(e));return n},nW.add=function(t){let e=+this._x.call(null,t),n=+this._y.call(null,t);return nj(this.cover(e,n),e,n,t)},nW.addAll=function(t){var e,n,i,r,s=t.length,a=Array(s),o=Array(s),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<s;++n)!(isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e)))&&(a[n]=i,o[n]=r,i<l&&(l=i),i>c&&(c=i),r<u&&(u=r),r>h&&(h=r));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<s;++n)nj(this,a[n],o[n],t[n]);return this},nW.cover=function(t,e){if(isNaN(t*=1)||isNaN(e*=1))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1;else{for(var a,o,l=r-n||1,u=this._root;n>t||t>=r||i>e||e>=s;)switch(o=(e<i)<<1|t<n,(a=[,,,,])[o]=u,u=a,l*=2,o){case 0:r=n+l,s=i+l;break;case 1:n=r-l,s=i+l;break;case 2:r=n+l,i=s-l;break;case 3:n=r-l,i=s-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this},nW.data=function(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t},nW.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},nW.find=function(t,e,n){var i,r,s,a,o,l,u,c=this._x0,h=this._y0,p=this._x1,d=this._y1,f=[],m=this._root;for(m&&f.push(new nV(m,c,h,p,d)),null==n?n=1/0:(c=t-n,h=e-n,p=t+n,d=e+n,n*=n);l=f.pop();)if((m=l.node)&&!((r=l.x0)>p)&&!((s=l.y0)>d)&&!((a=l.x1)<c)&&!((o=l.y1)<h))if(m.length){var g=(r+a)/2,v=(s+o)/2;f.push(new nV(m[3],g,v,a,o),new nV(m[2],r,v,g,o),new nV(m[1],g,s,a,v),new nV(m[0],r,s,g,v)),(u=(e>=v)<<1|t>=g)&&(l=f[f.length-1],f[f.length-1]=f[f.length-1-u],f[f.length-1-u]=l)}else{var y=t-this._x.call(null,m.data),x=e-this._y.call(null,m.data),b=y*y+x*x;if(b<n){var w=Math.sqrt(n=b);c=t-w,h=e-w,p=t+w,d=e+w,i=m.data}}return i},nW.remove=function(t){if(isNaN(s=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,i,r,s,a,o,l,u,c,h,p,d=this._root,f=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((u=s>=(o=(f+g)/2))?f=o:g=o,(c=a>=(l=(m+v)/2))?m=l:v=l,e=d,!(d=d[h=c<<1|u]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,p=h)}for(;d.data!==t;)if(i=d,!(d=d.next))return this;return((r=d.next)&&delete d.next,i)?r?i.next=r:delete i.next:e?(r?e[h]=r:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[p]=d:this._root=d)):this._root=r,this},nW.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},nW.root=function(){return this._root},nW.size=function(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t},nW.visit=function(t){var e,n,i,r,s,a,o=[],l=this._root;for(l&&o.push(new nV(l,this._x0,this._y0,this._x1,this._y1));e=o.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,s=e.x1,a=e.y1)&&l.length){var u=(i+s)/2,c=(r+a)/2;(n=l[3])&&o.push(new nV(n,u,c,s,a)),(n=l[2])&&o.push(new nV(n,i,c,u,a)),(n=l[1])&&o.push(new nV(n,u,r,s,c)),(n=l[0])&&o.push(new nV(n,i,r,u,c))}return this},nW.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new nV(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var s,a=e.x0,o=e.y0,l=e.x1,u=e.y1,c=(a+l)/2,h=(o+u)/2;(s=r[0])&&n.push(new nV(s,a,o,c,h)),(s=r[1])&&n.push(new nV(s,c,o,l,h)),(s=r[2])&&n.push(new nV(s,a,h,c,u)),(s=r[3])&&n.push(new nV(s,c,h,l,u))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},nW.x=function(t){return arguments.length?(this._x=t,this):this._x},nW.y=function(t){return arguments.length?(this._y=t,this):this._y};var nK=Math.PI*(3-Math.sqrt(5));function nJ(t,e){var n,i,r=typeof e;return null==e||"boolean"===r?eK(e):("number"===r?eh:"string"===r?(i=eI(e))?(e=i,e0):e4:e instanceof eI?e0:e instanceof Date?function(t,e){var n=new Date;return t*=1,e*=1,function(i){return n.setTime(t*(1-i)+e*i),n}}:!ArrayBuffer.isView(n=e)||n instanceof DataView?Array.isArray(e)?function(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,s=Array(r),a=Array(i);for(n=0;n<r;++n)s[n]=nJ(t[n],e[n]);for(;n<i;++n)a[n]=e[n];return function(t){for(n=0;n<r;++n)a[n]=s[n](t);return a}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,i={},r={};for(n in(null===t||"object"!=typeof t)&&(t={}),(null===e||"object"!=typeof e)&&(e={}),e)n in t?i[n]=nJ(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}:eh:function(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(n=0;n<i;++n)r[n]=t[n]*(1-s)+e[n]*s;return r}})(t,e)}function n0(t,e){return t*=1,e*=1,function(n){return Math.round(t*(1-n)+e*n)}}function n1(t){return+t}var n2=[0,1];function n3(t){return t}function n4(t,e){var n;return(e-=t*=1)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n})}function n5(t,e,n){var i=t[0],r=t[1],s=e[0],a=e[1];return r<i?(i=n4(r,i),s=n(a,s)):(i=n4(i,r),s=n(s,a)),function(t){return s(i(t))}}function n8(t,e,n){var i=Math.min(t.length,e.length)-1,r=Array(i),s=Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)r[a]=n4(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(e){var n=F(t,e,1,i)-1;return s[n](r[n](e))}}function n6(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var n9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function n7(t){var e;if(!(e=n9.exec(t)))throw Error("invalid format: "+t);return new it({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function it(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ie(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function ii(t){return(t=ie(Math.abs(t)))?t[1]:NaN}function ir(t,e){var n=ie(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+Array(r-i.length+2).join("0")}n7.prototype=it.prototype,it.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let is={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ir(100*t,e),r:ir,s:function(t,e){var n=ie(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(w=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return s===a?i:s>a?i+Array(s-a+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+Array(1-s).join("0")+ie(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ia(t){return t}var io=Array.prototype.map,il=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function iu(){var t,e=(function(){var t,e,n,i,r,s,a=n2,o=n2,l=nJ,u=n3;function c(){var t,e,n,l=Math.min(a.length,o.length);return u!==n3&&(t=a[0],e=a[l-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),i=l>2?n8:n5,r=s=null,h}function h(e){return null==e||isNaN(e*=1)?n:(r||(r=i(a.map(t),o,l)))(t(u(e)))}return h.invert=function(n){return u(e((s||(s=i(o,a.map(t),eh)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,n1),c()):a.slice()},h.range=function(t){return arguments.length?(o=Array.from(t),c()):o.slice()},h.rangeRound=function(t){return o=Array.from(t),l=n0,c()},h.clamp=function(t){return arguments.length?(u=!!t||n3,c()):u!==n3},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,c()}})()(n3,n3);return e.copy=function(){return iu().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())},n6.apply(e,arguments),t=e.domain,e.ticks=function(e){var n=t();return z(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var i=t();return function(t,e,n,i){var r,s,a,o=function(t,e,n){e*=1,t*=1,n*=1;let i=e<t,r=i?U(e,t,n):U(t,e,n);return(i?-1:1)*(r<0?-(1/r):r)}(t,e,n);switch((i=n7(null==i?",f":i)).type){case"s":var l=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(a=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ii(l)/3)))-ii(Math.abs(o))))||(i.precision=a),C(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(a=Math.max(0,ii(Math.abs(Math.max(Math.abs(t),Math.abs(e)))-(r=Math.abs(r=o)))-ii(r))+1)||(i.precision=a-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(a=Math.max(0,-ii(Math.abs(o))))||(i.precision=a-("%"===i.type)*2)}return A(i)}(i[0],i[i.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,r,s=t(),a=0,o=s.length-1,l=s[a],u=s[o],c=10;for(u<l&&(r=l,l=u,u=r,r=a,a=o,o=r);c-- >0;){if((r=U(l,u,n))===i)return s[a]=l,s[o]=u,t(s);if(r>0)l=Math.floor(l/r)*r,u=Math.ceil(u/r)*r;else if(r<0)l=Math.ceil(l*r)/r,u=Math.floor(u*r)/r;else break;i=r}return e},e}function ic(t){return"string"==typeof t?new tU([document.querySelectorAll(t)],[document.documentElement]):new tU([to(t)],tz)}function ih(t){return function(){return t}}A=(T=function(t){var e,n,i,r=void 0===t.grouping||void 0===t.thousands?ia:(e=io.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],a=0,o=e[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),s.push(t.substring(r-=o,r+o)),!((l+=o+1)>i));)o=e[a=(a+1)%e.length];return s.reverse().join(n)}),s=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?ia:(i=io.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return i[+t]})}),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function p(t){var e=(t=n7(t)).fill,n=t.align,i=t.sign,p=t.symbol,d=t.zero,f=t.width,m=t.comma,g=t.precision,v=t.trim,y=t.type;"n"===y?(m=!0,y="g"):is[y]||(void 0===g&&(g=12),v=!0,y="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===p?s:"#"===p&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===p?a:/[%p]/.test(y)?u:"",T=is[y],A=/[defgprs%]/.test(y);function C(t){var s,a,u,p=x,C=b;if("c"===y)C=T(t)+C,t="";else{var k=(t*=1)<0||1/t<0;if(t=isNaN(t)?h:T(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==i&&(k=!1),p=(k?"("===i?i:c:"-"===i||"("===i?"":i)+p,C=("s"===y?il[8+w/3]:"")+C+(k&&"("===i?")":""),A){for(s=-1,a=t.length;++s<a;)if(48>(u=t.charCodeAt(s))||u>57){C=(46===u?o+t.slice(s+1):t.slice(s))+C,t=t.slice(0,s);break}}}m&&!d&&(t=r(t,1/0));var S=p.length+t.length+C.length,M=S<f?Array(f-S+1).join(e):"";switch(m&&d&&(t=r(M+t,M.length?f-C.length:1/0),M=""),n){case"<":t=p+t+C+M;break;case"=":t=p+M+t+C;break;case"^":t=M.slice(0,S=M.length>>1)+p+t+C+M.slice(S);break;default:t=M+p+t+C}return l(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),C.toString=function(){return t+""},C}return{format:p,formatPrefix:function(t,e){var n=p(((t=n7(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ii(e)/3))),r=Math.pow(10,-i),s=il[8+i/3];return function(t){return n(r*t)+s}}}}({thousands:",",grouping:[3],currency:["$",""]})).format,C=T.formatPrefix;let ip=Math.abs,id=Math.atan2,im=Math.cos,ig=Math.max,i_=Math.min,iv=Math.sin,iy=Math.sqrt,ix=Math.PI,ib=ix/2,iw=2*ix;function iT(t){return t>=1?ib:t<=-1?-ib:Math.asin(t)}let iA=Math.PI,iC=2*iA,ik=iC-1e-6;function iS(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class iM{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?iS:function(t){let e=Math.floor(t);if(!(e>=0))throw Error(`invalid digits: ${t}`);if(e>15)return iS;let n=10**e;return function(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,i){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,e,n,i,r,s){this._append`C${+t},${+e},${+n},${+i},${this._x1=+r},${this._y1=+s}`}arcTo(t,e,n,i,r){if(t*=1,e*=1,n*=1,i*=1,(r*=1)<0)throw Error(`negative radius: ${r}`);let s=this._x1,a=this._y1,o=n-t,l=i-e,u=s-t,c=a-e,h=u*u+c*c;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>1e-6)if(Math.abs(c*o-l*u)>1e-6&&r){let p=n-s,d=i-a,f=o*o+l*l,m=Math.sqrt(f),g=Math.sqrt(h),v=r*Math.tan((iA-Math.acos((f+h-(p*p+d*d))/(2*m*g)))/2),y=v/g,x=v/m;Math.abs(y-1)>1e-6&&this._append`L${t+y*u},${e+y*c}`,this._append`A${r},${r},0,0,${+(c*p>u*d)},${this._x1=t+x*o},${this._y1=e+x*l}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,i,r,s){if(t*=1,e*=1,n*=1,s=!!s,n<0)throw Error(`negative radius: ${n}`);let a=n*Math.cos(i),o=n*Math.sin(i),l=t+a,u=e+o,c=1^s,h=s?i-r:r-i;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&this._append`L${l},${u}`,n&&(h<0&&(h=h%iC+iC),h>ik?this._append`A${n},${n},0,1,${c},${t-a},${e-o}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`:h>1e-6&&this._append`A${n},${n},0,${+(h>=iA)},${c},${this._x1=t+n*Math.cos(r)},${this._y1=e+n*Math.sin(r)}`)}rect(t,e,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n*=1}v${+i}h${-n}Z`}toString(){return this._}}function iE(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{let t=Math.floor(n);if(!(t>=0))throw RangeError(`invalid digits: ${n}`);e=t}return t},()=>new iM(e)}function iO(t){return t.innerRadius}function iR(t){return t.outerRadius}function iN(t){return t.startAngle}function iP(t){return t.endAngle}function iD(t){return t&&t.padAngle}function iI(t,e,n,i,r,s,a){var o=t-n,l=e-i,u=(a?s:-s)/iy(o*o+l*l),c=u*l,h=-u*o,p=t+c,d=e+h,f=n+c,m=i+h,g=(p+f)/2,v=(d+m)/2,y=f-p,x=m-d,b=y*y+x*x,w=r-s,T=p*m-f*d,A=(x<0?-1:1)*iy(ig(0,w*w*b-T*T)),C=(T*x-y*A)/b,k=(-T*y-x*A)/b,S=(T*x+y*A)/b,M=(-T*y+x*A)/b,E=C-g,O=k-v,R=S-g,N=M-v;return E*E+O*O>R*R+N*N&&(C=S,k=M),{cx:C,cy:k,x01:-c,y01:-h,x11:C*(r/w-1),y11:k*(r/w-1)}}function ij(t){this._context=t}function iV(t){return new ij(t)}function iF(t){return t[0]}function iq(t){return t[1]}function i$(t,e){var n=ih(!0),i=null,r=iV,s=null,a=iE(o);function o(o){var l,u,c,h,p=(o="object"==typeof(l=o)&&"length"in l?l:Array.from(l)).length,d=!1;for(null==i&&(s=r(h=a())),u=0;u<=p;++u)!(u<p&&n(c=o[u],u,o))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+t(c,u,o),+e(c,u,o));if(h)return s=null,h+""||null}return t="function"==typeof t?t:void 0===t?iF:ih(t),e="function"==typeof e?e:void 0===e?iq:ih(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:ih(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:ih(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:ih(!!t),o):n},o.curve=function(t){return arguments.length?(r=t,null!=i&&(s=r(i)),o):r},o.context=function(t){return arguments.length?(null==t?i=s=null:s=r(i=t),o):i},o}function iB(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function iL(t){this._context=t}function iW(t){return new iL(t)}function iz(t,e,n){this.k=t,this.x=e,this.y=n}iM.prototype,Array.prototype.slice,ij.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t*=1,e*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},iL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:iB(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t*=1,e*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:iB(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},iz.prototype={constructor:iz,scale:function(t){return 1===t?this:new iz(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new iz(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var iU=new iz(1,0,0);iz.prototype;let iX="15.1.22",iG=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),iH=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),iY=(t,e)=>({startTime:e,type:"setValue",value:t}),iZ=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),iQ=(t,e,{startTime:n,target:i,timeConstant:r})=>i+(e-i)*Math.exp((n-t)/r),iK=t=>"exponentialRampToValue"===t.type,iJ=t=>"linearRampToValue"===t.type,i0=t=>iK(t)||iJ(t),i1=t=>"setValue"===t.type,i2=t=>"setValueCurve"===t.type,i3=(t,e,n,i)=>{let r=t[e];return void 0===r?i:i0(r)||i1(r)?r.value:i2(r)?r.values[r.values.length-1]:iQ(n,i3(t,e-1,r.startTime,i),r)},i4=(t,e,n,i,r)=>void 0===n?[i.insertTime,r]:i0(n)?[n.endTime,n.value]:i1(n)?[n.startTime,n.value]:i2(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,i3(t,e-1,n.startTime,r)],i5=t=>"cancelAndHold"===t.type,i8=t=>"cancelScheduledValues"===t.type,i6=t=>i5(t)||i8(t)?t.cancelTime:iK(t)||iJ(t)?t.endTime:t.startTime,i9=(t,e,n,{endTime:i,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((t-e)/(i-e)):0,i7=(t,e,n,{endTime:i,value:r})=>n+(t-e)/(i-e)*(r-n),rt=(t,e)=>{let n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},re=(t,{duration:e,startTime:n,values:i})=>{let r=(t-n)/e*(i.length-1);return rt(i,r)},rn=t=>"setTarget"===t.type;class ri{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){let e=i6(t);if(i5(t)||i8(t)){let n=this._automationEvents.findIndex(n=>i8(t)&&i2(n)?n.startTime+n.duration>=e:i6(n)>=e),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),i5(t)){let t=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&i0(i)){if(void 0!==t&&rn(t))throw Error("The internal list is malformed.");let n=void 0===t?i.insertTime:i2(t)?t.startTime+t.duration:i6(t),r=void 0===t?this._defaultValue:i2(t)?t.values[t.values.length-1]:t.value,s=iK(i)?i9(e,n,r,i):i7(e,n,r,i),a=iK(i)?iG(s,e,this._currenTime):iH(s,e,this._currenTime);this._automationEvents.push(a)}if(void 0!==t&&rn(t)&&this._automationEvents.push(iY(this.getValue(e),e)),void 0!==t&&i2(t)&&t.startTime+t.duration>e){let n=e-t.startTime,i=(t.values.length-1)/t.duration,r=Math.max(2,1+Math.ceil(n*i)),s=n/(r-1)*i,a=t.values.slice(0,r);if(s<1)for(let e=1;e<r;e+=1){let n=s*e%1;a[e]=t.values[e-1]*(1-n)+t.values[e]*n}this._automationEvents[this._automationEvents.length-1]=iZ(a,t.startTime,n)}}}else{let n=this._automationEvents.findIndex(t=>i6(t)>e),i=-1===n?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(void 0!==i&&i2(i)&&i6(i)+i.duration>e)return!1;let r=iK(t)?iG(t.value,t.endTime,this._currenTime):iJ(t)?iH(t.value,e,this._currenTime):t;if(-1===n)this._automationEvents.push(r);else{if(i2(t)&&e+t.duration>i6(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,r)}}return!0}flush(t){let e=this._automationEvents.findIndex(e=>i6(e)>t);if(e>1){let t=this._automationEvents.slice(e-1),n=t[0];rn(n)&&t.unshift(iY(i3(this._automationEvents,e-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=t}}getValue(t){if(0===this._automationEvents.length)return this._defaultValue;let e=this._automationEvents.findIndex(e=>i6(e)>t),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&rn(r)&&(void 0===n||!i0(n)||n.insertTime>t))return iQ(t,i3(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&i1(r)&&(void 0===n||!i0(n)))return r.value;if(void 0!==r&&i2(r)&&(void 0===n||!i0(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?re(t,r):r.values[r.values.length-1];if(void 0!==r&&i0(r)&&(void 0===n||!i0(n)))return r.value;if(void 0!==n&&iK(n)){let[e,s]=i4(this._automationEvents,i,r,n,this._defaultValue);return i9(t,e,s,n)}if(void 0!==n&&iJ(n)){let[e,s]=i4(this._automationEvents,i,r,n,this._defaultValue);return i7(t,e,s,n)}return this._defaultValue}}let rr=new WeakSet,rs=new WeakMap,ra=new WeakMap,ro=new WeakMap,rl=new WeakMap,ru=new WeakMap,rc=new WeakMap,rh=new WeakMap,rp=new WeakMap,rd=new WeakMap,rf={construct:()=>rf},rm=t=>{try{new new Proxy(t,rf)}catch{return!1}return!0},rg=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,r_=(t,e)=>{let n=[],i=t.replace(/^[\s]+/,""),r=i.match(rg);for(;null!==r;){let t=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),r=(i=i.slice(r[0].length).replace(/^[\s]+/,"")).match(rg)}return[n.join(";"),i]},rv=t=>{if(void 0!==t&&!Array.isArray(t))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},ry=t=>{if(!rm(t))throw TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},rx=(t,e)=>{let n=t.get(e);if(void 0===n)throw Error("A value with the given key could not be found.");return n},rb=(t,e)=>{let n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");let[i]=n;return t.delete(i),i},rw=(t,e,n,i)=>{let r=rx(t,e),s=rb(r,t=>t[0]===n&&t[1]===i);return 0===r.size&&t.delete(e),s},rT=t=>rx(rc,t),rA=t=>{if(rr.has(t))throw Error("The AudioNode is already stored.");rr.add(t),rT(t).forEach(t=>t(!0))},rC=t=>"port"in t,rk=t=>{if(!rr.has(t))throw Error("The AudioNode is not stored.");rr.delete(t),rT(t).forEach(t=>t(!1))},rS=(t,e)=>{!rC(t)&&e.every(t=>0===t.size)&&rk(t)},rM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},rE=(t,e)=>t.context===e,rO=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},rR=()=>new DOMException("","IndexSizeError"),rN=t=>{let e;e=t.getChannelData,t.getChannelData=n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw rR();throw t}}},rP={numberOfChannels:1},rD=t=>rr.has(t),rI={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},rj=t=>"playbackRate"in t,rV=t=>"frequency"in t&&"gain"in t,rF=t=>"offset"in t,rq=t=>!("frequency"in t)&&"gain"in t,r$=t=>"detune"in t&&"frequency"in t&&!("gain"in t),rB=t=>"pan"in t,rL=t=>rx(rs,t),rW=t=>rx(ro,t),rz=(t,e)=>{let{activeInputs:n}=rL(t);for(let i of(n.forEach(n=>n.forEach(([n])=>{e.includes(t)||rz(n,[...e,t])})),rj(t)?[t.playbackRate]:rC(t)?Array.from(t.parameters.values()):rV(t)?[t.Q,t.detune,t.frequency,t.gain]:rF(t)?[t.offset]:rq(t)?[t.gain]:r$(t)?[t.detune,t.frequency]:rB(t)?[t.pan]:[])){let t=rW(i);void 0!==t&&t.activeInputs.forEach(([t])=>rz(t,e))}rD(t)&&rk(t)},rU=t=>{rz(t.destination,[])},rX=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),rG=t=>"context"in t,rH=t=>rG(t[0]),rY=(t,e,n,i)=>{for(let e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},rZ=(t,e,[n,i],r)=>{rY(t,[e,n,i],t=>t[0]===e&&t[1]===n,r)},rQ=(t,[e,n,i],r)=>{let s=t.get(e);void 0===s?t.set(e,new Set([[n,i]])):rY(s,[n,i],t=>t[0]===n,r)},rK=t=>"inputs"in t,rJ=(t,e,n,i)=>{if(rK(e)){let r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},r0=(t,e,n)=>{for(let i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},r1=(t,e,n)=>rb(t,t=>t[0]===e&&t[1]===n),r2=(t,e)=>{if(!rT(t).delete(e))throw Error("Missing the expected event listener.")},r3=(t,e,n)=>{let i=rx(t,e),r=rb(i,t=>t[0]===n);return 0===i.size&&t.delete(e),r},r4=(t,e,n,i)=>{rK(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},r5=t=>rx(ra,t),r8=t=>rx(rl,t),r6=t=>rh.has(t),r9=t=>!rr.has(t),r7=(t,e)=>new Promise(n=>{if(null!==e)n(!0);else{let e=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;let a=t.createBufferSource();a.buffer=r,a.loop=!0,a.connect(e).connect(t.destination),a.connect(i),a.disconnect(i),e.onaudioprocess=i=>{let r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,t=>1===t)?n(!0):n(!1),a.stop(),e.onaudioprocess=null,a.disconnect(e),e.disconnect(t.destination)},a.start()}}),st=(t,e)=>{let n=new Map;for(let e of t)for(let t of e){let e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach((t,n)=>e(n,t))},se=t=>"context"in t,sn=t=>{let e,n=new Map;t.connect=(t=>(e,i=0,r=0)=>{let s=se(e)?t(e,i,r):t(e,i),a=n.get(e);return void 0===a?n.set(e,[{input:r,output:i}]):a.every(t=>t.input!==r||t.output!==i)&&a.push({input:r,output:i}),s})(t.connect.bind(t)),e=t.disconnect,t.disconnect=(i,r,s)=>{if(e.apply(t),void 0===i)n.clear();else if("number"==typeof i)for(let[t,e]of n){let r=e.filter(t=>t.output!==i);0===r.length?n.delete(t):n.set(t,r)}else if(n.has(i))if(void 0===r)n.delete(i);else{let t=n.get(i);if(void 0!==t){let e=t.filter(t=>t.output!==r&&(t.input!==s||void 0===s));0===e.length?n.delete(i):n.set(i,e)}}for(let[e,i]of n)i.forEach(n=>{se(e)?t.connect(e,n.output,n.input):t.connect(e,n.output)})}},si=(t,e,n,i)=>{let{activeInputs:r,passiveInputs:s}=rW(e),{outputs:a}=rL(t),o=rT(t),l=a=>{let o=r5(t),l=r8(e);if(a){let e=r3(s,t,n);rZ(r,t,e,!1),i||r6(t)||o.connect(l,n)}else rQ(s,r1(r,t,n),!1),i||r6(t)||o.disconnect(l,n)};return!!rY(a,[e,n],t=>t[0]===e&&t[1]===n,!0)&&(o.add(l),rD(t)?rZ(r,t,[n,l],!0):rQ(s,[t,n,l],!0),!0)},sr=(t,e,n,i)=>{let{activeInputs:r,passiveInputs:s}=rL(e),a=r0(r[i],t,n);return null===a?[rw(s,t,n,i)[2],!1]:[a[2],!0]},ss=(t,e,n)=>{let{activeInputs:i,passiveInputs:r}=rW(e),s=r0(i,t,n);return null===s?[r3(r,t,n)[1],!1]:[s[2],!0]},sa=(t,e,n,i,r)=>{let[s,a]=sr(t,n,i,r);if(null!==s&&(r2(t,s),!a||e||r6(t)||r4(r5(t),r5(n),i,r)),rD(n)){let{activeInputs:t}=rL(n);rS(n,t)}},so=(t,e,n,i)=>{let[r,s]=ss(t,n,i);null!==r&&(r2(t,r),!s||e||r6(t)||r5(t).disconnect(r8(n),i))},sl=(t,e)=>{let n=rL(t),i=[];for(let r of n.outputs)rH(r)?sa(t,e,...r):so(t,e,...r),i.push(r[0]);return n.outputs.clear(),i},su=(t,e,n)=>{let i=rL(t),r=[];for(let s of i.outputs)s[1]===n&&(rH(s)?sa(t,e,...s):so(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r},sc=(t,e,n,i,r)=>{let s=rL(t);return Array.from(s.outputs).filter(t=>t[0]===n&&(void 0===i||t[1]===i)&&(void 0===r||t[2]===r)).map(n=>(rH(n)?sa(t,e,...n):so(t,e,...n),s.outputs.delete(n),n[0]))};class sh{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((n,i)=>t.call(e,n,i,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}let sp={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function sd(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{let s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{let t=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}let sf=(t,e,n,i,r)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},sm=(t,e)=>{let n=[];for(let i=0;i<t;i+=1){let t=[],r="number"==typeof e?e:e[i];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t)}return n},sg=(t,e)=>{let n=rx(rd,t);return rx(n,r5(e))},s_=async(t,e,n,i,r,s,a)=>{let o=null===e?128*Math.ceil(t.context.length/128):e.length,l=i.channelCount*i.numberOfInputs,u=r.reduce((t,e)=>t+e,0),c=0===u?null:n.createBuffer(u,o,n.sampleRate);if(void 0===s)throw Error("Missing the processor constructor.");let h=rL(t),p=await sg(n,t),d=sm(i.numberOfInputs,i.channelCount),f=sm(i.numberOfOutputs,r),m=Array.from(t.parameters.keys()).reduce((t,e)=>({...t,[e]:new Float32Array(128)}),{});for(let u=0;u<o;u+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)sd(e,d[t],n,n,u);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach(({name:t},n)=>{sd(e,m,t,l+n,u)});for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<r[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{let t=d.map((t,e)=>0===h.activeInputs[e].size?[]:t),e=a(u/n.sampleRate,n.sampleRate,()=>p.process(t,f,m));if(null!==c)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<r[t];n+=1)sf(c,f[t],n,e+n,u);e+=r[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return c},sv={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},sy={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},sx={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},sb={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},sw={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},sT=t=>{let{port1:e,port2:n}=new MessageChannel;return new Promise(i=>{let r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}catch{}finally{r()}})},sA={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},sC=t=>"delayTime"in t,sk=(t,e,n)=>{let i=e[n];if(void 0===i)throw t();return i},sS={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},sM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},sE=()=>new DOMException("","InvalidStateError"),sO=()=>new DOMException("","InvalidAccessError"),sR=t=>{let e;e=t.getFrequencyResponse,t.getFrequencyResponse=(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw sO();return e.call(t,n,i,r)}},sN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},sP=(t,e,n,i,r,s,a,o,l,u,c)=>{let h=u.length,p=o;for(let o=0;o<h;o+=1){let h=n[0]*u[o];for(let e=1;e<r;e+=1){let i=p-e&l-1;h+=n[e]*s[i],h-=t[e]*a[i]}for(let t=r;t<i;t+=1)h+=n[t]*s[p-t&l-1];for(let n=r;n<e;n+=1)h-=t[n]*a[p-n&l-1];s[p]=u[o],a[p]=h,p=p+1&l-1,c[o]=h}return p},sD=(t,e,n,i)=>{let r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),a=r.length,o=s.length,l=Math.min(a,o);if(1!==r[0]){for(let t=0;t<a;t+=1)s[t]/=r[0];for(let t=1;t<o;t+=1)r[t]/=r[0]}let u=new Float32Array(32),c=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){let n=t.getChannelData(e),i=h.getChannelData(e);u.fill(0),c.fill(0),sP(r,a,s,o,l,u,c,0,32,n,i)}return h},sI={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},sj=t=>{let e=new Uint32Array([0x46464952,40,0x45564157,0x20746d66,16,131073,44100,176400,1048580,0x61746164,4,0]);try{let n=t.decodeAudioData(e.buffer,()=>{});if(void 0===n)return!1;return n.catch(()=>{}),!0}catch{}return!1},sV=(t,e,n)=>{let i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},sF=(t,e)=>{sV(t,e,"channelCount"),sV(t,e,"channelCountMode"),sV(t,e,"channelInterpretation")},sq=t=>"function"==typeof t.getFloatTimeDomainData,s$=t=>{t.getFloatTimeDomainData=e=>{let n=new Uint8Array(e.length);t.getByteTimeDomainData(n);let i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=(n[t]-128)*.0078125;return e}},sB=(t,e,n)=>{let i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},sL=t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw sE();e.call(t,i,r,s),n=!0}})(t.start)},sW=t=>{let e;e=t.start,t.start=(n=0,i=0,r)=>{if("number"==typeof r&&r<0||i<0||n<0)throw RangeError("The parameters can't be negative.");e.call(t,n,i,r)}},sz=t=>{let e;e=t.stop,t.stop=(n=0)=>{if(n<0)throw RangeError("The parameter can't be negative.");e.call(t,n)}},sU=t=>{let{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},sX=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),sG=t=>new Promise((e,n)=>{let{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),r.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),r.close(),n(t)},r.postMessage(t)}),sH=async(t,e)=>new t(await sG(e)),sY=(t,e,n,i)=>{let r=rd.get(t);void 0===r&&(r=new WeakMap,rd.set(t,r));let s=sH(n,i);return r.set(e,s),s},sZ=(t,e)=>{let n=t.createBiquadFilter();return sF(n,e),sB(n,e,"Q"),sB(n,e,"detune"),sB(n,e,"frequency"),sB(n,e,"gain"),sV(n,e,"type"),n},sQ=t=>{let e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw sE()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw sE()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw sE()}})},sK=(t,e)=>{let n=t.createChannelSplitter(e.numberOfOutputs);return sF(n,e),sQ(n),n},sJ=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),s0=(t,e)=>{let n=t.createDelay(e.maxDelayTime);return sF(n,e),sB(n,e,"delayTime"),n},s1=(t,e)=>{let n=t.createGain();return sF(n,e),sB(n,e,"gain"),n};function s2(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1){var i;n=[(i=n)[0]*e[0]-i[1]*e[1],i[0]*e[1]+i[1]*e[0]],n[0]+=t[r]}return n}let s3=(t,e,n,i)=>t.createScriptProcessor(e,n,i),s4=()=>new DOMException("","NotSupportedError"),s5={numberOfChannels:1},s8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},s6={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},s9={disableNormalization:!1},s7={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},at=()=>new DOMException("","UnknownError"),ae={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},an=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),ai=t=>{if(null===t)return!1;let e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ar=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);let{get:s,set:a}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(a)})},as=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;as(t,e,n+1e-7)}},aa=t=>{let e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ao=t=>{let e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},al=t=>{let e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},au=(t,e)=>{let n,i=e.createGain();t.connect(i);let r=(n=t.disconnect,()=>{n.call(t,i),t.removeEventListener("ended",r)});t.addEventListener("ended",r),sJ(t,i),t.stop=(e=>{let n=!1;return (r=0)=>{if(n)try{e.call(t,r)}catch{i.gain.setValueAtTime(0,r)}else e.call(t,r),n=!0}})(t.stop)},ac=(t,e)=>n=>{let i={value:t};return(Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e)?e.call(t,n):e.handleEvent.call(t,n)},ah=(t,e,[n,i,r],s)=>{rY(t[i],[e,n,r],t=>t[0]===e&&t[1]===n,s)},ap=(t,e,[n,i,r],s)=>{let a=t.get(n);void 0===a?t.set(n,new Set([[i,e,r]])):rY(a,[i,e,r],t=>t[0]===i&&t[1]===e,s)},ad=(t,e,n,i)=>rb(t[i],t=>t[0]===e&&t[1]===n),af=new WeakMap,am=t=>{var e;return null!=(e=af.get(t))?e:0},ag=((t,e)=>(n,i)=>{let r=e.get(n);if(void 0!==r)return r;let s=t.get(n);if(void 0!==s)return s;try{let r=i();if(r instanceof Promise)return t.set(n,r),r.catch(()=>!1).then(i=>(t.delete(n),e.set(n,i),i));return e.set(n,r),r}catch{return e.set(n,!1),!1}})(new Map,new WeakMap),a_="undefined"==typeof window?null:window,av=(t,e)=>{let n=t.createAnalyser();if(sF(n,e),!(e.maxDecibels>e.minDecibels))throw rR();return sV(n,e,"fftSize"),sV(n,e,"maxDecibels"),sV(n,e,"minDecibels"),sV(n,e,"smoothingTimeConstant"),ag(sq,()=>sq(n))||s$(n),n},ay=t=>{let e=rL(t);if(null===e.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer},ax=((t,e,n)=>async(i,r,s)=>{let a=t(i);await Promise.all(a.activeInputs.map((t,a)=>Array.from(t).map(async([t,o])=>{let l=e(t),u=await l.render(t,r),c=i.context.destination;n(t)||i===c&&n(i)||u.connect(s,o,a)})).reduce((t,e)=>[...t,...e],[]))})(rL,ay,r6),ab=()=>{let t=new WeakMap,e=async(e,n)=>{let i=r5(e);return rE(i,n)||(i=av(n,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant})),t.set(n,i),await ax(e,n,i),i};return{render(n,i){let r=t.get(i);return void 0!==r?Promise.resolve(r):e(n,i)}}},aw=t=>{let e=ru.get(t);if(void 0===e)throw sE();return e},aT=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(a_),aA=(t=>e=>null!==t&&e instanceof t)(aT),aC=new WeakMap,ak=class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,e,n){if(null!==e){let i=this._listeners.get(e);void 0===i&&(i=ac(this,e),"function"==typeof e&&this._listeners.set(e,i)),this._nativeEventTarget.addEventListener(t,i,n)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){let i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}},aS=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(a_),aM=(t=>e=>null!==t&&e instanceof t)(aS),aE=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(a_),aO=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(a_),aR=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(a_),aN=((t,e,n,i,r,s,a,o,l,u,c,h,p,d,f,m)=>class extends u{constructor(e,i,r,s){super(r),this._context=e,this._nativeAudioNode=r;let a=c(e);h(a)&&!0!==n(r7,()=>r7(a,m))&&sn(r),ra.set(this,r),rc.set(this,new Set),"closed"!==e.state&&i&&rA(this),t(this,s,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,o=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();let u=f(c(this._context));if(p(t)||d(t))throw s();if(rG(t)){let r=r5(t);try{let e=rJ(this._nativeAudioNode,r,n,o),i=r9(this);(u||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&r9(t)&&rA(t)}catch(t){if(12===t.code)throw s();throw t}return e(this,t,n,o,u)&&st(l([this],t),i(u)),t}let h=r8(t);if("playbackRate"===h.name&&1024===h.maxValue)throw a();try{this._nativeAudioNode.connect(h,n),(u||r9(this))&&this._nativeAudioNode.disconnect(h,n)}catch(t){if(12===t.code)throw s();throw t}si(this,t,n,u)&&st(l([this],t),i(u))}disconnect(t,e,n){let i,a=f(c(this._context));if(void 0===t)i=sl(this,a);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=su(this,a,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs)||rG(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(0===(i=sc(this,a,t,e,n)).length)throw s()}for(let t of i)st(l([this],t),o)}})((t,e,n)=>{let i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);rs.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})},((t,e,n,i,r,s,a,o,l,u,c,h,p)=>{let d=new WeakMap;return(f,m,g,v,y)=>{let{activeInputs:x,passiveInputs:b}=s(m),{outputs:w}=s(f),T=o(f),A=s=>{let o=l(m),u=l(f);if(s){let e=rw(b,f,g,v);t(x,f,e,!1),y||h(f)||n(u,o,g,v),p(m)&&rA(m)}else{let t=i(x,f,g,v);e(b,v,t,!1),y||h(f)||r(u,o,g,v);let n=a(m);if(0===n)c(m)&&rS(m,x);else{let t=d.get(m);void 0!==t&&clearTimeout(t),d.set(m,setTimeout(()=>{c(m)&&rS(m,x)},1e3*n))}}};return!!u(w,[m,g,v],t=>t[0]===m&&t[1]===g&&t[2]===v,!0)&&(T.add(A),c(f)?t(x,f,[g,v,A],!0):e(b,v,[f,g,A],!0),!0)}})(ah,ap,rJ,ad,r4,rL,am,rT,r5,rY,rD,r6,r9),ag,((t,e,n,i,r,s)=>a=>(o,l)=>{let u=t.get(o);if(void 0===u){if(!a&&s(o)){let t=i(o),{outputs:s}=n(o);for(let n of s)if(rH(n))e(t,i(n[0]),n[1],n[2]);else{let e=r(n[0]);t.disconnect(e,n[1])}}t.set(o,l)}else t.set(o,u+l)})(rh,r4,rL,r5,r8,rD),rR,sO,s4,((t,e,n,i,r,s,a,o)=>(l,u)=>{let c=e.get(l);if(void 0===c)throw Error("Missing the expected cycle count.");let h=o(s(l.context));if(c===u){if(e.delete(l),!h&&a(l)){let e=i(l),{outputs:s}=n(l);for(let n of s)if(rH(n))t(e,i(n[0]),n[1],n[2]);else{let t=r(n[0]);e.connect(t,n[1])}}}else e.set(l,c-u)})(rJ,rh,rL,r5,r8,aw,rD,aA),function t(e,n){let i=rG(n)?n:rx(aC,n);if(sC(i))return[];if(e[0]===i)return[e];if(e.includes(i))return[];let{outputs:r}=rL(i);return Array.from(r).map(n=>t([...e,i],n[0])).reduce((t,e)=>t.concat(e),[])},ak,aw,aM,aE,aO,aA,aR),aP=((t,e,n,i,r,s)=>class extends t{constructor(t,n){let a=r(t),o=i(a,{...rM,...n});super(t,!1,o,s(a)?e():null),this._nativeAnalyserNode=o}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){let e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){let e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(aN,ab,rR,av,aw,aA),aD=new WeakSet,aI=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(a_),aj=(t=>e=>(t[0]=e,t[0]))(new Uint32Array(1)),aV=((t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{let a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();let l=n.length,u=n.getChannelData(o),c=i.length;for(let t=a<0?-a:0;t+a<l&&t<c;t+=1)i[t]=u[t+a]},n.copyToChannel=(i,r,s=0)=>{let a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();let l=n.length,u=n.getChannelData(o),c=i.length;for(let t=a<0?-a:0;t+a<l&&t<c;t+=1)u[t+a]=i[t]}})(aj,rR),aF=(t=>e=>{let n,i;n=e.copyFromChannel,e.copyFromChannel=(i,r,s=0)=>{let a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)},i=e.copyToChannel,e.copyToChannel=(n,r,s=0)=>{let a=t(s),o=t(r);if(a<e.length)return i.call(e,n,o,a)}})(aj),aq=((t,e,n,i,r,s,a,o)=>{let l=null;return class u{constructor(u){if(null===r)throw Error("Missing the native OfflineAudioContext constructor.");let{length:c,numberOfChannels:h,sampleRate:p}={...rP,...u};null===l&&(l=new r(1,1,44100));let d=null!==i&&e(s,s)?new i({length:c,numberOfChannels:h,sampleRate:p}):l.createBuffer(h,c,p);if(0===d.numberOfChannels)throw n();return"function"!=typeof d.copyFromChannel?(a(d),rN(d)):e(rO,()=>rO(d))||o(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===u.prototype||t.has(e)}}})(aD,ag,s4,aI,aT,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(aI),aV,aF),a$=(t,e)=>{let n=s1(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(n).connect(t.destination);let i=()=>{e.removeEventListener("ended",i),e.disconnect(n),n.disconnect()};e.addEventListener("ended",i)},aB=async(t,e,n)=>{let i=rW(t);await Promise.all(Array.from(i.activeInputs).map(async([t,i])=>{let r=ay(t),s=await r.render(t,e);r6(t)||s.connect(n,i)}))},aL=(t,e,n)=>aB(e,t,n),aW=((t,e,n,i,r,s,a,o,l,u,c)=>(h,p)=>{let d=h.createBufferSource();return sF(d,p),sB(d,p,"playbackRate"),sV(d,p,"buffer"),sV(d,p,"loop"),sV(d,p,"loopEnd"),sV(d,p,"loopStart"),e(n,()=>n(h))||sL(d),e(i,()=>i(h))||l(d),e(r,()=>r(h))||u(d,h),e(s,()=>s(h))||sW(d),e(a,()=>a(h))||c(d,h),e(o,()=>o(h))||sz(d),t(h,d),d})(a$,ag,t=>{let e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},t=>{let e=t.createBufferSource();e.buffer=t.createBuffer(1,1,44100);try{e.start(0,1)}catch{return!1}return!0},t=>{let e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},aa,ao,al,t=>{t.start=(e=>(n=0,i=0,r)=>{let s=t.buffer,a=null===s?i:Math.min(s.duration,i);null!==s&&a>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,a,r)})(t.start)},(t,e)=>{let n=e.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=n),ar(t,"buffer",e=>()=>{let i=e.call(t);return i===n?null:i},e=>i=>e.call(t,null===i?n:i))},au),az=(i=t=>{let e=rW(t);if(null===e.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer},(t,e,n)=>(i(e).replay(n),aB(e,t,n))),aU=()=>{let t=new WeakMap,e=null,n=null,i=async(i,r)=>{let s=r5(i),a=rE(s,r);return a||(s=aW(r,{buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,loop:s.loop,loopEnd:s.loopEnd,loopStart:s.loopStart,playbackRate:s.playbackRate.value}),null!==e&&s.start(...e),null!==n&&s.stop(n)),t.set(r,s),a?await aL(r,i.playbackRate,s.playbackRate):await az(r,i.playbackRate,s.playbackRate),await ax(i,r,s),s};return{set start(value){e=value},set stop(value){n=value},render(e,n){let r=t.get(n);return void 0!==r?Promise.resolve(r):i(e,n)}}},aX=((t,e,n,i,r,s,a,o,l,u,c,h,p)=>(d,f,m,g=null,v=null)=>{let y=m.value,x=new ri(y),b=f?i(x):null,w={get defaultValue(){return y},get maxValue(){return null===g?m.maxValue:g},get minValue(){return null===v?m.minValue:v},get value(){return m.value},set value(value){m.value=value,w.setValueAtTime(value,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===b&&x.flush(d.context.currentTime),x.add(r(t)),m.cancelAndHoldAtTime(t);else{let e=Array.from(x).pop();null===b&&x.flush(d.context.currentTime),x.add(r(t));let n=Array.from(x).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return w},cancelScheduledValues:t=>(null===b&&x.flush(d.context.currentTime),x.add(s(t)),m.cancelScheduledValues(t),w),exponentialRampToValueAtTime(t,e){if(0===t||!Number.isFinite(e)||e<0)throw RangeError();let n=d.context.currentTime;return null===b&&x.flush(n),0===Array.from(x).length&&(x.add(u(y,n)),m.setValueAtTime(y,n)),x.add(a(t,e)),m.exponentialRampToValueAtTime(t,e),w},linearRampToValueAtTime(t,e){let n=d.context.currentTime;return null===b&&x.flush(n),0===Array.from(x).length&&(x.add(u(y,n)),m.setValueAtTime(y,n)),x.add(o(t,e)),m.linearRampToValueAtTime(t,e),w},setTargetAtTime:(t,e,n)=>(null===b&&x.flush(d.context.currentTime),x.add(l(t,e,n)),m.setTargetAtTime(t,e,n),w),setValueAtTime:(t,e)=>(null===b&&x.flush(d.context.currentTime),x.add(u(t,e)),m.setValueAtTime(t,e),w),setValueCurveAtTime(t,e,n){let i=t instanceof Float32Array?t:new Float32Array(t);if(null!==h&&"webkitAudioContext"===h.name){let t=e+n,r=d.context.sampleRate,s=Math.ceil(e*r),a=Math.floor(t*r),o=a-s,l=new Float32Array(o);for(let t=0;t<o;t+=1){let a=(i.length-1)/n*((s+t)/r-e),o=Math.floor(a),u=Math.ceil(a);l[t]=o===u?i[o]:(1-(a-o))*i[o]+(1-(u-a))*i[u]}null===b&&x.flush(d.context.currentTime),x.add(c(l,e,n)),m.setValueCurveAtTime(l,e,n);let u=a/r;u<t&&p(w,l[l.length-1],u),p(w,i[i.length-1],t)}else null===b&&x.flush(d.context.currentTime),x.add(c(i,e,n)),m.setValueCurveAtTime(i,e,n);return w}};return n.set(w,m),e.set(w,d),t(w,b),w})((t,e)=>{ro.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})},aC,rl,t=>({replay(e){for(let n of t)if("exponentialRampToValue"===n.type){let{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){let{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){let{startTime:t,target:i,timeConstant:r}=n;e.setTargetAtTime(i,t,r)}else if("setValue"===n.type){let{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else if("setValueCurve"===n.type){let{duration:t,startTime:i,values:r}=n;e.setValueCurveAtTime(r,i,t)}else throw Error("Can't apply an unknown automation.")}}),t=>({cancelTime:t,type:"cancelAndHold"}),t=>({cancelTime:t,type:"cancelScheduledValues"}),(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),iY,iZ,aS,as),aG=((t,e,n,i,r,s,a,o)=>class extends t{constructor(t,i){let o=s(t),l={...rI,...i},u=r(o,l),c=a(o),h=c?e():null;super(t,!1,u,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==l.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,c,u.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){let e="function"==typeof t?o(this,t):null;this._nativeAudioBufferSourceNode.onended=e;let n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){rA(this);let t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),rD(this)&&rk(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(aN,aU,aX,sE,aW,aw,aA,ac),aH=((t,e,n,i,r,s,a,o)=>class extends t{constructor(t,n){let i=s(t),l=a(i),u=r(i,n,l);super(t,!1,u,l?e(o):null),this._isNodeOfNativeOfflineAudioContext=l,this._nativeAudioDestinationNode=u}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(aN,t=>{let e=new WeakMap,n=async(n,i)=>{let r=i.destination;return e.set(i,r),await t(n,i,r),r};return{render(t,i){let r=e.get(i);return void 0!==r?Promise.resolve(r):n(t,i)}}},rR,sE,((t,e)=>(n,i,r)=>{let s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});let a=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",t=>()=>t.call(a),t=>e=>{t.call(a,e);try{s.channelCount=e}catch(t){if(e>s.maxChannelCount)throw t}}),e(a,"channelCountMode",t=>()=>t.call(a),t=>e=>{t.call(a,e),s.channelCountMode=e}),e(a,"channelInterpretation",t=>()=>t.call(a),t=>e=>{t.call(a,e),s.channelInterpretation=e}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a})(s1,ar),aw,aA,ax),aY=((t,e,n,i,r)=>()=>{let s=new WeakMap,a=async(a,o)=>{let l=n(a),u=rE(l,o);return u||(l=e(o,{Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type})),s.set(o,l),u?(await t(o,a.Q,l.Q),await t(o,a.detune,l.detune),await t(o,a.frequency,l.frequency),await t(o,a.gain,l.gain)):(await i(o,a.Q,l.Q),await i(o,a.detune,l.detune),await i(o,a.frequency,l.frequency),await i(o,a.gain,l.gain)),await r(a,o,l),l};return{render(t,e){let n=s.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}})(aL,sZ,r5,az,ax),aZ=(t,e)=>af.set(t,e),aQ=((t,e,n,i,r,s,a,o)=>class extends t{constructor(t,i){let l=s(t),u=r(l,{...sv,...i}),c=a(l);super(t,!1,u,c?n():null),this._Q=e(this,c,u.Q,34028234663852886e22,-34028234663852886e22),this._detune=e(this,c,u.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=e(this,c,u.frequency,t.sampleRate/2,0),this._gain=e(this,c,u.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=u,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw i();throw t}if(t.length!==e.length||e.length!==n.length)throw i()}})(aN,aX,aY,sO,sZ,aw,aA,aZ),aK=((t,e)=>(n,i,r)=>{let s=new Set;return n.connect=(r=>(a,o=0,l=0)=>{let u=0===s.size;if(e(a))return r.call(n,a,o,l),t(s,[a,o,l],t=>t[0]===a&&t[1]===o&&t[2]===l,!0),u&&i(),a;r.call(n,a,o),t(s,[a,o],t=>t[0]===a&&t[1]===o,!0),u&&i()})(n.connect),n.disconnect=(t=>(i,a,o)=>{let l=s.size>0;if(void 0===i)t.apply(n),s.clear();else if("number"==typeof i)for(let e of(t.call(n,i),s))e[1]===i&&s.delete(e);else for(let r of(e(i)?t.call(n,i,a,o):t.call(n,i,a),s))r[0]===i&&(void 0===a||r[1]===a)&&(void 0===o||r[2]===o)&&s.delete(r);let u=0===s.size;l&&u&&r()})(n.disconnect),n})(rY,aE),aJ=((t,e)=>(n,i)=>{let r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),sF(r,i),r})(aS,((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});let r=n.createBufferSource();e(i,()=>{let t=i.numberOfInputs;for(let e=0;e<t;e+=1)r.connect(i,0,e)},()=>r.disconnect(i))})(sE,aK)),a0=((t,e,n,i,r)=>class extends t{constructor(t,s){let a=i(t);super(t,!1,n(a,{...sy,...s}),r(a)?e():null)}})(aN,()=>{let t=new WeakMap,e=async(e,n)=>{let i=r5(e);return rE(i,n)||(i=aJ(n,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,numberOfInputs:i.numberOfInputs})),t.set(n,i),await ax(e,n,i),i};return{render(n,i){let r=t.get(i);return void 0!==r?Promise.resolve(r):e(n,i)}}},aJ,aw,aA),a1=((t,e,n,i,r,s)=>class extends t{constructor(t,a){let o=i(t);super(t,!1,n(o,s({...sx,...a})),r(o)?e():null)}})(aN,()=>{let t=new WeakMap,e=async(e,n)=>{let i=r5(e);return rE(i,n)||(i=sK(n,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,numberOfOutputs:i.numberOfOutputs})),t.set(n,i),await ax(e,n,i),i};return{render(n,i){let r=t.get(i);return void 0!==r?Promise.resolve(r):e(n,i)}}},sK,aw,aA,t=>({...t,channelCount:t.numberOfOutputs})),a2=(t,{offset:e,...n})=>{let i=t.createBuffer(1,2,44100),r=aW(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=s1(t,{...n,gain:e}),a=i.getChannelData(0);return a[0]=1,a[1]=1,r.buffer=i,r.loop=!0,a$(t,r),aK(sJ({get bufferSize(){return},get channelCount(){return s.channelCount},set channelCount(value){s.channelCount=value},get channelCountMode(){return s.channelCountMode},set channelCountMode(value){s.channelCountMode=value},get channelInterpretation(){return s.channelInterpretation},set channelInterpretation(value){s.channelInterpretation=value},get context(){return s.context},get inputs(){return[]},get numberOfInputs(){return r.numberOfInputs},get numberOfOutputs(){return s.numberOfOutputs},get offset(){return s.gain},get onended(){return r.onended},set onended(value){r.onended=value},addEventListener:(...t)=>r.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>r.dispatchEvent(t[0]),removeEventListener:(...t)=>r.removeEventListener(t[0],t[1],t[2]),start(t=0){r.start.call(r,t)},stop(t=0){r.stop.call(r,t)}},s),()=>r.connect(s),()=>r.disconnect(s))},a3=((t,e,n,i,r)=>(s,a)=>{if(void 0===s.createConstantSource)return n(s,a);let o=s.createConstantSource();return sF(o,a),sB(o,a,"offset"),e(i,()=>i(s))||sW(o),e(r,()=>r(s))||sz(o),t(s,o),o})(a$,ag,a2,aa,al),a4=((t,e,n,i,r,s,a)=>class extends t{constructor(t,a){let o=r(t),l=i(o,{...sb,...a}),u=s(o),c=u?n():null;super(t,!1,l,c),this._constantSourceNodeRenderer=c,this._nativeConstantSourceNode=l,this._offset=e(this,u,l.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){let e="function"==typeof t?a(this,t):null;this._nativeConstantSourceNode.onended=e;let n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){rA(this);let t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),rD(this)&&rk(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(aN,aX,()=>{let t=new WeakMap,e=null,n=null,i=async(i,r)=>{let s=r5(i),a=rE(s,r);return a||(s=a3(r,{channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,offset:s.offset.value}),null!==e&&s.start(e),null!==n&&s.stop(n)),t.set(r,s),a?await aL(r,i.offset,s.offset):await az(r,i.offset,s.offset),await ax(i,r,s),s};return{set start(value){e=value},set stop(value){n=value},render(e,n){let r=t.get(n);return void 0!==r?Promise.resolve(r):i(e,n)}}},a3,aw,aA,ac),a5=((t,e)=>(n,i)=>{let r=n.createConvolver();if(sF(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),sV(r,i,"buffer"),i.channelCount>2||(e(r,"channelCount",t=>()=>t.call(r),e=>n=>{if(n>2)throw t();return e.call(r,n)}),"max"===i.channelCountMode))throw t();return e(r,"channelCountMode",t=>()=>t.call(r),e=>n=>{if("max"===n)throw t();return e.call(r,n)}),r})(s4,ar),a8=((t,e,n,i,r,s)=>class extends t{constructor(t,a){let o=i(t),l={...sw,...a},u=n(o,l);super(t,!1,u,r(o)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=u,null!==l.buffer&&s(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){let t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(aN,((t,e,n)=>()=>{let i=new WeakMap,r=async(r,s)=>{let a=e(r);return rE(a,s)||(a=t(s,{buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize})),i.set(s,a),rK(a)?await n(r,s,a.inputs[0]):await n(r,s,a),a};return{render(t,e){let n=i.get(e);return void 0!==n?Promise.resolve(n):r(t,e)}}})(a5,r5,ax),a5,aw,aA,aZ),a6=((t,e,n,i,r,s,a)=>class extends t{constructor(t,o){let l=r(t),u={...sA,...o},c=i(l,u),h=s(l);super(t,!1,c,h?n(u.maxDelayTime):null),this._delayTime=e(this,h,c.delayTime),a(this,u.maxDelayTime)}get delayTime(){return this._delayTime}})(aN,aX,t=>{let e=new WeakMap,n=async(n,i)=>{let r=r5(n),s=rE(r,i);return s||(r=s0(i,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,delayTime:r.delayTime.value,maxDelayTime:t})),e.set(i,r),s?await aL(i,n.delayTime,r.delayTime):await az(i,n.delayTime,r.delayTime),await ax(n,i,r),r};return{render(t,i){let r=e.get(i);return void 0!==r?Promise.resolve(r):n(t,i)}}},s0,aw,aA,aZ),a9=(a=s4,(t,e)=>{let n=t.createDynamicsCompressor();if(sF(n,e),e.channelCount>2||"max"===e.channelCountMode)throw a();return sB(n,e,"attack"),sB(n,e,"knee"),sB(n,e,"ratio"),sB(n,e,"release"),sB(n,e,"threshold"),n}),a7=((t,e,n,i,r,s,a,o)=>class extends t{constructor(t,r){let l=s(t),u=i(l,{...sS,...r}),c=a(l);super(t,!1,u,c?n():null),this._attack=e(this,c,u.attack),this._knee=e(this,c,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,c,u.ratio),this._release=e(this,c,u.release),this._threshold=e(this,c,u.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){let e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){let e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(aN,aX,((t,e,n,i,r)=>()=>{let s=new WeakMap,a=async(a,o)=>{let l=n(a),u=rE(l,o);return u||(l=e(o,{attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value})),s.set(o,l),u?(await t(o,a.attack,l.attack),await t(o,a.knee,l.knee),await t(o,a.ratio,l.ratio),await t(o,a.release,l.release),await t(o,a.threshold,l.threshold)):(await i(o,a.attack,l.attack),await i(o,a.knee,l.knee),await i(o,a.ratio,l.ratio),await i(o,a.release,l.release),await i(o,a.threshold,l.threshold)),await r(a,o,l),l};return{render(t,e){let n=s.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}})(aL,a9,r5,az,ax),a9,s4,aw,aA,aZ),ot=((t,e,n,i,r,s)=>class extends t{constructor(t,a){let o=r(t),l=i(o,{...sM,...a}),u=s(o);super(t,!1,l,u?n():null),this._gain=e(this,u,l.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}})(aN,aX,()=>{let t=new WeakMap,e=async(e,n)=>{let i=r5(e),r=rE(i,n);return r||(i=s1(n,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:i.gain.value})),t.set(n,i),r?await aL(n,e.gain,i.gain):await az(n,e.gain,i.gain),await ax(e,n,i),i};return{render(n,i){let r=t.get(i);return void 0!==r?Promise.resolve(r):e(n,i)}}},s1,aw,aA),oe=((t,e,n,i)=>(r,s,{channelCount:a,channelCountMode:o,channelInterpretation:l,feedback:u,feedforward:c})=>{let h=sX(s,r.sampleRate),p=u instanceof Float64Array?u:new Float64Array(u),d=c instanceof Float64Array?c:new Float64Array(c),f=p.length,m=d.length,g=Math.min(f,m);if(0===f||f>20)throw i();if(0===p[0])throw e();if(0===m||m>20)throw i();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<m;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}let v=n(r,h,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=l;let y=[],x=[],b=[];for(let t=0;t<a;t+=1){y.push(0);let t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),x.push(t),b.push(e)}v.onaudioprocess=t=>{let e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){let i=e.getChannelData(t),r=n.getChannelData(t);y[t]=sP(p,f,d,m,g,x[t],b[t],y[t],32,i,r)}};let w=r.sampleRate/2;return sJ({get bufferSize(){return h},get channelCount(){return v.channelCount},set channelCount(value){v.channelCount=value},get channelCountMode(){return v.channelCountMode},set channelCountMode(value){v.channelCountMode=value},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(value){v.channelInterpretation=value},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener:(...t)=>v.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>v.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();let r=e.length;for(let t=0;t<r;t+=1){let r=-Math.PI*(e[t]/w),s=[Math.cos(r),Math.sin(r)],a=function(t,e){let n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}(s2(d,s),s2(p,s));n[t]=Math.sqrt(a[0]*a[0]+a[1]*a[1]),i[t]=Math.atan2(a[1],a[0])}},removeEventListener:(...t)=>v.removeEventListener(t[0],t[1],t[2])},v)})(sO,sE,s3,s4),on=((t,e,n,i)=>r=>t(sj,()=>sj(r))?Promise.resolve(t(i,i)).then(t=>{if(!t){let t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination)}return r.startRendering()}):new Promise(t=>{let n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()}))(ag,s1,s3,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);let n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()})})(s1,aT)),oi=((t,e,n,i,r,s)=>class extends t{constructor(t,a){let o=i(t),l=r(o),u={...sN,...a},c=e(o,l?null:t.baseLatency,u);super(t,!1,c,l?n(u.feedback,u.feedforward):null),sR(c),this._nativeIIRFilterNode=c,s(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(aN,(t,e,n)=>{if(void 0===t.createIIRFilter)return oe(t,e,n);let i=t.createIIRFilter(n.feedforward,n.feedback);return sF(i,n),i},((t,e,n,i,r)=>(s,a)=>{let o=new WeakMap,l=null,u=async(u,c)=>{let h=null,p=e(u),d=rE(p,c);if(void 0===c.createIIRFilter?h=t(c,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(p=c.createIIRFilter(a,s)),o.set(c,null===h?p:h),null!==h){if(null===l){if(null===n)throw Error("Missing the native OfflineAudioContext constructor.");let t=new n(u.context.destination.channelCount,u.context.length,c.sampleRate);l=(async()=>(await i(u,t,t.destination),sD(await r(t),c,s,a)))()}let t=await l;return h.buffer=t,h.start(0),h}return await i(u,c,p),p};return{render(t,e){let n=o.get(e);return void 0!==n?Promise.resolve(n):u(t,e)}}})(aW,r5,aT,ax,on),aw,aA,aZ),or=((t,e,n,i,r,s,a,o)=>(l,u)=>{let c=u.listener,{forwardX:h,forwardY:p,forwardZ:d,positionX:f,positionY:m,positionZ:g,upX:v,upY:y,upZ:x}=void 0===c.forwardX?(()=>{let h=new Float32Array(1),p=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),d=a(u),f=!1,m=[0,0,-1,0,1,0],g=[0,0,0],v=()=>{if(f)return;f=!0;let t=i(u,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{let e=[s(t,h,0),s(t,h,1),s(t,h,2),s(t,h,3),s(t,h,4),s(t,h,5)];e.some((t,e)=>t!==m[e])&&(c.setOrientation(...e),m=e);let n=[s(t,h,6),s(t,h,7),s(t,h,8)];n.some((t,e)=>t!==g[e])&&(c.setPosition(...n),g=n)},p.connect(t)},y=t=>e=>{e!==m[t]&&(m[t]=e,c.setOrientation(...m))},x=t=>e=>{e!==g[t]&&(g[t]=e,c.setPosition(...g))},b=(e,i,s)=>{var a,c,h,f,m,g,y;let x=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});x.connect(p,0,e),x.start(),Object.defineProperty(x.offset,"defaultValue",{get:()=>i});let b=t({context:l},d,x.offset,34028234663852886e22,-34028234663852886e22);return o(b,"value",t=>()=>t.call(b),t=>e=>{try{t.call(b,e)}catch(t){if(9!==t.code)throw t}v(),d&&s(e)}),a=b.cancelAndHoldAtTime,b.cancelAndHoldAtTime=d?()=>{throw r()}:(...t)=>{let e=a.apply(b,t);return v(),e},c=b.cancelScheduledValues,b.cancelScheduledValues=d?()=>{throw r()}:(...t)=>{let e=c.apply(b,t);return v(),e},h=b.exponentialRampToValueAtTime,b.exponentialRampToValueAtTime=d?()=>{throw r()}:(...t)=>{let e=h.apply(b,t);return v(),e},f=b.linearRampToValueAtTime,b.linearRampToValueAtTime=d?()=>{throw r()}:(...t)=>{let e=f.apply(b,t);return v(),e},m=b.setTargetAtTime,b.setTargetAtTime=d?()=>{throw r()}:(...t)=>{let e=m.apply(b,t);return v(),e},g=b.setValueAtTime,b.setValueAtTime=d?()=>{throw r()}:(...t)=>{let e=g.apply(b,t);return v(),e},y=b.setValueCurveAtTime,b.setValueCurveAtTime=d?()=>{throw r()}:(...t)=>{let e=y.apply(b,t);return v(),e},b};return{forwardX:b(0,0,y(0)),forwardY:b(1,0,y(1)),forwardZ:b(2,-1,y(2)),positionX:b(6,0,x(0)),positionY:b(7,0,x(1)),positionZ:b(8,0,x(2)),upX:b(3,0,y(3)),upY:b(4,1,y(4)),upZ:b(5,0,y(5))}})():c;return{get forwardX(){return h},get forwardY(){return p},get forwardZ(){return d},get positionX(){return f},get positionY(){return m},get positionZ(){return g},get upX(){return v},get upY(){return y},get upZ(){return x}}})(aX,aJ,a3,s3,s4,an,aA,ar),os=new WeakMap,oa=((t,e,n,i,r,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,ru.set(this,n),i(n)&&r.set(n,new Set),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){let e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;let n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(aH,or,ak,aA,os,ac),oo=((t,e,n,i,r,s)=>(a,o)=>{let l=a.createOscillator();return sF(l,o),sB(l,o,"detune"),sB(l,o,"frequency"),void 0!==o.periodicWave?l.setPeriodicWave(o.periodicWave):sV(l,o,"type"),e(n,()=>n(a))||sW(l),e(i,()=>i(a))||s(l,a),e(r,()=>r(a))||sz(l),t(a,l),l})(a$,ag,aa,ao,al,au),ol=((t,e,n,i,r)=>()=>{let s=new WeakMap,a=null,o=null,l=null,u=async(u,c)=>{let h=n(u),p=rE(h,c);return p||(h=e(c,{channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:null===a?void 0:a,type:h.type}),null!==o&&h.start(o),null!==l&&h.stop(l)),s.set(c,h),p?(await t(c,u.detune,h.detune),await t(c,u.frequency,h.frequency)):(await i(c,u.detune,h.detune),await i(c,u.frequency,h.frequency)),await r(u,c,h),h};return{set periodicWave(value){a=value},set start(value){o=value},set stop(value){l=value},render(t,e){let n=s.get(e);return void 0!==n?Promise.resolve(n):u(t,e)}}})(aL,oo,r5,az,ax),ou=((t,e,n,i,r,s,a)=>class extends t{constructor(t,a){let o=r(t),l={...s8,...a},u=n(o,l),c=s(o),h=c?i():null,p=t.sampleRate/2;super(t,!1,u,h),this._detune=e(this,c,u.detune,153600,-153600),this._frequency=e(this,c,u.frequency,p,-p),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==l.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=l.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){let e="function"==typeof t?a(this,t):null;this._nativeOscillatorNode.onended=e;let n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){rA(this);let t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),rD(this)&&rk(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(aN,aX,oo,ol,aw,aA,ac),oc=(t,e)=>{let n=aW(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1});return n.buffer=t.createBuffer(1,2,44100),n.loop=!0,n.connect(e),n.start(),()=>{n.stop(),n.disconnect(e)}},oh=((t,e,n,i,r)=>(s,{curve:a,oversample:o,...l})=>{let u=s.createWaveShaper(),c=s.createWaveShaper();sF(u,l),sF(c,l);let h=n(s,{...l,gain:1}),p=n(s,{...l,gain:-1}),d=n(s,{...l,gain:1}),f=n(s,{...l,gain:-1}),m=null,g=!1,v=null,y={get bufferSize(){return},get channelCount(){return u.channelCount},set channelCount(value){h.channelCount=value,p.channelCount=value,u.channelCount=value,d.channelCount=value,c.channelCount=value,f.channelCount=value},get channelCountMode(){return u.channelCountMode},set channelCountMode(value){h.channelCountMode=value,p.channelCountMode=value,u.channelCountMode=value,d.channelCountMode=value,c.channelCountMode=value,f.channelCountMode=value},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(value){h.channelInterpretation=value,p.channelInterpretation=value,u.channelInterpretation=value,d.channelInterpretation=value,c.channelInterpretation=value,f.channelInterpretation=value},get context(){return u.context},get curve(){return v},set curve(value){if(null!==value&&value.length<2)throw e();if(null===value)u.curve=value,c.curve=value;else{let t=value.length,e=new Float32Array(t+2-t%2),n=new Float32Array(t+2-t%2);e[0]=value[0],n[0]=-value[t-1];let i=Math.ceil((t+1)/2),r=(t+1)/2-1;for(let s=1;s<i;s+=1){let a=s/i*r,o=Math.floor(a),l=Math.ceil(a);e[s]=o===l?value[o]:(1-(a-o))*value[o]+(1-(l-a))*value[l],n[s]=o===l?-value[t-1-o]:-((1-(a-o))*value[t-1-o])-(1-(l-a))*value[t-1-l]}e[i]=t%2==1?value[i-1]:(value[i-2]+value[i-1])/2,u.curve=e,c.curve=n}v=value,g&&(i(v)&&null===m?m=t(s,h):null!==m&&(m(),m=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(value){u.oversample=value,c.oversample=value},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};return null!==a&&(y.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==y.oversample&&(y.oversample=o),r(sJ(y,d),()=>{h.connect(u).connect(d),h.connect(p).connect(c).connect(f).connect(d),g=!0,i(v)&&(m=t(s,h))},()=>{h.disconnect(u),u.disconnect(d),h.disconnect(p),p.disconnect(c),c.disconnect(f),f.disconnect(d),g=!1,null!==m&&(m(),m=null)})})(oc,sE,s1,ai,aK),op=((t,e,n,i,r,s,a)=>(o,l)=>{let u=o.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===o.createGain().gain.automationRate)return n(o,l);sF(u,l);let c=null===l.curve||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(null!==c&&c.length<2)throw e();sV(u,{curve:c},"curve"),sV(u,l,"oversample");let h=null,p=!1;return a(u,"curve",t=>()=>t.call(u),e=>n=>(e.call(u,n),p&&(i(n)&&null===h?h=t(o,u):i(n)||null===h||(h(),h=null)),n)),r(u,()=>{p=!0,i(u.curve)&&(h=t(o,u))},()=>{p=!1,null!==h&&(h(),h=null)})})(oc,sE,oh,ai,aK,aS,ar),od=(r=((t,e,n,i,r,s,a,o,l,u)=>(c,{coneInnerAngle:h,coneOuterAngle:p,coneOuterGain:d,distanceModel:f,maxDistance:m,orientationX:g,orientationY:v,orientationZ:y,panningModel:x,positionX:b,positionY:w,positionZ:T,refDistance:A,rolloffFactor:C,...k})=>{let S=c.createPanner();if(k.channelCount>2||"max"===k.channelCountMode)throw a();sF(S,k);let M={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},E=n(c,{...M,channelInterpretation:"speakers",numberOfInputs:6}),O=i(c,{...k,gain:1}),R=i(c,{...M,gain:1}),N=i(c,{...M,gain:0}),P=i(c,{...M,gain:0}),D=i(c,{...M,gain:0}),I=i(c,{...M,gain:0}),j=i(c,{...M,gain:0}),V=r(c,256,6,1),F=s(c,{...M,curve:new Float32Array([1,1]),oversample:"none"}),q=[g,v,y],$=[b,w,T],B=new Float32Array(1);V.onaudioprocess=({inputBuffer:t})=>{let e=[l(t,B,0),l(t,B,1),l(t,B,2)];e.some((t,e)=>t!==q[e])&&(S.setOrientation(...e),q=e);let n=[l(t,B,3),l(t,B,4),l(t,B,5)];n.some((t,e)=>t!==$[e])&&(S.setPosition(...n),$=n)},Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0});let L={get bufferSize(){return},get channelCount(){return S.channelCount},set channelCount(value){if(value>2)throw a();O.channelCount=value,S.channelCount=value},get channelCountMode(){return S.channelCountMode},set channelCountMode(value){if("max"===value)throw a();O.channelCountMode=value,S.channelCountMode=value},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(value){O.channelInterpretation=value,S.channelInterpretation=value},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(value){S.coneInnerAngle=value},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(value){S.coneOuterAngle=value},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(value){if(value<0||value>1)throw e();S.coneOuterGain=value},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(value){S.distanceModel=value},get inputs(){return[O]},get maxDistance(){return S.maxDistance},set maxDistance(value){if(value<0)throw RangeError();S.maxDistance=value},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return R.gain},get orientationY(){return N.gain},get orientationZ(){return P.gain},get panningModel(){return S.panningModel},set panningModel(value){S.panningModel=value},get positionX(){return D.gain},get positionY(){return I.gain},get positionZ(){return j.gain},get refDistance(){return S.refDistance},set refDistance(value){if(value<0)throw RangeError();S.refDistance=value},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(value){if(value<0)throw RangeError();S.rolloffFactor=value},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])};return h!==L.coneInnerAngle&&(L.coneInnerAngle=h),p!==L.coneOuterAngle&&(L.coneOuterAngle=p),d!==L.coneOuterGain&&(L.coneOuterGain=d),f!==L.distanceModel&&(L.distanceModel=f),m!==L.maxDistance&&(L.maxDistance=m),g!==L.orientationX.value&&(L.orientationX.value=g),v!==L.orientationY.value&&(L.orientationY.value=v),y!==L.orientationZ.value&&(L.orientationZ.value=y),x!==L.panningModel&&(L.panningModel=x),b!==L.positionX.value&&(L.positionX.value=b),w!==L.positionY.value&&(L.positionY.value=w),T!==L.positionZ.value&&(L.positionZ.value=T),A!==L.refDistance&&(L.refDistance=A),C!==L.rolloffFactor&&(L.rolloffFactor=C),(1!==q[0]||0!==q[1]||0!==q[2])&&S.setOrientation(...q),(0!==$[0]||0!==$[1]||0!==$[2])&&S.setPosition(...$),u(sJ(L,S),()=>{O.connect(S),t(O,F,0,0),F.connect(R).connect(E,0,0),F.connect(N).connect(E,0,1),F.connect(P).connect(E,0,2),F.connect(D).connect(E,0,3),F.connect(I).connect(E,0,4),F.connect(j).connect(E,0,5),E.connect(V).connect(c.destination)},()=>{O.disconnect(S),o(O,F,0,0),F.disconnect(R),R.disconnect(E),F.disconnect(N),N.disconnect(E),F.disconnect(P),P.disconnect(E),F.disconnect(D),D.disconnect(E),F.disconnect(I),I.disconnect(E),F.disconnect(j),j.disconnect(E),E.disconnect(V),V.disconnect(c.destination)})})(rJ,sE,aJ,s1,s3,op,s4,r4,an,aK),(t,e)=>{let n=t.createPanner();return void 0===n.orientationX?r(t,e):(sF(n,e),sB(n,e,"orientationX"),sB(n,e,"orientationY"),sB(n,e,"orientationZ"),sB(n,e,"positionX"),sB(n,e,"positionY"),sB(n,e,"positionZ"),sV(n,e,"coneInnerAngle"),sV(n,e,"coneOuterAngle"),sV(n,e,"coneOuterGain"),sV(n,e,"distanceModel"),sV(n,e,"maxDistance"),sV(n,e,"panningModel"),sV(n,e,"refDistance"),sV(n,e,"rolloffFactor"),n)}),of=((t,e,n,i,r,s,a,o,l,u)=>()=>{let c=new WeakMap,h=null,p=async(p,d)=>{let f=null,m=s(p),g={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},v={...g,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=rE(m,d);if("bufferSize"in m?f=i(d,{...g,gain:1}):y||(m=r(d,{...v,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value})),c.set(d,null===f?m:f),null!==f){if(null===h){if(null===a)throw Error("Missing the native OfflineAudioContext constructor.");let t=new a(6,p.context.length,d.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),h=(async()=>{let e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(e,i)=>{let r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:+(0===i)});return await o(t,e,r.offset),r}));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return u(t)})()}let t=await h,s=i(d,{...g,gain:1});await l(p,d,s);let c=[];for(let e=0;e<t.numberOfChannels;e+=1)c.push(t.getChannelData(e));let m=[c[0][0],c[1][0],c[2][0]],y=[c[3][0],c[4][0],c[5][0]],x=i(d,{...g,gain:1}),b=r(d,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});s.connect(x).connect(b.inputs[0]),b.connect(f);for(let e=128;e<t.length;e+=128){let t=[c[0][e],c[1][e],c[2][e]],n=[c[3][e],c[4][e],c[5][e]];if(t.some((t,e)=>t!==m[e])||n.some((t,e)=>t!==y[e])){m=t,y=n;let a=e/d.sampleRate;x.gain.setValueAtTime(0,a),x=i(d,{...g,gain:0}),b=r(d,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),x.gain.setValueAtTime(1,a),s.connect(x).connect(b.inputs[0]),b.connect(f)}}return f}return y?(await t(d,p.orientationX,m.orientationX),await t(d,p.orientationY,m.orientationY),await t(d,p.orientationZ,m.orientationZ),await t(d,p.positionX,m.positionX),await t(d,p.positionY,m.positionY),await t(d,p.positionZ,m.positionZ)):(await o(d,p.orientationX,m.orientationX),await o(d,p.orientationY,m.orientationY),await o(d,p.orientationZ,m.orientationZ),await o(d,p.positionX,m.positionX),await o(d,p.positionY,m.positionY),await o(d,p.positionZ,m.positionZ)),rK(m)?await l(p,d,m.inputs[0]):await l(p,d,m),m};return{render(t,e){let n=c.get(e);return void 0!==n?Promise.resolve(n):p(t,e)}}})(aL,aJ,a3,s1,od,r5,aT,az,ax,on),om=((t,e,n,i,r,s,a)=>class extends t{constructor(t,o){let l=r(t),u=n(l,{...s6,...o}),c=s(l);super(t,!1,u,c?i():null),this._nativePannerNode=u,this._orientationX=e(this,c,u.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=e(this,c,u.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=e(this,c,u.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=e(this,c,u.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=e(this,c,u.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=e(this,c,u.positionZ,34028234663852886e22,-34028234663852886e22),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(aN,aX,od,of,aw,aA,aZ),og=((t,e,n,i)=>class r{constructor(r,s){let a=t(e(r),i({...s9,...s}));return n.add(a),a}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===r.prototype||n.has(t)}})((t,{disableNormalization:e,imag:n,real:i})=>{let r=n instanceof Float32Array?n:new Float32Array(n),s=i instanceof Float32Array?i:new Float32Array(i),a=t.createPeriodicWave(s,r,{disableNormalization:e});if(Array.from(n).length<2)throw rR();return a},aw,new WeakSet,t=>{let{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}}),o_=((t,e)=>(n,i)=>{let r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);let s=n.createStereoPanner();return sF(s,i),sB(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:t=>{if(t!==r)throw e()}}),s})(((t,e,n,i,r,s)=>{let a=new Float32Array([1,1]),o=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},c=(t,e,r,s)=>{let c=new Float32Array(16385),h=new Float32Array(16385);for(let t=0;t<16385;t+=1){let e=t/16384*o;c[t]=Math.cos(e),h[t]=Math.sin(e)}let p=n(t,{...l,gain:0}),d=i(t,{...u,curve:c}),f=i(t,{...u,curve:a}),m=n(t,{...l,gain:0}),g=i(t,{...u,curve:h});return{connectGraph(){e.connect(p),e.connect(void 0===f.inputs?f:f.inputs[0]),e.connect(m),f.connect(r),r.connect(void 0===d.inputs?d:d.inputs[0]),r.connect(void 0===g.inputs?g:g.inputs[0]),d.connect(p.gain),g.connect(m.gain),p.connect(s,0,0),m.connect(s,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===f.inputs?f:f.inputs[0]),e.disconnect(m),f.disconnect(r),r.disconnect(void 0===d.inputs?d:d.inputs[0]),r.disconnect(void 0===g.inputs?g:g.inputs[0]),d.disconnect(p.gain),g.disconnect(m.gain),p.disconnect(s,0,0),m.disconnect(s,0,1)}}},h=(t,r,s,c)=>{let h=new Float32Array(16385),p=new Float32Array(16385),d=new Float32Array(16385),f=new Float32Array(16385),m=Math.floor(8192.5);for(let t=0;t<16385;t+=1)if(t>m){let e=(t-m)/(16384-m)*o;h[t]=Math.cos(e),p[t]=Math.sin(e),d[t]=0,f[t]=1}else{let e=t/(16384-m)*o;h[t]=1,p[t]=0,d[t]=Math.cos(e),f[t]=Math.sin(e)}let g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...l,gain:0}),y=i(t,{...u,curve:h}),x=n(t,{...l,gain:0}),b=i(t,{...u,curve:p}),w=i(t,{...u,curve:a}),T=n(t,{...l,gain:0}),A=i(t,{...u,curve:d}),C=n(t,{...l,gain:0}),k=i(t,{...u,curve:f});return{connectGraph(){r.connect(g),r.connect(void 0===w.inputs?w:w.inputs[0]),g.connect(v,0),g.connect(x,0),g.connect(T,1),g.connect(C,1),w.connect(s),s.connect(void 0===y.inputs?y:y.inputs[0]),s.connect(void 0===b.inputs?b:b.inputs[0]),s.connect(void 0===A.inputs?A:A.inputs[0]),s.connect(void 0===k.inputs?k:k.inputs[0]),y.connect(v.gain),b.connect(x.gain),A.connect(T.gain),k.connect(C.gain),v.connect(c,0,0),T.connect(c,0,0),x.connect(c,0,1),C.connect(c,0,1)},disconnectGraph(){r.disconnect(g),r.disconnect(void 0===w.inputs?w:w.inputs[0]),g.disconnect(v,0),g.disconnect(x,0),g.disconnect(T,1),g.disconnect(C,1),w.disconnect(s),s.disconnect(void 0===y.inputs?y:y.inputs[0]),s.disconnect(void 0===b.inputs?b:b.inputs[0]),s.disconnect(void 0===A.inputs?A:A.inputs[0]),s.disconnect(void 0===k.inputs?k:k.inputs[0]),y.disconnect(v.gain),b.disconnect(x.gain),A.disconnect(T.gain),k.disconnect(C.gain),v.disconnect(c,0,0),T.disconnect(c,0,0),x.disconnect(c,0,1),C.disconnect(c,0,1)}}},p=(t,e,n,i,s)=>{if(1===e)return c(t,n,i,s);if(2===e)return h(t,n,i,s);throw r()};return(e,{channelCount:i,channelCountMode:a,pan:o,...l})=>{if("max"===a)throw r();let u=t(e,{...l,channelCount:1,channelCountMode:a,numberOfInputs:2}),c=n(e,{...l,channelCount:i,channelCountMode:a,gain:1}),h=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:o}),{connectGraph:d,disconnectGraph:f}=p(e,i,c,h,u);Object.defineProperty(h.gain,"defaultValue",{get:()=>0}),Object.defineProperty(h.gain,"maxValue",{get:()=>1}),Object.defineProperty(h.gain,"minValue",{get:()=>-1});let m=!1;return s(sJ({get bufferSize(){return},get channelCount(){return c.channelCount},set channelCount(value){c.channelCount!==value&&(m&&f(),{connectGraph:d,disconnectGraph:f}=p(e,value,c,h,u),m&&d()),c.channelCount=value},get channelCountMode(){return c.channelCountMode},set channelCountMode(value){if("clamped-max"===value||"max"===value)throw r();c.channelCountMode=value},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(value){c.channelInterpretation=value},get context(){return c.context},get inputs(){return[c]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get pan(){return h.gain},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2])},u),()=>{d(),m=!0},()=>{f(),m=!1})}})(aJ,sK,s1,op,s4,aK),s4),ov=((t,e,n,i,r)=>()=>{let s=new WeakMap,a=async(a,o)=>{let l=n(a),u=rE(l,o);return u||(l=e(o,{channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value})),s.set(o,l),u?await t(o,a.pan,l.pan):await i(o,a.pan,l.pan),rK(l)?await r(a,o,l.inputs[0]):await r(a,o,l),l};return{render(t,e){let n=s.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}})(aL,o_,r5,az,ax),oy=((t,e,n,i,r,s)=>class extends t{constructor(t,a){let o=r(t),l=n(o,{...s7,...a}),u=s(o);super(t,!1,l,u?i():null),this._pan=e(this,u,l.pan)}get pan(){return this._pan}})(aN,aX,o_,ov,aw,aA),ox=((t,e,n)=>()=>{let i=new WeakMap,r=async(r,s)=>{let a=e(r);return rE(a,s)||(a=t(s,{channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample})),i.set(s,a),rK(a)?await n(r,s,a.inputs[0]):await n(r,s,a),a};return{render(t,e){let n=i.get(e);return void 0!==n?Promise.resolve(n):r(t,e)}}})(op,r5,ax),ob=((t,e,n,i,r,s,a)=>class extends t{constructor(t,e){let o=r(t),l=n(o,{...ae,...e});super(t,!0,l,s(o)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=l,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(aN,sE,op,ox,aw,aA,aZ),ow=(t=>null!==t&&t.isSecureContext)(a_),oT=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(a_),oA=new WeakMap,oC=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(oA,aT),ok=ow?((t,e,n,i,r,s,a,o,l,u,c,h,p)=>{let d=0;return(f,m,g={credentials:"omit"})=>{let v=c.get(f);if(void 0!==v&&v.has(m))return Promise.resolve();let y=u.get(f);if(void 0!==y){let t=y.get(m);if(void 0!==t)return t}let x=s(f),b=void 0===x.audioWorklet?r(m).then(([t,e])=>{let[i,r]=r_(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}
})})(window,'_AWGS')`)}).then(()=>{let t=p._AWGS.pop();if(void 0===t)throw SyntaxError();i(x.currentTime,x.sampleRate,()=>t(class{},void 0,(t,n)=>{if(""===t.trim())throw e();let i=rp.get(x);if(void 0!==i){if(i.has(t))throw e();ry(n),rv(n.parameterDescriptors),i.set(t,n)}else ry(n),rv(n.parameterDescriptors),rp.set(x,new Map([[t,n]]))},x.sampleRate,void 0,void 0))}):Promise.all([r(m),Promise.resolve(t(h,h))]).then(([[t,e],n])=>{let i=d+1;d=i;let[r,s]=r_(t,e),u=new Blob([`${r};((AudioWorkletProcessor,registerProcessor)=>{${s}
})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(u);return x.audioWorklet.addModule(c,g).then(()=>{if(o(x))return x;let t=a(x);return t.audioWorklet.addModule(c,g).then(()=>t)}).then(t=>{if(null===l)throw SyntaxError();try{new l(t,`__sac${i}`)}catch{throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(c))});return void 0===y?u.set(f,new Map([[m,b]])):y.set(m,b),b.then(()=>{let t=c.get(f);void 0===t?c.set(f,new Set([m])):t.add(m)}).finally(()=>{let t=u.get(f);void 0!==t&&t.delete(m)}),b}})(ag,s4,(t=>e=>new Promise((n,i)=>{if(null===t)return void i(SyntaxError());let r=t.document.head;if(null===r)i(SyntaxError());else{let s=t.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),l=t.onerror,u=()=>{t.onerror=l,URL.revokeObjectURL(o)};t.onerror=(e,n,r,s,a)=>n===o||n===t.location.href&&1===r&&1===s?(u(),i(a),!1):null!==l?l(e,n,r,s,a):void 0,s.onerror=()=>{u(),i(SyntaxError())},s.onload=()=>{u(),n()},s.src=o,s.type="module",r.appendChild(s)}}))(a_),oT,(s=()=>new DOMException("","AbortError"),async t=>{try{let e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw s()}),aw,oC,aA,aR,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;let n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n),s=!1,a=!1;try{await i.audioWorklet.addModule(r);let e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>a=!0,n.connect(e),n.start(0),await i.startRendering(),await new Promise(t=>setTimeout(t))}catch{}finally{URL.revokeObjectURL(r)}return s&&!a})(aR,aT),a_):void 0,oS=t=>aM(t)||aA(t),oM=((t,e,n,i,r,s,a,o,l,u,c,h,p,d,f,m,g,v,y,x)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new s(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new a(this,{numberOfOutputs:t})}createConstantSource(){return new o(this)}createConvolver(){return new l(this)}createDelay(t=1){return new c(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new g(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new v(this,{...n,imag:e,real:t})}createStereoPanner(){return new y(this)}createWaveShaper(){return new x(this)}decodeAudioData(t,e,n){return u(this._nativeContext,t).then(t=>("function"==typeof e&&e(t),t),t=>{throw"function"==typeof n&&n(t),t})}})(ok,aP,aq,aG,aQ,a0,a1,a4,a8,((t,e,n,i,r,s,a,o,l,u,c)=>(h,p)=>{let d=a(h)?h:s(h);if(r.has(p))return Promise.reject(n());try{r.add(p)}catch{}return e(l,()=>l(d))?d.decodeAudioData(p).then(n=>(sT(p).catch(()=>{}),e(o,()=>o(n))||c(n),t.add(n),n)):new Promise((e,n)=>{let r=async()=>{try{await sT(p)}catch{}},s=t=>{n(t),r()};try{d.decodeAudioData(p,n=>{"function"!=typeof n.copyFromChannel&&(u(n),rN(n)),t.add(n),r().then(()=>e(n))},t=>{null===t?s(i()):s(t)})}catch(t){s(t)}})})(aD,ag,()=>new DOMException("","DataCloneError"),()=>new DOMException("","EncodingError"),new WeakSet,aw,oS,rO,sj,aV,aF),a6,a7,ot,oi,oa,ou,om,og,oy,ob),oE=((t,e,n,i)=>class extends t{constructor(t,r){let s=n(t),a=e(s,r);if(i(s))throw TypeError();super(t,!0,a,null),this._nativeMediaElementAudioSourceNode=a}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(aN,(t,e)=>t.createMediaElementSource(e.mediaElement),aw,aA),oO=((t,e,n,i)=>class extends t{constructor(t,r){let s=n(t);if(i(s))throw TypeError();let a=e(s,{...sI,...r});super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(aN,(t,e)=>{let n=t.createMediaStreamDestination();return sF(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},aw,aA),oR=((t,e,n,i)=>class extends t{constructor(t,r){let s=n(t),a=e(s,r);if(i(s))throw TypeError();super(t,!0,a,null),this._nativeMediaStreamAudioSourceNode=a}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(aN,(t,{mediaStream:e})=>{let n=e.getAudioTracks();n.sort((t,e)=>t.id<e.id?-1:+(t.id>e.id));let i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r},aw,aA),oN=((t,e,n)=>class extends t{constructor(t,i){super(t,!0,e(n(t),i),null)}})(aN,(t,{mediaStreamTrack:e})=>{if("function"==typeof t.createMediaStreamTrackSource)return t.createMediaStreamTrackSource(e);let n=new MediaStream([e]),i=t.createMediaStreamSource(n);if("audio"!==e.kind)throw sE();if(aA(t))throw TypeError();return i},aw),oP=((t,e,n,i,r,s,a,o,l)=>class extends t{constructor(t={}){let e;if(null===l)throw Error("Missing the native AudioContext constructor.");try{e=new l(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!rX(t.latencyHint))throw TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);let{latencyHint:r}=t,{sampleRate:s}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===r?512/s:"interactive"===r||void 0===r?256/s:"playback"===r?1024/s:128*Math.max(2,Math.min(128,Math.round(r*s/128)))/s,this._nativeAudioContext=e,"webkitAudioContext"===l.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";let t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),rU(this)}))}createMediaElementSource(t){return new r(this,{mediaElement:t})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(t){return new a(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new o(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise((t,e)=>{let n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t})}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t})}})(oM,sE,s4,at,oE,oO,oR,oN,aS),oD=t=>{let e=os.get(t);if(void 0===e)throw Error("The context has no set of AudioWorkletNodes.");return e},oI=(t,e)=>{oD(t).add(e)},oj=(t,e,n=0,i=0)=>{let r=t[n];if(void 0===r)throw rR();return se(e)?r.connect(e,0,i):r.connect(e,0)},oV=(t,e)=>{oD(t).delete(e)},oF=(t=>(e,n,i,r=0)=>void 0===n?e.forEach(t=>t.disconnect()):"number"==typeof n?sk(t,e,n).disconnect():se(n)?void 0===i?e.forEach(t=>t.disconnect(n)):void 0===r?sk(t,e,i).disconnect(n,0):sk(t,e,i).disconnect(n,0,r):void 0===i?e.forEach(t=>t.disconnect(n)):sk(t,e,i).disconnect(n,0))(rR),oq=new WeakMap,o$=((t,e,n,i,r,s,a,o,l,u,c,h,p)=>(d,f,m,g)=>{let v,y;if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw l();let x=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(x.some(t=>t<1))throw l();if(x.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw l();let b=g.channelCount*g.numberOfInputs,w=x.reduce((t,e)=>t+e,0),T=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(b+T>6||w>6)throw l();let A=new MessageChannel,C=[],k=[];for(let t=0;t<g.numberOfInputs;t+=1)C.push(a(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),k.push(r(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));let S=[];if(void 0!==m.parameterDescriptors)for(let{defaultValue:t,maxValue:e,minValue:n,name:i}of m.parameterDescriptors){let r=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[i]?g.parameterData[i]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?34028234663852886e22:e},minValue:{get:()=>void 0===n?-34028234663852886e22:n}}),S.push(r)}let M=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+T)}),E=sX(f,d.sampleRate),O=o(d,E,b+T,Math.max(1,w)),R=r(d,{channelCount:Math.max(1,w),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,w)}),N=[];for(let t=0;t<g.numberOfOutputs;t+=1)N.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:x[t]}));for(let t=0;t<g.numberOfInputs;t+=1){C[t].connect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[t].connect(M,e,t*g.channelCount+e)}let P=new sh(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map(({name:t},e)=>{let n=S[e];return n.connect(M,0,b+e),n.start(0),[t,n.offset]}));M.connect(O);let D=g.channelInterpretation,I=null,j=0===g.numberOfOutputs?[O]:N,V={get bufferSize(){return E},get channelCount(){return g.channelCount},set channelCount(_){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(_){throw n()},get channelInterpretation(){return D},set channelInterpretation(value){for(let t of C)t.channelInterpretation=value;D=value},get context(){return O.context},get inputs(){return C},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return I},set onprocessorerror(value){"function"==typeof I&&V.removeEventListener("processorerror",I),"function"==typeof(I="function"==typeof value?value:null)&&V.addEventListener("processorerror",I)},get parameters(){return P},get port(){return A.port2},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,j),disconnect:u.bind(null,j),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])},F=new Map;A.port1.addEventListener=(v=A.port1.addEventListener,(...t)=>{if("message"===t[0]){let e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){let n=F.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{c(d.currentTime,d.sampleRate,()=>e(t))},F.set(e,t[1]))}}return v.call(A.port1,t[0],t[1],t[2])}),A.port1.removeEventListener=(y=A.port1.removeEventListener,(...t)=>{if("message"===t[0]){let e=F.get(t[1]);void 0!==e&&(F.delete(t[1]),t[1]=e)}return y.call(A.port1,t[0],t[1],t[2])});let q=null;Object.defineProperty(A.port1,"onmessage",{get:()=>q,set:t=>{"function"==typeof q&&A.port1.removeEventListener("message",q),"function"==typeof(q="function"==typeof t?t:null)&&(A.port1.addEventListener("message",q),A.port1.start())}}),m.prototype.port=A.port1;let $=null;sY(d,V,m,g).then(t=>$=t);let B=sm(g.numberOfInputs,g.channelCount),L=sm(g.numberOfOutputs,x),W=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce((t,{name:e})=>({...t,[e]:new Float32Array(128)}),{}),z=!0,U=()=>{g.numberOfOutputs>0&&O.disconnect(R);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){let n=N[t];for(let i=0;i<x[t];i+=1)R.disconnect(n,e+i,i);e+=x[t]}},X=new Map;O.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==$){let n=h(V);for(let i=0;i<E;i+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)sd(t,B[e],n,n,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach(({name:e},n)=>{sd(t,W,e,b+n,i)});for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<x[t];e+=1)0===L[t][e].byteLength&&(L[t][e]=new Float32Array(128));try{let t=B.map((t,e)=>{if(n[e].size>0)return X.set(e,E/128),t;let i=X.get(e);return void 0===i?[]:(t.every(t=>t.every(t=>0===t))&&(1===i?X.delete(e):X.set(e,i-1)),t)});z=c(d.currentTime+i/d.sampleRate,d.sampleRate,()=>$.process(t,L,W));for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let r=0;r<x[t];r+=1)sf(e,L[t],r,n+r,i);n+=x[t]}}catch(t){z=!1,V.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!z){for(let t=0;t<g.numberOfInputs;t+=1){C[t].disconnect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[i].disconnect(M,e,t*g.channelCount+e)}if(void 0!==m.parameterDescriptors){let t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){let t=S[e];t.disconnect(M,0,b+e),t.stop()}}M.disconnect(O),O.onaudioprocess=null,G?U():Z();break}}}};let G=!1,H=a(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Y=()=>O.connect(H).connect(d.destination),Z=()=>{O.disconnect(H),H.disconnect()};return Y(),p(V,()=>{if(z){Z(),g.numberOfOutputs>0&&O.connect(R);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){let n=N[t];for(let i=0;i<x[t];i+=1)R.connect(n,e+i,i);e+=x[t]}}G=!0},()=>{z&&(Y(),U()),G=!1})})(oj,rR,sE,aJ,sK,a3,s1,s3,s4,oF,oT,t=>rx(oq,t),aK),oB=((t,e,n,i,r)=>(s,a,o,l,u,c)=>{if(null!==o)try{let e=new o(s,l,c),i=new Map,a=null;if(Object.defineProperties(e,{channelCount:{get:()=>c.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>a,set:t=>{"function"==typeof a&&e.removeEventListener("processorerror",a),a="function"==typeof t?t:null,"function"==typeof a&&e.addEventListener("processorerror",a)}}}),e.addEventListener=(t=>(...n)=>{if("processorerror"===n[0]){let t="function"==typeof n[1]?n[1]:"object"==typeof n[1]&&null!==n[1]&&"function"==typeof n[1].handleEvent?n[1].handleEvent:null;if(null!==t){let e=i.get(n[1]);void 0!==e?n[1]=e:(n[1]=e=>{"error"===e.type?(Object.defineProperties(e,{type:{value:"processorerror"}}),t(e)):t(new ErrorEvent(n[0],{...e}))},i.set(t,n[1]))}}return t.call(e,"error",n[1],n[2]),t.call(e,...n)})(e.addEventListener),e.removeEventListener=(t=>(...n)=>{if("processorerror"===n[0]){let t=i.get(n[1]);void 0!==t&&(i.delete(n[1]),n[1]=t)}return t.call(e,"error",n[1],n[2]),t.call(e,n[0],n[1],n[2])})(e.removeEventListener),0!==c.numberOfOutputs){let t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return e.connect(t).connect(s.destination),r(e,()=>t.disconnect(),()=>t.connect(s.destination))}return e}catch(t){if(11===t.code)throw i();throw t}if(void 0===u)throw i();return sU(c),e(s,a,u,c)})(sE,o$,s1,s4,aK),oL=((t,e,n,i,r,s,a,o,l,u,c,h,p,d,f,m)=>(g,v,y)=>{let x=new WeakMap,b=null,w=async(o,w)=>{let T=c(o),A=null,C=rE(T,w),k=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(null===h){let t=k.reduce((t,e)=>t+e,0),n=r(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let t=0;t<o.numberOfOutputs;t+=1)s.push(i(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:k[t]}));let u=a(w,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});u.connect=e.bind(null,s),u.disconnect=l.bind(null,s),A=[n,s,u]}else C||(T=new h(w,g));if(x.set(w,null===A?T:A[2]),null!==A){if(null===b){if(void 0===y)throw Error("Missing the processor constructor.");if(null===p)throw Error("Missing the native OfflineAudioContext constructor.");let t=o.channelCount*o.numberOfInputs,e=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,n=t+e,l=async()=>{let l=new p(n,128*Math.ceil(o.context.length/128),w.sampleRate),u=[],c=[];for(let t=0;t<v.numberOfInputs;t+=1)u.push(a(l,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),c.push(r(l,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));let h=await Promise.all(Array.from(o.parameters.values()).map(async t=>{let e=s(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(l,t,e.offset),e})),g=i(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<v.numberOfInputs;t+=1){u[t].connect(c[t]);for(let e=0;e<v.channelCount;e+=1)c[t].connect(g,e,t*v.channelCount+e)}for(let[e,n]of h.entries())n.connect(g,0,t+e),n.start(0);return g.connect(l.destination),await Promise.all(u.map(t=>f(o,l,t))),m(l)};b=s_(o,0===n?null:await l(),w,v,k,y,u)}let t=await b,e=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[l,c,h]=A;null!==t&&(e.buffer=t,e.start(0)),e.connect(l);for(let t=0,e=0;t<o.numberOfOutputs;t+=1){let n=c[t];for(let i=0;i<k[t];i+=1)l.connect(n,e+i,i);e+=k[t]}return h}if(C)for(let[e,n]of o.parameters.entries())await t(w,n,T.parameters.get(e));else for(let[t,e]of o.parameters.entries())await d(w,e,T.parameters.get(t));return await f(o,w,T),T};return{render(t,e){o(e,t);let n=x.get(e);return void 0!==n?Promise.resolve(n):w(t,e)}}})(aL,oj,aW,aJ,sK,a3,s1,oV,oF,oT,r5,aR,aT,az,ax,on),oW=t=>oA.get(t),oz=(t,e)=>{oq.set(t,e)},oU=ow?((t,e,n,i,r,s,a,o,l,u,c,h,p,d)=>class extends e{constructor(e,d,f){var m;let g=o(e),v=l(g),y=c({...sp,...f});p(y);let x=rp.get(g),b=null==x?void 0:x.get(d),w=r(v||"closed"!==g.state?g:null!=(m=a(g))?m:g,v?null:e.baseLatency,u,d,b,y);super(e,!0,w,v?i(d,y,b):null);let T=[];w.parameters.forEach((t,e)=>{let i=n(this,v,t);T.push([e,i])}),this._nativeAudioWorkletNode=w,this._onprocessorerror=null,this._parameters=new sh(T),v&&t(g,this);let{activeInputs:A}=s(this);h(w,A)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){let e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;let n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(oI,aN,aX,oL,oB,rL,oW,aw,aA,aR,t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),oz,t=>{let{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},ac):void 0,oX=((t,e)=>(n,i,r)=>{if(null===e)throw Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(s4,aT),oG=((t,e,n,i,r,s,a,o)=>(l,u)=>n(l).render(l,u).then(()=>Promise.all(Array.from(i(u)).map(t=>n(t).render(t,u)))).then(()=>r(u)).then(n=>("function"!=typeof n.copyFromChannel?(a(n),rN(n)):e(s,()=>s(n))||o(n),t.add(n),n)))(aD,ag,ay,oD,on,rO,aV,aF),oH=((t,e,n,i,r)=>class extends t{constructor(t,n,r){let s;if("number"==typeof t&&void 0!==n&&void 0!==r)s={length:n,numberOfChannels:t,sampleRate:r};else if("object"==typeof t)s=t;else throw Error("The given parameters are not valid.");let{length:a,numberOfChannels:o,sampleRate:l}={...s5,...s},u=i(o,a,l);e(sj,()=>sj(u))||u.addEventListener("statechange",(()=>{let t=0,e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(u,o),this._length=a,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,rU(this)}))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t))}})(oM,ag,sE,oX,oG),oY=((t,e)=>n=>e(t.get(n))||e(n))(ru,aM),oZ=t=>ra.has(t)||aE(t),oQ=t=>rl.has(t)||aO(t),oK=((t,e)=>n=>e(t.get(n))||e(n))(ru,aA);function oJ(t){return void 0===t}function o0(t){return void 0!==t}function o1(t){return"number"==typeof t}function o2(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function o3(t){return Array.isArray(t)}function o4(t){return"string"==typeof t}function o5(t){return o4(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function o8(t,e){if(!t)throw Error(e)}function o6(t,e,n=1/0){if(!(e<=t&&t<=n))throw RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function o9(t){t.isOffline||"running"===t.state||ln('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let o7=!1,lt=!1,le=console;function ln(...t){le.warn(...t)}let li="object"==typeof self?self:null,lr=li&&(li.hasOwnProperty("AudioContext")||li.hasOwnProperty("webkitAudioContext"));function ls(t,e,n,i){var r,s=arguments.length,a=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,n,a):r(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a}function la(t,e,n,i){return new(n||(n=Promise))(function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,o)}l((i=i.apply(t,e||[])).next())})}Object.create;Object.create,"function"==typeof SuppressedError&&SuppressedError;class lo{constructor(t,e,n,i){this._callback=t,this._type=e,this._minimumUpdateInterval=Math.max(128/(i||44100),.001),this.updateInterval=n,this._createClock()}_createWorker(){let t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),e=new Worker(URL.createObjectURL(t));e.onmessage=this._callback.bind(this),this._worker=e}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){var e;this._updateInterval=Math.max(t,this._minimumUpdateInterval),"worker"===this._type&&(null==(e=this._worker)||e.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function ll(t,...e){if(!e.length)return t;let n=e.shift();if(o2(t)&&o2(n))for(let e in n){var i,r;(i=e,r=n[e],"value"===i||oQ(r)||oZ(r)||r instanceof aq)?t[e]=n[e]:o2(n[e])?(t[e]||Object.assign(t,{[e]:{}}),ll(t[e],n[e])):Object.assign(t,{[e]:n[e]})}return ll(t,...e)}function lu(t,e,n=[],i){let r={},s=Array.from(e);if(o2(s[0])&&i&&!Reflect.has(s[0],i)&&(Object.keys(s[0]).some(e=>Reflect.has(t,e))||(ll(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())),1===s.length&&o2(s[0]))ll(r,s[0]);else for(let t=0;t<n.length;t++)o0(s[t])&&(r[n[t]]=s[t]);return ll(t,r)}function lc(t,e){return oJ(t)?e:t}function lh(t,e){return e.forEach(e=>{Reflect.has(t,e)&&delete t[e]}),t}class lp{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||li&&this.toString()===li.TONE_DEBUG_CLASS)&&function(...t){le.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}function ld(t,e){return t>e+1e-6}function lf(t,e){return ld(t,e)||lg(t,e)}function lm(t,e){return t+1e-6<e}function lg(t,e){return 1e-6>Math.abs(t-e)}function l_(t,e,n){return Math.max(Math.min(t,n),e)}lp.version=iX;class lv extends lp{constructor(){super(),this.name="Timeline",this._timeline=[];let t=lu(lv.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(o8(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){let e=this._timeline[this.length-1];o8(lf(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{let e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){let t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){let e=this._timeline.indexOf(t);return -1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){let n=this._search(t,e);return -1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){let n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){let e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];let n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(lg(this._timeline[e].time,t)){for(let n=e;n>=0;n--)if(lg(this._timeline[n].time,t))e=n;else break;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&lf(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){let e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){let e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return -1;let n=0,i=this._timeline.length,r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2),s=this._timeline[i],a=this._timeline[i+1];if(lg(s[e],t)){for(let n=i;n<this._timeline.length;n++)if(lg(this._timeline[n][e],t))i=n;else break;return i}if(lm(s[e],t)&&ld(a[e],t))return i;ld(s[e],t)?r=i:n=i+1}return -1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){let n=this._search(t);return -1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){let n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return -1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){let n=this._search(t);if(-1!==n&&lg(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0;e--)if(lg(this._timeline[e].time,t))i=e;else break;this._iterate(t=>{e(t)},i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}let ly=[];function lx(t){ly.push(t)}let lb=[];function lw(t){lb.push(t)}class lT extends lp{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(t=>{oJ(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)}),this}once(t,e){let n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach(t=>{if(oJ(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(oJ(e))this._events[t]=[];else{let n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){let n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{let n=Object.getOwnPropertyDescriptor(lT.prototype,e);Object.defineProperty(t.prototype,e,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class lA extends lT{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class lC extends lA{constructor(){var t,e;super(),this.name="Context",this._constants=new Map,this._timeouts=new lv,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;let n=lu(lC.getDefaults(),arguments,["context"]);n.context?(this._context=n.context,this._latencyHint=(null==(t=arguments[0])?void 0:t.latencyHint)||""):(this._context=new oP({latencyHint:n.latencyHint}),this._latencyHint=n.latencyHint),this._ticker=new lo(this.emit.bind(this,"tick"),n.clockSource,n.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[(null==(e=arguments[0])?void 0:e.hasOwnProperty("updateInterval"))?"_lookAhead":"lookAhead"]=n.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){if(!this._initialized){var t;t=this,ly.forEach(e=>e(t)),this._initialized=!0}return this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return o8(oY(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return o8(oY(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return o8(oY(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){o8(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){o8(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){o8(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){o8(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){var n;return n=this.rawContext,o8(o0(oU),"AudioWorkletNode only works in a secure context (https or localhost)"),new(n instanceof(null==li?void 0:li.BaseAudioContext)?null==li?void 0:li.AudioWorkletNode:oU)(n,t,e)}addAudioWorkletModule(t){return la(this,void 0,void 0,function*(){o8(o0(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(t)),yield this._workletPromise})}workletsAreReady(){return la(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get lookAhead(){return this._lookAhead}set lookAhead(t){this._lookAhead=t,this.updateInterval=t?t/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return oY(this._context)?this._context.resume():Promise.resolve()}close(){return la(this,void 0,void 0,function*(){var t;oY(this._context)&&"closed"!==this.state&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(t=this,lb.forEach(e=>e(t)))})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{let e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;let i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this.close(),this}_timeoutLoop(){let t=this.now();this._timeouts.forEachBefore(t,t=>{t.callback(),this._timeouts.remove(t)})}setTimeout(t,e){this._timeoutIds++;let n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){let n=++this._timeoutIds,i=()=>{let r=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:r+e})};return i(),n}}class lk extends lA{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t){return la(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}}function lS(t,e){o3(e)?e.forEach(e=>lS(t,e)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}let lM=()=>{};class lE extends lp{constructor(){super(),this.name="ToneAudioBuffer",this.onload=lM;let t=lu(lE.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,o4(t.url)?this.load(t.url).catch(t.onerror):t.url&&this.set(t.url)}static getDefaults(){return{onerror:lM,onload:lM,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:lP().sampleRate}set(t){return t instanceof lE?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return la(this,void 0,void 0,function*(){let e=lE.load(t).then(t=>{this.set(t),this.onload(this)});lE.downloads.push(e);try{yield e}finally{let t=lE.downloads.indexOf(e);lE.downloads.splice(t,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){let e=o3(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=lP(),s=r.createBuffer(n,i,r.sampleRate),a=e||1!==n?t:[t];for(let t=0;t<n;t++)s.copyToChannel(a[t],t);return this._buffer=s,this}toMono(t){if(o1(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length),e=this.numberOfChannels;for(let n=0;n<e;n++){let e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map(t=>t/e),this.fromArray(t)}return this}toArray(t){if(o1(t))return this.getChannelData(t);{if(1===this.numberOfChannels)return this.toArray(0);let t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){o8(this.loaded,"Buffer is not loaded");let n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);o8(n<i,"The start time must be less than the end time");let r=lP().createBuffer(this.numberOfChannels,i-n,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)r.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new lE(r)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new lE().fromArray(t)}static fromUrl(t){return la(this,void 0,void 0,function*(){let e=new lE;return yield e.load(t)})}static load(t){return la(this,void 0,void 0,function*(){let e=""===lE.baseUrl||lE.baseUrl.endsWith("/")?lE.baseUrl:lE.baseUrl+"/",n=yield fetch(e+t);if(!n.ok)throw Error(`could not load url: ${t}`);let i=yield n.arrayBuffer();return yield lP().decodeAudioData(i)})}static supportsType(t){let e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return la(this,void 0,void 0,function*(){for(yield Promise.resolve();lE.downloads.length;)yield lE.downloads[0]})}}lE.baseUrl="",lE.downloads=[];class lO extends lC{constructor(){var t,e,n,i,r,s;super({clockSource:"offline",context:(t=arguments[0],oK(t))?arguments[0]:(e=arguments[0],n=arguments[1]*arguments[2],i=arguments[2],new oH(e,n,i)),lookAhead:0,updateInterval:(r=arguments[0],oK(r))?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,s=arguments[0],this._duration=oK(s)?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return la(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;let n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise(t=>setTimeout(t,1)))}})}render(){return la(this,arguments,void 0,function*(t=!0){return yield this.workletsAreReady(),yield this._renderClock(t),new lE((yield this._context.startRendering()))})}close(){return Promise.resolve()}}let lR=new lk,lN=lR;function lP(){return lN===lR&&lr&&function(t,e=!1){e&&lN.dispose(),lN=oY(t)?new lC(t):oK(t)?new lO(t):t}(new lC),lN}if(li&&!li.TONE_SILENCE_LOGGING){let t=` * Tone.js v${iX} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function lD(t){return Math.pow(2,t/12)}let lI=440;function lj(t){return Math.round(lV(t))}function lV(t){return 69+12*Math.log2(t/lI)}function lF(t){return lI*Math.pow(2,(t-69)/12)}class lq extends lp{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{let n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{let e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof lq&&this.fromType(this._val),oJ(this._val))return this._noArg();if(o4(this._val)&&oJ(this._units)){for(let t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(o2(this._val)){let t=0;for(let e in this._val)if(o0(this._val[e])){let n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(o0(this._units)){let t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return o4(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class l$ extends lq{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{let e=new l$(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){let n=new this.constructor(this.context,t).valueOf(),i=this.valueOf(),r=Math.round(i/n);return i+(r*n-i)*e}toNotation(){let t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){let n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new l$(this.context,e[0]).toSeconds();return e.forEach(e=>{let r=new l$(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r)}),n}toBarsBeatsSixteenths(){let t=this._beatsToUnits(1),e=this.valueOf()/t,n=Math.floor((e=parseFloat(e.toFixed(4)))/this._getTimeSignature()),i=e%1*4;e=Math.floor(e)%this._getTimeSignature();let r=i.toString();return r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3))),[n,e,i].join(":")}toTicks(){let t=this._beatsToUnits(1);return this.valueOf()/t*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return lj(this.toFrequency())}_now(){return this.context.now()}}class lB extends l${constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return lI}static set A4(t){lI=t}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:lB.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(t,e){let n=lL[t.toLowerCase()]+(parseInt(e,10)+1)*12;return"midi"===this.defaultUnits?n:lB.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new lB(this.context,this.valueOf()*lD(t))}harmonize(t){return t.map(t=>this.transpose(t))}toMidi(){return lj(this.valueOf())}toNote(){let t=Math.round(12*Math.log2(this.toFrequency()/lB.A4))+57,e=Math.floor(t/12);return e<0&&(t+=-12*e),lW[t%12]+e.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let t=this._beatsToUnits(1);return Math.floor(this.valueOf()/t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return lF(t)}static ftom(t){return lj(t)}}let lL={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},lW=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class lz extends l${constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class lU extends lp{constructor(){super();let t=lu(lU.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:lP()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return oJ(t)&&o7&&!lt&&(lt=!0,ln("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing")),new l$(this.context,t).toSeconds()}toFrequency(t){return new lB(this.context,t).toFrequency()}toTicks(t){return new lz(this.context,t).toTicks()}_getPartialProperties(t){let e=this.get();return Object.keys(e).forEach(n=>{oJ(t[n])&&delete e[n]}),e}get(){let t=this.constructor.getDefaults();return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){let n=this[e];o0(n)&&o0(n.value)&&o0(n.setValueAtTime)?t[e]=n.value:n instanceof lU?t[e]=n._getPartialProperties(t[e]):o3(n)||o1(n)||o4(n)||"boolean"==typeof n?t[e]=n:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&o0(this[e])&&(this[e]&&o0(this[e].value)&&o0(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof lU?this[e].set(t[e]):this[e]=t[e])}),this}}class lX extends lv{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){let e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return o6(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){let n=this._search(e);for(let e=n;e>=0;e--){let n=this._timeline[e];if(n.state===t)return n}}getNextState(t,e){let n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){let n=this._timeline[e];if(n.state===t)return n}}}class lG extends lU{constructor(){let t=lu(lG.getDefaults(),arguments,["param","units","convert"]);for(super(t),this.name="Param",this.overridden=!1,this._minOutput=1e-7,o8(o0(t.param)&&(oQ(t.param)||t.param instanceof lG),"param must be an AudioParam");!oQ(t.param);)t.param=t.param._param;this._swappable=!!o0(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new lv(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,o0(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(lU.getDefaults(),{convert:!0,units:"number"})}get value(){let t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return o0(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return o0(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return o0(this.maxValue)&&o0(this.minValue)&&o6(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){if(this.convert&&!this.overridden)if(this._is(t,"time"))return this.toSeconds(t);else if(this._is(t,"decibels"))return Math.pow(10,t/20);else if(this._is(t,"frequency"))return this.toFrequency(t);else return t;return this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?Math.log(t)/Math.LN10*20:t}setValueAtTime(t,e){let n=this.toSeconds(e),i=this._fromType(t);return o8(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){let e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e),r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"===i.type&&(null===n||"setValueAtTime"===n.type)){let t,n=this._events.getBefore(i.time);t=null===n?this._initialValue:n.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,t,i.value,i.constant,e))}else if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){let e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else r=i.value;return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){let n=this._fromType(t),i=this.toSeconds(e);return o8(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=lg(n,0)?this._minOutput:n,this._assertRange(n);let i=this.toSeconds(e);return o8(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e);let i=Math.log((n=this.toSeconds(n))+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){let i=this._fromType(t);o8(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");let r=this.toSeconds(e);return this._assertRange(i),o8(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);let r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);let s=n/(t.length-1);for(let n=1;n<t.length;n++){let r=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(r),e+n*s)}return this}cancelScheduledValues(t){let e=this.toSeconds(t);return o8(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){let e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));o8(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);let i=this._events.get(e),r=this._events.getAfter(e);return i&&lg(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){let e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);let n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){let i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)}),this}setParam(t){o8(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}class lH extends lU{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return o0(this.input)?oQ(this.input)||this.input instanceof lG?1:this.input.numberOfInputs:0}get numberOfOutputs(){return o0(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return o0(t)&&(t instanceof lH||oZ(t))}_getInternalNodes(){let t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){let t=this._getInternalNodes();o8(t.length>0,"ToneAudioNode does not have any internal nodes");let e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return lZ(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ln("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return function(t,e,n=0,i=0){if(o0(e))for(;e instanceof lH;)e=e.input;for(;!oZ(t);)o0(t.output)&&(t=t.output);oQ(e)?t.disconnect(e,n):oZ(e)?t.disconnect(e,n,i):t.disconnect()}(this,t,e,n),this}chain(...t){return lY(this,...t),this}fan(...t){return t.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),o0(this.input)&&(this.input instanceof lH?this.input.dispose():oZ(this.input)&&this.input.disconnect()),o0(this.output)&&(this.output instanceof lH?this.output.dispose():oZ(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function lY(...t){let e=t.shift();t.reduce((t,e)=>(t instanceof lH?t.connect(e):oZ(t)&&lZ(t,e),e),e)}function lZ(t,e,n=0,i=0){for(o8(o0(t),"Cannot connect from undefined node"),o8(o0(e),"Cannot connect to undefined node"),(e instanceof lH||oZ(e))&&o8(e.numberOfInputs>0,"Cannot connect to node with no inputs"),o8(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof lH||e instanceof lG;)o0(e.input)&&(e=e.input);for(;t instanceof lH;)o0(t.output)&&(t=t.output);oQ(e)?t.connect(e,n):t.connect(e,n,i)}class lQ extends lH{constructor(){let t=lu(lQ.getDefaults(),arguments,["gain","units"]);super(t),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new lG({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),lS(this,"gain")}static getDefaults(){return Object.assign(lH.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class lK extends lH{constructor(t){super(t),this.onended=lM,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new lQ({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){let e=this.toSeconds(t);return -1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(lH.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:lM})}_startGain(t,e=1){o8(-1===this._startTime,"Source cannot be started more than once");let n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){o8(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.now()),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==lM&&(this.onended(this),this.onended=lM,!this.context.isOffline)){let t=()=>this.dispose();"undefined"!=typeof requestIdleCallback?requestIdleCallback(t):setTimeout(t,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),o8(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=lM,this}}class lJ extends lK{constructor(){let t=lu(lJ.getDefaults(),arguments,["offset"]);super(t),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),lZ(this._source,this._gainNode),this.offset=new lG({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(lK.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){let e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class l0 extends lH{constructor(){let t=lu(l0.getDefaults(),arguments,["value","units"]);super(t),this.name="Signal",this.override=!0,this.output=this._constantSource=new lJ({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(lH.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return l1(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function l1(t,e,n,i){(e instanceof lG||oQ(e)||e instanceof l0&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof l0&&(e.overridden=!0)),lZ(t,e,n,i)}class l2 extends lG{constructor(){let t=lu(l2.getDefaults(),arguments,["value"]);super(t),this.name="TickParam",this._events=new lv(1/0),this._multiplier=1,this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(lG.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);let i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let t=0;t<=s;t++){let s=n*t+e,a=this._exponentialApproach(r.time,r.value,i,n,s);this.linearRampToValueAtTime(this._toType(a),s)}return this}setValueAtTime(t,e){let n=this.toSeconds(e);super.setValueAtTime(t,e);let i=this._events.get(n),r=this._events.previousEvent(i);return i.ticks=Math.max(this._getTicksUntilEvent(r,n),0),this}linearRampToValueAtTime(t,e){let n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);let i=this._events.get(n),r=this._events.previousEvent(i);return i.ticks=Math.max(this._getTicksUntilEvent(r,n),0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);let n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max((e-i.time)*10,1)),s=(e-i.time)/r;for(let t=0;t<=r;t++){let r=s*t+i.time,a=this._exponentialInterpolate(i.time,i.value,e,n,r);this.linearRampToValueAtTime(this._toType(a),r)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(oJ(t.ticks)){let e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}let n=this._fromType(this.getValueAtTime(t.time)),i=this._fromType(this.getValueAtTime(e)),r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){let e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){let n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){let e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){let i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),a=(-i+s)/r;return(a>0?a:(-i-s)/r)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){let n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){let e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class l3 extends l0{constructor(){let t=lu(l3.getDefaults(),arguments,["value"]);super(t),this.name="TickSignal",this.input=this._param=new l2({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(l0.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class l4 extends lU{constructor(){let t=lu(l4.getDefaults(),arguments,["frequency"]);super(t),this.name="TickSource",this._state=new lX,this._tickOffset=new lv,this._ticksAtTime=new lv,this._secondsAtTime=new lv,this.frequency=new l3({context:this.context,units:t.units,value:t.frequency}),lS(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},lU.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){let n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),o0(e)&&this.setTicksAtTime(e,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}stop(t){let e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){let t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}pause(t){let e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e)),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getTicksAtTime(t){let e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i=this._ticksAtTime.get(e),r={state:"paused",time:e};this._state.add(r);let s=i||n,a=i?i.ticks:0,o=null;return this._state.forEachBetween(s.time,e+this.sampleTime,t=>{let e=s.time,n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(a=n.ticks,e=n.time),"started"===s.state&&"started"!==t.state&&(a+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e),t.time!==r.time&&(o={state:t.state,time:t.time,ticks:a})),s=t}),this._state.remove(r),o&&this._ticksAtTime.add(o),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){let e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);let e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=this._secondsAtTime.get(t),r=i||e,s=i?i.seconds:0,a=null;return this._state.forEachBetween(r.time,t+this.sampleTime,t=>{let e=r.time,i=this._tickOffset.get(t.time);i&&i.time>=r.time&&(s=i.seconds,e=i.time),"started"===r.state&&"started"!==t.state&&(s+=t.time-e,t.time!==n.time&&(a={state:t.state,time:t.time,seconds:s})),r=t}),this._state.remove(n),a&&this._secondsAtTime.add(a),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){let n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e});let r=null;if(i&&"started"===i.state){let s=Math.max(i.time,t),a=this.frequency.getTicksAtTime(s),o=a-this.frequency.getTicksAtTime(i.time),l=Math.ceil(o)-o;l=lg(l,1)?0:l;let u=this.frequency.getTimeOfTick(a+l);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(t){r=t;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class l5 extends lU{constructor(){let t=lu(l5.getDefaults(),arguments,["callback","frequency"]);super(t),this.name="Clock",this.callback=lM,this._lastUpdate=0,this._state=new lX("stopped"),this._boundLoop=this._loop.bind(this),this.callback=t.callback,this._tickSource=new l4({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,lS(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(lU.getDefaults(),{callback:lM,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){o9(this.context);let n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){let e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){let e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){let n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){let t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,t=>{switch(t.state){case"started":let e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}}),this._tickSource.forEachTickBetween(t,e,(t,e)=>{this.callback(t,e)}))}getStateAtTime(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}lT.mixin(l5);class l8 extends lH{constructor(){let t=lu(l8.getDefaults(),arguments,["volume"]);super(t),this.name="Volume",this.input=this.output=new lQ({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,lS(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(lH.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class l6 extends lH{constructor(){let t=lu(l6.getDefaults(),arguments);super(t),this.name="Destination",this.input=new l8({context:this.context}),this.output=new lQ({context:this.context}),this.volume=this.input.volume,lY(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(lH.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),lY(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}lx(t=>{t.destination=new l6({context:t})}),lw(t=>{t.destination.dispose()});class l9 extends lH{constructor(){super(...arguments),this.name="Listener",this.positionX=new lG({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new lG({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new lG({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new lG({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new lG({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new lG({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new lG({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new lG({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new lG({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(lH.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}lx(t=>{t.listener=new l9({context:t})}),lw(t=>{t.listener.dispose()});class l7 extends lp{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let t=lu(l7.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;let n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:lM,onload:lM,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return o8(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,n=lM,i=lM){return o4(e)?(this.baseUrl&&"data:audio/"===e.trim().substring(0,11).toLowerCase()&&(this.baseUrl=""),this._buffers.set(t.toString(),new lE(this.baseUrl+e,n,i))):this._buffers.set(t.toString(),new lE(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class ut extends lB{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return lj(super._frequencyToUnits(t))}_ticksToUnits(t){return lj(super._ticksToUnits(t))}_beatsToUnits(t){return lj(super._beatsToUnits(t))}_secondsToUnits(t){return lj(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return lF(this.toMidi())}transpose(t){return new ut(this.context,this.toMidi()+t)}}class ue extends lz{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class un extends lU{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new lv,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){let t=this.context.currentTime;this._events.forEachBefore(t+this.anticipation,e=>{t-e.time<=this.expiration&&e.callback(),this._events.remove(e)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}lx(t=>{t.draw=new un({context:t})}),lw(t=>{t.draw.dispose()});class ui extends lp{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){o8(o0(t.time),"Events must have a time property"),o8(o0(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new ur(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){let e=[];for(let n of(this._root.search(t.time,e),e))if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,t=>this.remove(t)),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=t.getBalance(),i=null;if(n>0)if(null===t.left.right)(e=t.left).right=t.right,i=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,i=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)(e=t.right).left=t.left,i=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,i=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),i&&this._rebalance(i)}t.dispose()}_rotateLeft(t){let e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){let e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){let e=t.getBalance();e>1&&t.left?0>t.left.getBalance()?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){let e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){let e=[];this._root.traverse(t=>e.push(t)),e.forEach(e=>{e.event&&t(e.event)})}return this}forEachAtTime(t,e){if(null!==this._root){let n=[];this._root.search(t,n),n.forEach(t=>{t.event&&e(t.event)})}return this}forEachFrom(t,e){if(null!==this._root){let n=[];this._root.searchAfter(t,n),n.forEach(t=>{t.event&&e(t.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class ur{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){!(t>this.max)&&(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class us extends lp{constructor(t){super(),this.name="TimelineValue",this._timeline=new lv({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){let e=this._timeline.get(t);return e?e.value:this._initialValue}}class ua extends lH{constructor(){super(lu(ua.getDefaults(),arguments,["context"]))}connect(t,e=0,n=0){return l1(this,t,e,n),this}}class uo extends ua{constructor(){let t=lu(uo.getDefaults(),arguments,["mapping","length"]);(super(t),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,o3(t.mapping)||t.mapping instanceof Float32Array)?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(l0.getDefaults(),{length:1024})}setMap(t,e=1024){let n=new Float32Array(e);for(let i=0;i<e;i++){let r=i/(e-1)*2-1;n[i]=t(r,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){o8(["none","2x","4x"].some(e=>e.includes(t)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ul extends ua{constructor(){let t=lu(ul.getDefaults(),arguments,["value"]);super(t),this.name="Pow",this._exponentScaler=this.input=this.output=new uo({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(ua.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class uu{constructor(t,e){this.id=uu._eventId++,this._remainderTime=0;let n=Object.assign(uu.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=Math.floor(n.time),this._remainderTime=n.time-this.time}static getDefaults(){return{callback:lM,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(t){if(this.callback){let e=this.transport.bpm.getDurationOfTicks(1,t);this.callback(t+this._remainderTime*e),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}uu._eventId=0;class uc extends uu{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let n=Object.assign(uc.getDefaults(),e);this.duration=n.duration,this._interval=n.interval,this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},uu.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvent(){return lm(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new ue(this.context,this._nextTick).toSeconds()):-1}_createEvents(t){lm(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ue(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;let e=this.transport.getTicksAtTime(t);ld(e,this.time)&&(this._nextTick=this.floatTime+Math.ceil((e-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class uh extends lU{constructor(){let t=lu(uh.getDefaults(),arguments);super(t),this.name="Transport",this._loop=new us(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new lv,this._repeatedEvents=new ui,this._syncedSignals=[],this._swingAmount=0,this._ppq=t.ppq,this._clock=new l5({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),lS(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(lU.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){let n=Math.sin(e%(2*this._swingTicks)/(2*this._swingTicks)*Math.PI)*this._swingAmount;t+=new ue(this.context,2*this._swingTicks/3).toSeconds()*n}o7=!0,this._timeline.forEachAtTime(e,e=>e.invoke(t)),o7=!1}schedule(t,e){let n=new uu(this,{callback:t,time:new lz(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){let r=new uc(this,{callback:t,duration:new l$(this.context,i).toTicks(),interval:new l$(this.context,e).toTicks(),time:new lz(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){let n=new uu(this,{callback:t,once:!0,time:new lz(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){let e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){let e=this.toTicks(t);return this._timeline.forEachFrom(e,t=>this.clear(t.id)),this._repeatedEvents.forEachFrom(e,t=>this.clear(t.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new ue(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return this.context.resume(),o0(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){o3(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new l$(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new l$(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new ue(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){let t=this.now(),e=this._clock.getTicksAtTime(t);return new ue(this.context,e).toBarsBeatsSixteenths()}set position(t){let e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){let e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(!this.loop)return 0;{let t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){let e=this.now();if("started"===this.state){let n=this._clock.getTicksAtTime(e),i=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e),r=e+i;this.emit("stop",r),this._clock.setTicksAtTime(t,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this.emit("ticks",e),this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return this._clock.getTicksAtTime(t)}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{let e=this.now(),n=this.getTicksAtTime(e),i=t-n%t;return this._clock.nextTickTime(i,e)}}syncSignal(t,e){let n=this.now(),i=this.bpm,r=1/(60/i.getValueAtTime(n)/this.PPQ),s=[];if("time"===t.units){let t=1/64/r,e=new lQ(t),n=new ul(-1),a=new lQ(t);i.chain(e,n,a),i=a,r=1/r,s=[e,n,a]}e||(e=0!==t.getValueAtTime(n)?t.getValueAtTime(n)/r:0);let a=new lQ(e);return i.connect(a),a.connect(t._param),s.push(a),this._syncedSignals.push({initial:t.value,nodes:s,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){let n=this._syncedSignals[e];n.signal===t&&(n.nodes.forEach(t=>t.dispose()),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),!function t(e,n){o3(n)?n.forEach(n=>t(e,n)):Object.defineProperty(e,n,{writable:!0})}(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}lT.mixin(uh),lx(t=>{t.transport=new uh({context:t})}),lw(t=>{t.transport.dispose()});class up extends lH{constructor(t){super(t),this.input=void 0,this._state=new lX("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=lM,this._syncedStop=lM,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new l8({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,lS(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(lH.getDefaults(),{mute:!1,onstop:lM,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=oJ(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){var r;let t=this._state.get(i);t&&(t.offset=this.toSeconds(oJ(r=e)?0:r),t.duration=n?this.toSeconds(n):void 0);let s=this.context.transport.schedule(t=>{this._start(t,e,n)},i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else o9(this.context),this._start(i,e,n);else o8(ld(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=oJ(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||o0(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){let t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(ld(e,0)){let n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){let i,r=e-this.toSeconds(n.time);n.duration&&(i=this.toSeconds(n.duration)-r),this._start(t,this.toSeconds(n.offset)+r,i)}}},this._syncedStop=t=>{let e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=lM,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class ud extends lK{constructor(){let t=lu(ud.getDefaults(),arguments,["url","onload"]);super(t),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,lZ(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new lG({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new lE(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(lK.getDefaults(),{url:new lE,loop:!1,loopEnd:0,loopStart:0,onload:lM,onerror:lM,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){var r,s,a;o8(this.buffer.loaded,"buffer is either not set or not loaded");let o=this.toSeconds(t);this._startGain(o,i),e=this.loop?(r=e,s=this.loopStart,oJ(r)?s:r):oJ(a=e)?0:a;let l=Math.max(this.toSeconds(e),0);if(this.loop){let t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;lf(l,t)&&(l=(l-e)%n+e),lg(l,this.buffer.duration)&&(l=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,lm(l,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(o,l)),o0(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(o+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class uf extends up{constructor(){let t=lu(uf.getDefaults(),arguments,["type"]);super(t),this.name="Noise",this._source=null,this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(up.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(o8(t in ug,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){let t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){let e=ug[this._type];this._source=new ud({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}let um={brown:null,pink:null,white:null},ug={get brown(){if(!um.brown){let t=[];for(let e=0;e<2;e++){let n=new Float32Array(220500);t[e]=n;let i=0;for(let t=0;t<220500;t++){let e=2*Math.random()-1;n[t]=(i+.02*e)/1.02,i=n[t],n[t]*=3.5}}um.brown=new lE().fromArray(t)}return um.brown},get pink(){if(!um.pink){let t=[];for(let e=0;e<2;e++){let n,i,r,s,a,o,l,u=new Float32Array(220500);t[e]=u,n=i=r=s=a=o=l=0;for(let t=0;t<220500;t++){let e=2*Math.random()-1;n=.99886*n+.0555179*e,i=.99332*i+.0750759*e,r=.969*r+.153852*e,s=.8665*s+.3104856*e,a=.55*a+.5329522*e,o=-.7616*o-.016898*e,u[t]=n+i+r+s+a+o+l+.5362*e,u[t]*=.11,l=.115926*e}}um.pink=new lE().fromArray(t)}return um.pink},get white(){if(!um.white){let t=[];for(let e=0;e<2;e++){let n=new Float32Array(220500);t[e]=n;for(let t=0;t<220500;t++)n[t]=2*Math.random()-1}um.white=new lE().fromArray(t)}return um.white}};function u_(t,e){return la(this,void 0,void 0,function*(){let n=e/t.context.sampleRate,i=new lO(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)})}class uv extends lK{constructor(){let t=lu(uv.getDefaults(),arguments,["frequency","type"]);super(t),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],lZ(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new lG({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new lG({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),lS(this,["frequency","detune"])}static getDefaults(){return Object.assign(lK.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){let e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class uy extends up{constructor(){let t=lu(uy.getDefaults(),arguments,["frequency","type"]);super(t),this.name="Oscillator",this._oscillator=null,this.frequency=new l0({context:this.context,units:"frequency",value:t.frequency}),lS(this,"frequency"),this.detune=new l0({context:this.context,units:"cents",value:t.detune}),lS(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(up.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){let e=this.toSeconds(t),n=new uv({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){let e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){let e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return uy._periodicWaveCache.find(t=>{var e,n;return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every((t,e)=>n[e]===t))});{let t=uy._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;let e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{let e=this._getCachedPeriodicWave();if(o0(e)){let{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),uy._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),uy._periodicWaveCache.length>100&&uy._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){o6(t,0);let e=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)0===t?this.type=e:this.type=e+t.toString();else{let e=new Float32Array(t);this._partials.forEach((t,n)=>e[n]=t),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048,i=new Float32Array(2048),r=new Float32Array(n),s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r]}else{let e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],n=s=Math.max(s,2)):this._partialCount=0,this._partials=[]}for(let a=1;a<n;++a){let n,o=2/(a*Math.PI);switch(t){case"sine":n=+(a<=s),this._partials[a-1]=n;break;case"square":n=1&a?2*o:0,this._partials[a-1]=n;break;case"sawtooth":n=o*(1&a?1:-1),this._partials[a-1]=n;break;case"triangle":n=1&a?o*o*2*(a-1>>1&1?-1:1):0,this._partials[a-1]=n;break;case"custom":n=this._partials[a-1];break;default:throw TypeError("Oscillator: invalid type: "+t)}0!==n?(i[a]=-n*Math.sin(e*a),r[a]=n*Math.cos(e*a)):(i[a]=0,r[a]=0)}return[i,r]}_inverseFFT(t,e,n){let i=0,r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i}getInitialValue(){let[t,e]=this._getRealImaginary(this._type,0),n=0,i=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(t,e,r/32*i),n);return l_(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}uy._periodicWaveCache=[];class ux extends ua{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new uo({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ub extends l0{constructor(){let t=lu(ub.getDefaults(),arguments,["value"]);super(t),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new lQ({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(l0.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class uw extends up{constructor(){let t=lu(uw.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="AMOscillator",this._modulationScale=new ux({context:this.context}),this._modulationNode=new lQ({context:this.context}),this._carrier=new uy({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new uy({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ub({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),lS(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(uy.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class uT extends up{constructor(){let t=lu(uT.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="FMOscillator",this._modulationNode=new lQ({context:this.context,gain:0}),this._carrier=new uy({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new l0({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new uy({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ub({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new ub({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),lS(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(uy.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class uA extends up{constructor(){let t=lu(uA.getDefaults(),arguments,["frequency","width"]);super(t),this.name="PulseOscillator",this._widthGate=new lQ({context:this.context,gain:0}),this._thresh=new uo({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new l0({context:this.context,units:"audioRange",value:t.width}),this._triangle=new uy({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),lS(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(up.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class uC extends up{constructor(){let t=lu(uC.getDefaults(),arguments,["frequency","type","spread"]);super(t),this.name="FatOscillator",this._oscillators=[],this.frequency=new l0({context:this.context,units:"frequency",value:t.frequency}),this.detune=new l0({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,lS(this,["frequency","detune"])}static getDefaults(){return Object.assign(uy.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){let e=-t/2,n=t/(this._oscillators.length-1);this._forEach((t,i)=>t.detune.value=e+n*i)}}get count(){return this._oscillators.length}set count(t){if(o6(t,1),this._oscillators.length!==t){this._forEach(t=>t.dispose()),this._oscillators=[];for(let e=0;e<t;e++){let n=new uy({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):lM});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((t,e)=>t.phase=this._phase+e/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class uk extends up{constructor(){let t=lu(uk.getDefaults(),arguments,["frequency","modulationFrequency"]);super(t),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new ub({context:this.context,value:2}),this._pulse=new uA({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new uy({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),lS(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(up.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}let uS={am:uw,fat:uC,fm:uT,oscillator:uy,pulse:uA,pwm:uk};class uM extends up{constructor(){let t=lu(uM.getDefaults(),arguments,["frequency","type"]);super(t),this.name="OmniOscillator",this.frequency=new l0({context:this.context,units:"frequency",value:t.frequency}),this.detune=new l0({context:this.context,units:"cents",value:t.detune}),lS(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(uy.getDefaults(),uT.getDefaults(),uw.getDefaults(),uC.getDefaults(),uA.getDefaults(),uk.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;let e=uS[t],n=this.now();if(this._oscillator){let t=this._oscillator;t.stop(n),this.context.setTimeout(()=>t.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof uS[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&o1(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&o1(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&o4(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(){return la(this,arguments,void 0,function*(t=1024){return u_(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function uE(t,e=1/0){let n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){o6(i,t,e),n.set(this,i)}})}}function uO(t,e=1/0){let n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){o6(this.toSeconds(i),t,e),n.set(this,i)}})}}class uR extends up{constructor(){let t=lu(uR.getDefaults(),arguments,["url","onload"]);super(t),this.name="Player",this._activeSources=new Set,this._buffer=new lE({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(up.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:lM,onerror:lM,playbackRate:1,reverse:!1})}load(t){return la(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=lM){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){var i,r,s,a,o;e=this._loop?(i=e,r=this._loopStart,oJ(i)?r:i):oJ(s=e)?0:s;let l=this.toSeconds(e),u=n;a=n,o=Math.max(this._buffer.duration-l,0),n=oJ(a)?o:a;let c=this.toSeconds(n);c/=this._playbackRate,t=this.toSeconds(t);let h=new ud({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+c),this._state.setStateAtTime("stopped",t+c,{implicitEnd:!0})),this._activeSources.add(h),this._loop&&oJ(u)?h.start(t,l):h.start(t,l,c-this.toSeconds(this.fadeOut))}_stop(t){let e=this.toSeconds(t);this._activeSources.forEach(t=>t.stop(e))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){var i;null==(i=[...this._activeSources].pop())||i.stop(t),this._start(t,e,n)}seek(t,e){let n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){let e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&o6(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&o6(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){let t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;let e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(t=>t.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}ls([uO(0)],uR.prototype,"fadeIn",void 0),ls([uO(0)],uR.prototype,"fadeOut",void 0);class uN extends ua{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new uo({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class uP extends lH{constructor(){let t=lu(uP.getDefaults(),arguments,["attack","decay","sustain","release"]);super(t),this.name="Envelope",this._sig=new l0({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(lH.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(o4(t))return t;{let n;for(n in uD)if(uD[n][e]===t)return n;return t}}_setCurve(t,e,n){if(o4(n)&&Reflect.has(uD,n)){let i=uD[n];o2(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else if(o3(n)&&"_decayCurve"!==t)this[t]=n;else throw Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(t){this._setCurve("_decayCurve","Out",t)}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack),i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0&&(n=(1-r)/(1/n)),n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){(i=this._attackCurve.slice(t))[0]=r;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){let r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);let e=this.getValueAtTime(t);if(e>0){let n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(o8(o3(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return l1(this,t,e,n),this}asArray(){return la(this,arguments,void 0,function*(t=1024){let e=t/this.context.sampleRate,n=new lO(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,a=r+s,o=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/a,decay:e*this.toSeconds(this.decay)/a,release:e*this.toSeconds(this.release)/a,context:n}));return o._sig.toDestination(),o.triggerAttackRelease(e*(i+s)/a,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}ls([uO(0)],uP.prototype,"attack",void 0),ls([uO(0)],uP.prototype,"decay",void 0),ls([uE(0,1)],uP.prototype,"sustain",void 0),ls([uO(0)],uP.prototype,"release",void 0);let uD=(()=>{let t,e,n=[];for(t=0;t<128;t++)n[t]=Math.sin(t/127*(Math.PI/2));let i=[];for(t=0;t<127;t++){let n=Math.sin(2*Math.PI*(e=t/127)*6.4-Math.PI/2)+1;i[t]=n/10+.83*e}i[127]=1;let r=[];for(t=0;t<128;t++)r[t]=Math.ceil(t/127*5)/5;let s=[];for(t=0;t<128;t++)e=t/127,s[t]=.5*(1-Math.cos(Math.PI*e));let a=[];for(t=0;t<128;t++){let n=Math.cos((4*Math.pow(e=t/127,3)+.2)*Math.PI*2*e);a[t]=Math.abs(n*(1-e))}function o(t){let e=Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:o(a),Out:a},cosine:{In:n,Out:n.slice(0).reverse()},exponential:"exponential",linear:"linear",ripple:{In:i,Out:o(i)},sine:{In:s,Out:o(s)},step:{In:r,Out:o(r)}}})();class uI extends lH{constructor(){let t=lu(uI.getDefaults(),arguments);super(t),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new l8({context:this.context,volume:t.volume}),this.volume=this._volume.volume,lS(this,"volume")}static getDefaults(){return Object.assign(lH.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){let n=this["_original_"+t]=this[t];this[t]=(...t)=>{let i=t[e],r=this.context.transport.schedule(i=>{t[e]=i,n.apply(this,t)},i);this._scheduledEvents.push(r)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(t,e,n,i){let r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class uj extends uI{constructor(){let t=lu(uj.getDefaults(),arguments);super(t),this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(uI.getDefaults(),{detune:0,onsilence:lM,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);let i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);let e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){let n=this.toSeconds(e),i=t instanceof lB?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){let t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}ls([uO(0)],uj.prototype,"portamento",void 0);class uV extends uP{constructor(){super(lu(uV.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new lQ({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class uF extends uj{constructor(){let t=lu(uF.getDefaults(),arguments);super(t),this.name="Synth",this.oscillator=new uM(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new uV(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),lS(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(uj.getDefaults(),{envelope:Object.assign(lh(uP.getDefaults(),Object.keys(lH.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(lh(uM.getDefaults(),[...Object.keys(up.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){let e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class uq extends uF{constructor(){let t=lu(uq.getDefaults(),arguments);super(t),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,lS(this,["oscillator","envelope"])}static getDefaults(){return ll(uj.getDefaults(),uF.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){let n=this.toSeconds(e),i=this.toFrequency(t instanceof lB?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}ls([uE(0)],uq.prototype,"octaves",void 0),ls([uO(0)],uq.prototype,"pitchDecay",void 0);let u$=new Set;function uB(t,e){let n=`registerProcessor("${t}", ${e})`;u$.add(n)}v=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`,u$.add(v),y=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`,u$.add(y),x=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`,u$.add(x),uB("feedback-comb-filter",`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`);class uL extends uI{constructor(){let t=lu(uL.getDefaults(),arguments,["voice","options"]);super(t),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=t=>this.releaseAll(t),o8(!o1(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");let e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();let n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(uI.getDefaults(),{maxPolyphony:32,options:{},voice:uF})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);let e=this._activeVoices.findIndex(e=>e.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){let t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return o8(t instanceof uj,"Voice must extend Monophonic class"),t.connect(this.output),this._voices.push(t),t}ln("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){let t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach(t=>{let i=new ut(this.context,t).toMidi(),r=this._getNextAvailableVoice();r&&(r.triggerAttack(t,e,n),this._activeVoices.push({midi:i,voice:r,released:!1}),this.log("triggerAttack",t,e))})}_triggerRelease(t,e){t.forEach(t=>{let n=new ut(this.context,t).toMidi(),i=this._activeVoices.find(({midi:t,released:e})=>t===n&&!e);i&&(i.voice.triggerRelease(e),i.released=!0,this.log("triggerRelease",t,e))})}_scheduleEvent(t,e,n,i){o8(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(t,e,n,i)},n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);let i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);let n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,i){let r=this.toSeconds(n);if(this.triggerAttack(t,r,i),o3(e)){o8(o3(t),"If the duration is an array, the notes must also be an array");for(let n=0;n<t.length;n++){let i=e[Math.min(n,e.length-1)],s=this.toSeconds(i);o8(s>0,"The duration must be greater than 0"),this.triggerRelease(t[n],r+s)}}else{let n=this.toSeconds(e);o8(n>0,"The duration must be greater than 0"),this.triggerRelease(t,r+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(t){let e=lh(t,["onsilence","context"]);return this.options=ll(this.options,e),this._voices.forEach(t=>t.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){let e=this.toSeconds(t);return this._activeVoices.forEach(({voice:t})=>{t.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class uW extends uI{constructor(){let t=lu(uW.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(t),this.name="Sampler",this._activeSources=new Map;let e={};Object.keys(t.urls).forEach(n=>{let i=parseInt(n,10);o8(o5(n)||o1(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),o5(n)?e[new lB(this.context,n).toMidi()]=t.urls[n]:o1(i)&&isFinite(i)&&(e[i]=t.urls[i])}),this._buffers=new l7({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(uI.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:lM,onerror:lM,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(t=>{let i=lV(new lB(this.context,t).toFrequency()),r=Math.round(i),s=i-r,a=this._findClosest(r),o=r-a,l=this._buffers.get(o),u=lD(a+s),c=new ud({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);c.start(e,0,l.duration/u,n),o3(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(c),c.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){let t=this._activeSources.get(r),e=t.indexOf(c);-1!==e&&t.splice(e,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(t=>{let n=new lB(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){let t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach(t=>{t.stop(e)}),this._activeSources.set(n,[])}}),this}releaseAll(t){let e=this.toSeconds(t);return this._activeSources.forEach(t=>{for(;t.length;)t.shift().stop(e)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){let r=this.toSeconds(n);return this.triggerAttack(t,r,i),o3(e)?(o8(o3(t),"notes must be an array when duration is array"),t.forEach((t,n)=>{let i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i))})):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(o8(o5(t)||isFinite(t),`note must be a pitch or midi: ${t}`),o5(t)){let i=new lB(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}ls([uO(0)],uW.prototype,"attack",void 0),ls([uO(0)],uW.prototype,"release",void 0);class uz extends lH{constructor(){let t=lu(uz.getDefaults(),arguments,["fade"]);super(t),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new uN({context:this.context}),this.a=new lQ({context:this.context,gain:0}),this.b=new lQ({context:this.context,gain:0}),this.output=new lQ({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new l0({context:this.context,units:"normalRange",value:t.fade}),lS(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",lZ(this._split,this.a.gain,0),lZ(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(lH.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class uU extends lH{constructor(t){super(t),this.name="Effect",this._dryWet=new uz({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new lQ({context:this.context}),this.effectReturn=new lQ({context:this.context}),this.input=new lQ({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],lS(this,"wet")}static getDefaults(){return Object.assign(lH.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class uX extends lH{constructor(){let t=lu(uX.getDefaults(),arguments,["pan"]);super(t),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new lG({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",lS(this,"pan")}static getDefaults(){return Object.assign(lH.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}uB("bit-crusher",`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`);class uG extends lH{constructor(){let t=lu(uG.getDefaults(),arguments,["channels"]);super(t),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(lH.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class uH extends uU{constructor(){let t=lu(uH.getDefaults(),arguments,["decay"]);super(t),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let e=this.toSeconds(t.decay);o6(e,.001),this._decay=e;let n=this.toSeconds(t.preDelay);o6(n,0),this._preDelay=n,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(uU.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){o6(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){o6(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return la(this,void 0,void 0,function*(){let t=this.ready,e=new lO(2,this._decay+this._preDelay,this.context.sampleRate),n=new uf({context:e}),i=new uf({context:e}),r=new uG({context:e});n.connect(r,0,0),i.connect(r,0,1);let s=new lQ({context:e}).toDestination();r.connect(s),n.start(0),i.start(0),s.gain.setValueAtTime(0,0),s.gain.setValueAtTime(1,this._preDelay),s.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let a=e.render();return this.ready=a.then(lM),yield t,this._convolver.buffer=(yield a).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class uY extends lH{constructor(){let t=lu(uY.getDefaults(),arguments,["solo"]);super(t),this.name="Solo",this.input=this.output=new lQ({context:this.context}),uY._allSolos.has(this.context)||uY._allSolos.set(this.context,new Set),uY._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(lH.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),uY._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){uY._soloed.has(this.context)||uY._soloed.set(this.context,new Set),uY._soloed.get(this.context).add(this)}_removeSolo(){uY._soloed.has(this.context)&&uY._soloed.get(this.context).delete(this)}_isSoloed(){return uY._soloed.has(this.context)&&uY._soloed.get(this.context).has(this)}_noSolos(){return!uY._soloed.has(this.context)||uY._soloed.has(this.context)&&0===uY._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),uY._allSolos.get(this.context).delete(this),this._removeSolo(),this}}uY._allSolos=new Map,uY._soloed=new Map;class uZ extends lH{constructor(){let t=lu(uZ.getDefaults(),arguments,["pan","volume"]);super(t),this.name="PanVol",this._panner=this.input=new uX({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new l8({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,lS(this,["pan","volume"])}static getDefaults(){return Object.assign(lH.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class uQ extends lH{constructor(){let t=lu(uQ.getDefaults(),arguments,["volume","pan"]);super(t),this.name="Channel",this._solo=this.input=new uY({solo:t.solo,context:this.context}),this._panVol=this.output=new uZ({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),lS(this,["pan","volume"])}static getDefaults(){return Object.assign(lH.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return uQ.buses.has(t)||uQ.buses.set(t,new lQ({context:this.context})),uQ.buses.get(t)}send(t,e=0){let n=this._getBus(t),i=new lQ({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}uQ.buses=new Map,lP().transport,lP().destination,lP().destination,lP().listener,lP().draw,lP();let uK=({cultureId:t="usa-general",width:e=400,height:n=300})=>{let i=(0,E.useRef)(null),[r,s]=(0,E.useState)(null),[a,o]=(0,E.useState)(!0),[l,u]=(0,E.useState)(null),[c,h]=(0,E.useState)(!1),p=(0,E.useRef)(null),d=process.env.NEXT_PUBLIC_BASE_PATH??"";(0,E.useEffect)(()=>((async()=>{try{p.current=new uL(uF,{oscillator:{type:"sine"},envelope:{attack:.02,decay:.2,sustain:.3,release:1}}).toDestination();let t=new uH({decay:1.5,wet:.3}).toDestination();p.current.connect(t),h(!0)}catch(t){console.warn("Audio initialization failed:",t)}})(),()=>{p.current&&p.current.dispose()}),[]);let f=t=>{let e=t.replace(/maj|major/i,"").replace(/min|minor/i,"m").trim(),n={C:["C4","E4","G4"],D:["D4","F#4","A4"],E:["E4","G#4","B4"],F:["F4","A4","C5"],G:["G4","B4","D5"],A:["A4","C#5","E5"],B:["B4","D#5","F#5"],Am:["A4","C5","E5"],Bm:["B4","D5","F#5"],Cm:["C4","Eb4","G4"],Dm:["D4","F4","A4"],Em:["E4","G4","B4"],Fm:["F4","Ab4","C5"],Gm:["G4","Bb4","D5"],Am7:["A4","C5","E5","G5"],Em7:["E4","G4","B4","D5"],Cmaj7:["C4","E4","G4","B4"],Dmaj7:["D4","F#4","A4","C#5"],Fmaj7:["F4","A4","C5","E5"],Gmaj7:["G4","B4","D5","F#5"],C7:["C4","E4","G4","Bb4"],D7:["D4","F#4","A4","C5"],E7:["E4","G#4","B4","D5"],F7:["F4","A4","C5","Eb5"],G7:["G4","B4","D5","F5"],A7:["A4","C#5","E5","G5"],B7:["B4","D#5","F#5","A5"]};if(n[e])return n[e];let i=e.charAt(0).toUpperCase();return e.toLowerCase().includes("m")&&!e.toLowerCase().includes("maj")?n[i+"m"]||n[i]||["C4","E4","G4"]:n[i]||["C4","E4","G4"]},m=async t=>{if(!c||!p.current)try{await lN.resume(),h(!0)}catch(t){console.warn("Could not start audio:",t);return}if(p.current){let e=f(t);p.current.triggerAttackRelease(e,"1n")}},g=async t=>{o(!0),u(null);try{let e=await fetch(`${d}/data/${t}.json`);if(e.ok){let t=await e.json();s(t)}else console.error(`Failed to load data for culture: ${t}, status: ${e.status}`),u(`Failed to load data for ${t}. Status: ${e.status}`),s({nodes:[{id:"N/A",pagerank:.1}],links:[]})}catch(e){console.error("Error fetching or parsing data:",e),u(`Error loading data for ${t}.`),s({nodes:[{id:"Error",pagerank:.1}],links:[]})}finally{o(!1)}};return((0,E.useEffect)(()=>{g(t)},[t]),(0,E.useEffect)(()=>{if(!r||a)return;let t=nT(i.current);t.selectAll("*").remove();let s=iu().domain(O(r.nodes,t=>t.pagerank)||[0,1]).range([8,25]),o=iu().domain(O(r.links,t=>t.prob)||[0,1]).range([1,4]),l=r.nodes.map(t=>({...t})),u=r.links.map(t=>({source:t.source,target:t.target,prob:t.prob})),c=(function(t){let e;var n,i=1,r=.001,s=1-Math.pow(.001,1/300),a=0,o=.6,l=new Map,u=et(p),c=tH("tick","end"),h=(e=1,()=>(e=(1664525*e+0x3c6ef35f)%0x100000000)/0x100000000);function p(){d(),c.call("tick",n),i<r&&(u.stop(),c.call("end",n))}function d(e){var r,u,c=t.length;void 0===e&&(e=1);for(var h=0;h<e;++h)for(i+=(a-i)*s,l.forEach(function(t){t(i)}),r=0;r<c;++r)null==(u=t[r]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return n}function f(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+n),s=n*nK;e.x=r*Math.cos(s),e.y=r*Math.sin(s)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function m(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),n={tick:d,restart:function(){return u.restart(p),n},stop:function(){return u.stop(),n},nodes:function(e){return arguments.length?(t=e,f(),l.forEach(m),n):t},alpha:function(t){return arguments.length?(i=+t,n):i},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(s=+t,n):+s},alphaTarget:function(t){return arguments.length?(a=+t,n):a},velocityDecay:function(t){return arguments.length?(o=1-t,n):1-o},randomSource:function(t){return arguments.length?(h=t,l.forEach(m),n):h},force:function(t,e){return arguments.length>1?(null==e?l.delete(t):l.set(t,m(e)),n):l.get(t)},find:function(e,n,i){var r,s,a,o,l,u=0,c=t.length;for(null==i?i=1/0:i*=i,u=0;u<c;++u)(a=(r=e-(o=t[u]).x)*r+(s=n-o.y)*s)<i&&(l=o,i=a);return l},on:function(t,e){return arguments.length>1?(c.on(t,e),n):c.on(t)}}})(l).force("link",(function(t){var e,n,i,r,s,a,o=nH,l=function(t){return 1/Math.min(r[t.source.index],r[t.target.index])},u=nz(30),c=1;function h(i){for(var r=0,o=t.length;r<c;++r)for(var l,u,h,p,d,f,m,g=0;g<o;++g)u=(l=t[g]).source,f=((f=Math.sqrt((p=(h=l.target).x+h.vx-u.x-u.vx||nU(a))*p+(d=h.y+h.vy-u.y-u.vy||nU(a))*d))-n[g])/f*i*e[g],p*=f,d*=f,h.vx-=p*(m=s[g]),h.vy-=d*m,u.vx+=p*(m=1-m),u.vy+=d*m}function p(){if(i){var a,l,u=i.length,c=t.length,h=new Map(i.map((t,e)=>[o(t,e,i),t]));for(a=0,r=Array(u);a<c;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=nY(h,l.source)),"object"!=typeof l.target&&(l.target=nY(h,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(a=0,s=Array(c);a<c;++a)l=t[a],s[a]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);e=Array(c),d(),n=Array(c),f()}}function d(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+l(t[n],n,t)}function f(){if(i)for(var e=0,r=t.length;e<r;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){i=t,a=e,p()},h.links=function(e){return arguments.length?(t=e,p(),h):t},h.id=function(t){return arguments.length?(o=t,h):o},h.iterations=function(t){return arguments.length?(c=+t,h):c},h.strength=function(t){return arguments.length?(l="function"==typeof t?t:nz(+t),d(),h):l},h.distance=function(t){return arguments.length?(u="function"==typeof t?t:nz(+t),f(),h):u},h})(u).id(t=>t.id).strength(.1).distance(80)).force("charge",(function(){var t,e,n,i,r,s=nz(-30),a=1,o=1/0,l=.81;function u(n){var r,s=t.length,a=n$(t,nZ,nQ).visitAfter(h);for(i=n,r=0;r<s;++r)e=t[r],a.visit(p)}function c(){if(t){var e,n,i=t.length;for(e=0,r=Array(i);e<i;++e)r[(n=t[e]).index]=+s(n,e,t)}}function h(t){var e,n,i,s,a,o=0,l=0;if(t.length){for(i=s=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(o+=e.value,l+=n,i+=n*e.x,s+=n*e.y);t.x=i/l,t.y=s/l}else{(e=t).x=e.data.x,e.y=e.data.y;do o+=r[e.data.index];while(e=e.next)}t.value=o}function p(t,s,u,c){if(!t.value)return!0;var h=t.x-e.x,p=t.y-e.y,d=c-s,f=h*h+p*p;if(d*d/l<f)return f<o&&(0===h&&(f+=(h=nU(n))*h),0===p&&(f+=(p=nU(n))*p),f<a&&(f=Math.sqrt(a*f)),e.vx+=h*t.value*i/f,e.vy+=p*t.value*i/f),!0;if(!t.length&&!(f>=o)){(t.data!==e||t.next)&&(0===h&&(f+=(h=nU(n))*h),0===p&&(f+=(p=nU(n))*p),f<a&&(f=Math.sqrt(a*f)));do t.data!==e&&(d=r[t.data.index]*i/f,e.vx+=h*d,e.vy+=p*d);while(t=t.next)}}return u.initialize=function(e,i){t=e,n=i,c()},u.strength=function(t){return arguments.length?(s="function"==typeof t?t:nz(+t),c(),u):s},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u})().strength(-350)).force("center",function(t,e){var n,i=1;function r(){var r,s,a=n.length,o=0,l=0;for(r=0;r<a;++r)o+=(s=n[r]).x,l+=s.y;for(o=(o/a-t)*i,l=(l/a-e)*i,r=0;r<a;++r)s=n[r],s.x-=o,s.y-=l}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r.strength=function(t){return arguments.length?(i=+t,r):i},r}(e/2,n/2)).force("collision",(function(t){var e,n,i,r=1,s=1;function a(){for(var t,a,l,u,c,h,p,d=e.length,f=0;f<s;++f)for(t=0,a=n$(e,nX,nG).visitAfter(o);t<d;++t)p=(h=n[(l=e[t]).index])*h,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(t,e,n,s,a){var o=t.data,d=t.r,f=h+d;if(o){if(o.index>l.index){var m=u-o.x-o.vx,g=c-o.y-o.vy,v=m*m+g*g;v<f*f&&(0===m&&(v+=(m=nU(i))*m),0===g&&(v+=(g=nU(i))*g),v=(f-(v=Math.sqrt(v)))/v*r,l.vx+=(m*=v)*(f=(d*=d)/(p+d)),l.vy+=(g*=v)*f,o.vx-=m*(f=1-f),o.vy-=g*f)}return}return e>u+f||s<u-f||n>c+f||a<c-f}}function o(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var i,r,s=e.length;for(i=0,n=Array(s);i<s;++i)n[(r=e[i]).index]=+t(r,i,e)}}return"function"!=typeof t&&(t=nz(null==t?1:+t)),a.initialize=function(t,n){e=t,i=n,l()},a.iterations=function(t){return arguments.length?(s=+t,a):s},a.strength=function(t){return arguments.length?(r=+t,a):r},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:nz(+e),l(),a):t},a})().radius(t=>s(t.pagerank)+6)),h=nT("body").append("div").attr("class","chord-tooltip").style("position","absolute").style("visibility","hidden").style("background","rgba(0, 0, 0, 0.9)").style("color","white").style("padding","10px").style("border-radius","6px").style("font-size","12px").style("pointer-events","none").style("z-index","1000").style("box-shadow","0 4px 12px rgba(0,0,0,0.3)");t.append("defs").selectAll("marker").data(["arrow"]).enter().append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#888");let p=t.append("g").attr("class","links").selectAll("line").data(u).enter().append("line").attr("stroke","#888").attr("stroke-opacity",.6).attr("stroke-width",t=>o(t.prob)).attr("marker-end","url(#arrow)"),d=t.append("g").attr("class","nodes").selectAll("circle").data(l).enter().append("circle").attr("r",t=>s(t.pagerank)).attr("fill","#4A90E2").attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer").call(nI().on("start",(t,e)=>{t.active||c.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}).on("drag",(t,e)=>{e.fx=t.x,e.fy=t.y}).on("end",(t,e)=>{t.active||c.alphaTarget(0),e.fx=null,e.fy=null})),f=t.append("g").attr("class","labels").selectAll("text").data(l).enter().append("text").text(t=>t.id).attr("font-size",11).attr("font-family","Arial, sans-serif").attr("font-weight","bold").attr("text-anchor","middle").attr("dy",".35em").attr("fill","#333").style("pointer-events","none");return d.on("click",async(t,e)=>{t.stopPropagation(),await m(e.id),nT(t.currentTarget).transition().duration(100).attr("r",1.4*s(e.pagerank)).attr("fill","#FF6B6B").transition().duration(300).attr("r",s(e.pagerank)).attr("fill","#4A90E2")}).on("mouseover",(t,e)=>{let n=u.filter(t=>("object"==typeof t.source?t.source.id:t.source)===e.id),i=`<strong>${e.id}</strong><br/>`;i+=`Importance: ${(100*e.pagerank).toFixed(1)}%<br/>`,n.length>0&&(i+="<br/><strong>Common progressions:</strong><br/>",n.forEach(t=>{let e=t.target,n=t.source;i+=`${n.id} → ${e.id}: ${(100*t.prob).toFixed(0)}%<br/>`})),i+="<br/><em>Click to play chord!</em>",h.style("visibility","visible").html(i),d.style("opacity",t=>t===e||n.some(e=>e.target.id===t.id)?1:.3),p.style("opacity",t=>t.source.id===e.id?1:.1),f.style("opacity",t=>t===e||n.some(e=>e.target.id===t.id)?1:.3)}).on("mousemove",t=>{h.style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")}).on("mouseout",()=>{h.style("visibility","hidden"),d.style("opacity",1),p.style("opacity",.6),f.style("opacity",1)}),c.on("tick",()=>{p.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),d.attr("cx",t=>t.x).attr("cy",t=>t.y),f.attr("x",t=>t.x).attr("y",t=>t.y)}),()=>{c.stop(),h.remove()}},[r,e,n,a]),a)?(0,k.jsx)("div",{style:{width:e,height:n,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:(0,k.jsxs)("div",{style:{textAlign:"center",color:"#6c757d"},children:[(0,k.jsx)("div",{style:{marginBottom:"8px"},children:"\uD83C\uDFB5"}),(0,k.jsx)("div",{children:"Loading chords..."})]})}):l?(0,k.jsx)("div",{style:{width:e,height:n,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8d7da",borderRadius:"8px",border:"1px solid #f5c6cb"},children:(0,k.jsxs)("div",{style:{color:"#721c24",textAlign:"center",fontSize:"14px"},children:[(0,k.jsx)("div",{children:"⚠️ Could not load chord data"}),(0,k.jsx)("div",{style:{fontSize:"12px",marginTop:"4px"},children:"Using fallback data"})]})}):(0,k.jsxs)("div",{style:{width:e,height:n,position:"relative"},children:[(0,k.jsx)("svg",{ref:i,width:e,height:n,style:{background:"#fafafa",borderRadius:"8px",border:"1px solid #e9ecef"}}),(0,k.jsx)("div",{style:{position:"absolute",top:8,right:8,background:"rgba(74, 144, 226, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:"\uD83C\uDFB9 Click chords to play"})]})},uJ=({onMoodChange:t})=>{let e=(0,E.useRef)(null),n={mainAxisStrokeColor:"#B0B0B0",diagonalStrokeColor:"#EAEAEA",circleStrokeColor:"#4A90E2",textColor:"#333",sectorColors:["#FFD1DC","#E1F5FE","#FFE4B5","#D8BFD8","#FFB6C1","#ADD8E6","#F5F5DC","#E6E6FA"],sectorLabels:["Energetic/Joyful","Excited/Surprised","Agitated/Angry","Heavy/Majestic","Dark/Depressed","Tragic/Yearning","Dreamy/Sentimental","Calm/Relaxed"]},i=(function(t,e,n){t*=1,e*=1,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),s=Array(r);++i<r;)s[i]=t+i*n;return s})(8).map(t=>({index:t,startAngle:Math.PI/4*t,endAngle:Math.PI/4*(t+1),label:n.sectorLabels[t],color:n.sectorColors[t]})),r=(0,E.useRef)(Math.PI/8),s=(0,E.useRef)(0);return(0,E.useEffect)(()=>{if(!e.current)return;let a=nT(e.current);a.selectAll("*").remove();let o=a.append("g").attr("class","wheel-container"),l=(function(){var t=iO,e=iR,n=ih(0),i=null,r=iN,s=iP,a=iD,o=null,l=iE(u);function u(){var u,c,h=+t.apply(this,arguments),p=+e.apply(this,arguments),d=r.apply(this,arguments)-ib,f=s.apply(this,arguments)-ib,m=ip(f-d),g=f>d;if(o||(o=u=l()),p<h&&(c=p,p=h,h=c),p>1e-12)if(m>iw-1e-12)o.moveTo(p*im(d),p*iv(d)),o.arc(0,0,p,d,f,!g),h>1e-12&&(o.moveTo(h*im(f),h*iv(f)),o.arc(0,0,h,f,d,g));else{var v,y,x=d,b=f,w=d,T=f,A=m,C=m,k=a.apply(this,arguments)/2,S=k>1e-12&&(i?+i.apply(this,arguments):iy(h*h+p*p)),M=i_(ip(p-h)/2,+n.apply(this,arguments)),E=M,O=M;if(S>1e-12){var R=iT(S/h*iv(k)),N=iT(S/p*iv(k));(A-=2*R)>1e-12?(R*=g?1:-1,w+=R,T-=R):(A=0,w=T=(d+f)/2),(C-=2*N)>1e-12?(N*=g?1:-1,x+=N,b-=N):(C=0,x=b=(d+f)/2)}var P=p*im(x),D=p*iv(x),I=h*im(T),j=h*iv(T);if(M>1e-12){var V,F=p*im(b),q=p*iv(b),$=h*im(w),B=h*iv(w);if(m<ix)if(V=function(t,e,n,i,r,s,a,o){var l=n-t,u=i-e,c=a-r,h=o-s,p=h*l-c*u;if(!(p*p<1e-12))return p=(c*(e-s)-h*(t-r))/p,[t+p*l,e+p*u]}(P,D,$,B,F,q,I,j)){var L,W=P-V[0],z=D-V[1],U=F-V[0],X=q-V[1],G=1/iv(((L=(W*U+z*X)/(iy(W*W+z*z)*iy(U*U+X*X)))>1?0:L<-1?ix:Math.acos(L))/2),H=iy(V[0]*V[0]+V[1]*V[1]);E=i_(M,(h-H)/(G-1)),O=i_(M,(p-H)/(G+1))}else E=O=0}C>1e-12?O>1e-12?(v=iI($,B,P,D,p,O,g),y=iI(F,q,I,j,p,O,g),o.moveTo(v.cx+v.x01,v.cy+v.y01),O<M?o.arc(v.cx,v.cy,O,id(v.y01,v.x01),id(y.y01,y.x01),!g):(o.arc(v.cx,v.cy,O,id(v.y01,v.x01),id(v.y11,v.x11),!g),o.arc(0,0,p,id(v.cy+v.y11,v.cx+v.x11),id(y.cy+y.y11,y.cx+y.x11),!g),o.arc(y.cx,y.cy,O,id(y.y11,y.x11),id(y.y01,y.x01),!g))):(o.moveTo(P,D),o.arc(0,0,p,x,b,!g)):o.moveTo(P,D),h>1e-12&&A>1e-12?E>1e-12?(v=iI(I,j,F,q,h,-E,g),y=iI(P,D,$,B,h,-E,g),o.lineTo(v.cx+v.x01,v.cy+v.y01),E<M?o.arc(v.cx,v.cy,E,id(v.y01,v.x01),id(y.y01,y.x01),!g):(o.arc(v.cx,v.cy,E,id(v.y01,v.x01),id(v.y11,v.x11),!g),o.arc(0,0,h,id(v.cy+v.y11,v.cx+v.x11),id(y.cy+y.y11,y.cx+y.x11),g),o.arc(y.cx,y.cy,E,id(y.y11,y.x11),id(y.y01,y.x01),!g))):o.arc(0,0,h,T,w,g):o.lineTo(I,j)}else o.moveTo(0,0);if(o.closePath(),u)return o=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-ix/2;return[im(i)*n,iv(i)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ih(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ih(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ih(+t),u):n},u.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:ih(+t),u):i},u.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:ih(+t),u):r},u.endAngle=function(t){return arguments.length?(s="function"==typeof t?t:ih(+t),u):s},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:ih(+t),u):a},u.context=function(t){return arguments.length?(o=null==t?null:t,u):o},u})().innerRadius(0).outerRadius(160).startAngle(t=>t.startAngle).endAngle(t=>t.endAngle),u=o.selectAll(".sector").data(i).enter().append("path").attr("class","sector").attr("d",l).attr("transform","translate(200,200)").attr("fill","transparent").attr("stroke",n.diagonalStrokeColor).attr("stroke-width",.5).attr("opacity",.2);o.append("line").attr("x1",20).attr("y1",200).attr("x2",380).attr("y2",200).attr("stroke",n.mainAxisStrokeColor).attr("stroke-width",1.5),o.append("line").attr("x1",200).attr("y1",20).attr("x2",200).attr("y2",380).attr("stroke",n.mainAxisStrokeColor).attr("stroke-width",1.5),o.append("circle").attr("cx",200).attr("cy",200).attr("r",160).attr("fill","none").attr("stroke",n.circleStrokeColor).attr("stroke-width",2);let c=o.append("circle").attr("class","mood-button").attr("r",8).attr("fill",n.circleStrokeColor).attr("stroke","white").attr("stroke-width",2).style("cursor","grab"),h=o.append("text").attr("class","active-sector-label").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("font-size","14px").attr("font-weight","bold").attr("fill",n.textColor).style("pointer-events","none");function p(e){r.current=e,s.current=Math.floor(e/(Math.PI/4))%8;let i=200+160*Math.cos(e),a=200-160*Math.sin(e);if(c.attr("cx",i).attr("cy",a),u.attr("fill",t=>t.index===s.current?t.color:"transparent").attr("opacity",t=>t.index===s.current?.5:.2),s.current>=0&&n.sectorLabels[s.current]){let t=s.current*(Math.PI/4)+Math.PI/8,e=200+104*Math.cos(t),i=200-104*Math.sin(t);h.attr("x",e).attr("y",i).text(n.sectorLabels[s.current])}else h.text("");t&&t({x:Math.cos(e),y:Math.sin(e),sector:s.current,angle:180*e/Math.PI})}o.append("text").attr("x",200).attr("y",15).attr("text-anchor","middle").attr("font-size","13px").attr("font-weight","600").attr("fill",n.textColor).text("Arousal+"),o.append("text").attr("x",200).attr("y",395).attr("text-anchor","middle").attr("font-size","13px").attr("font-weight","600").attr("fill",n.textColor).text("Arousal-"),o.append("text").attr("x",395).attr("y",205).attr("text-anchor","end").attr("font-size","13px").attr("font-weight","600").attr("fill",n.textColor).text("Valence+"),o.append("text").attr("x",15).attr("y",205).attr("text-anchor","start").attr("font-size","13px").attr("font-weight","600").attr("fill",n.textColor).text("Valence-");let d=nI().on("start",function(t){nT(this).style("cursor","grabbing")}).on("drag",function(t){let e=nA(t,o.node()),n=e[0]-200,i=Math.atan2(-(e[1]-200),n);i<0&&(i+=2*Math.PI),p(i)}).on("end",function(){nT(this).style("cursor","grab")});c.call(d),p(r.current),a.attr("width",400).attr("height",400).style("font-family","Helvetica, Arial, sans-serif")},[t,n,i]),(0,k.jsx)("svg",{ref:e})},u0=({data:t,title:e,width:n=400,height:i=300})=>{let r=(0,E.useRef)(null);return(0,E.useEffect)(()=>{var e,s;if(!t||0===t.length)return;let a=nT(r.current);a.selectAll("*").remove();let o={top:20,right:30,bottom:40,left:50},l=n-o.left-o.right,u=i-o.top-o.bottom,c=a.attr("width",n).attr("height",i).append("g").attr("transform",`translate(${o.left},${o.top})`),h=Y(t)||0,p=J(t)||0,d=O(t),f=G().domain(d).thresholds(20)(t),m=iu().domain(d).range([0,l]),g=iu().domain([0,H(f,t=>t.length)||0]).range([u,0]);c.selectAll(".bar").data(f).enter().append("rect").attr("class","bar").attr("x",t=>m(t.x0||0)).attr("y",t=>g(t.length)).attr("width",t=>Math.max(0,m(t.x1||0)-m(t.x0||0)-1)).attr("height",t=>u-g(t.length)).attr("fill","#3b82f6").attr("fill-opacity",.7).attr("stroke","#1e40af").attr("stroke-width",1).on("mouseover",function(t,e){nT(this).attr("fill-opacity",.9);let n=nT("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("font-size","12px").style("pointer-events","none").style("opacity",0);n.transition().duration(200).style("opacity",1),n.html(`Range: ${e.x0?.toFixed(2)} - ${e.x1?.toFixed(2)}<br/>Count: ${e.length}`).style("left",t.pageX+10+"px").style("top",t.pageY-28+"px")}).on("mouseout",function(){nT(this).attr("fill-opacity",.7),ic(".tooltip").remove()});let v=(e=function(t){return function(e){return 1>=Math.abs(e/=.5)?.75*(1-e*e)/t:0}}(.5),s=m.ticks(100),function(t){return s.map(function(n){return[n,Y(t,function(t){return e(n-t)})||0]})})(t),y=i$().x(t=>m(t[0])).y(e=>g(e[1]*t.length*(d[1]-d[0])/20)).curve(iW);c.append("path").datum(v).attr("fill","none").attr("stroke","#dc2626").attr("stroke-width",2).attr("d",y),c.append("line").attr("x1",m(h)).attr("x2",m(h)).attr("y1",0).attr("y2",u).attr("stroke","#dc2626").attr("stroke-width",2).attr("stroke-dasharray","4,4"),c.append("line").attr("x1",m(p)).attr("x2",m(p)).attr("y1",0).attr("y2",u).attr("stroke","#16a34a").attr("stroke-width",2).attr("stroke-dasharray","4,4"),c.append("g").attr("transform",`translate(0,${u})`).call(tr(3,m)).append("text").attr("x",l/2).attr("y",35).attr("fill","black").style("text-anchor","middle").text("Gain"),c.append("g").call(tr(4,g)).append("text").attr("transform","rotate(-90)").attr("y",-35).attr("x",-u/2).attr("fill","black").style("text-anchor","middle").text("Frequency");let x=c.append("g").attr("transform",`translate(${l-120}, 20)`);x.append("line").attr("x1",0).attr("x2",15).attr("y1",0).attr("y2",0).attr("stroke","#dc2626").attr("stroke-width",2).attr("stroke-dasharray","4,4"),x.append("text").attr("x",20).attr("y",0).attr("dy","0.35em").attr("font-size","12px").text(`Mean: ${h.toFixed(2)}`),x.append("line").attr("x1",0).attr("x2",15).attr("y1",15).attr("y2",15).attr("stroke","#16a34a").attr("stroke-width",2).attr("stroke-dasharray","4,4"),x.append("text").attr("x",20).attr("y",15).attr("dy","0.35em").attr("font-size","12px").text(`Median: ${p.toFixed(2)}`)},[t,n,i]),(0,k.jsx)("div",{className:"w-full flex justify-center",children:(0,k.jsx)("svg",{ref:r})})},u1=({data:t,title:e,width:n=400,height:i=300})=>{let r=(0,E.useRef)(null);return(0,E.useEffect)(()=>{var e,s;if(!t||0===t.length)return;let a=nT(r.current);a.selectAll("*").remove();let o={top:20,right:30,bottom:40,left:50},l=n-o.left-o.right,u=i-o.top-o.bottom,c=a.attr("width",n).attr("height",i).append("g").attr("transform",`translate(${o.left},${o.top})`),h=Y(t)||0,p=J(t)||0,d=O(t),f=G().domain(d).thresholds(25)(t),m=iu().domain(d).range([0,l]),g=iu().domain([0,H(f,t=>t.length)||0]).range([u,0]);c.selectAll(".bar").data(f).enter().append("rect").attr("class","bar").attr("x",t=>m(t.x0||0)).attr("y",t=>g(t.length)).attr("width",t=>Math.max(0,m(t.x1||0)-m(t.x0||0)-1)).attr("height",t=>u-g(t.length)).attr("fill","#059669").attr("fill-opacity",.7).attr("stroke","#047857").attr("stroke-width",1).on("mouseover",function(t,e){nT(this).attr("fill-opacity",.9);let n=nT("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("font-size","12px").style("pointer-events","none").style("opacity",0);n.transition().duration(200).style("opacity",1),n.html(`Range: ${Math.round(e.x0||0)} - ${Math.round(e.x1||0)} BPM<br/>Count: ${e.length}`).style("left",t.pageX+10+"px").style("top",t.pageY-28+"px")}).on("mouseout",function(){nT(this).attr("fill-opacity",.7),ic(".tooltip").remove()});let v=(e=function(t){return function(e){return 1>=Math.abs(e/=2)?.75*(1-e*e)/t:0}}(2),s=m.ticks(100),function(t){return s.map(function(n){return[n,Y(t,function(t){return e(n-t)})||0]})})(t),y=i$().x(t=>m(t[0])).y(e=>g(e[1]*t.length*(d[1]-d[0])/25)).curve(iW);c.append("path").datum(v).attr("fill","none").attr("stroke","#dc2626").attr("stroke-width",2).attr("d",y),c.append("line").attr("x1",m(h)).attr("x2",m(h)).attr("y1",0).attr("y2",u).attr("stroke","#dc2626").attr("stroke-width",2).attr("stroke-dasharray","4,4"),c.append("line").attr("x1",m(p)).attr("x2",m(p)).attr("y1",0).attr("y2",u).attr("stroke","#16a34a").attr("stroke-width",2).attr("stroke-dasharray","4,4"),[{value:60,label:"Slow",color:"#6b7280"},{value:120,label:"Moderate",color:"#6b7280"},{value:180,label:"Fast",color:"#6b7280"}].forEach(t=>{t.value>=d[0]&&t.value<=d[1]&&(c.append("line").attr("x1",m(t.value)).attr("x2",m(t.value)).attr("y1",0).attr("y2",u).attr("stroke",t.color).attr("stroke-width",1).attr("stroke-dasharray","2,2").attr("opacity",.5),c.append("text").attr("x",m(t.value)).attr("y",-5).attr("text-anchor","middle").attr("font-size","10px").attr("fill",t.color).text(t.label))}),c.append("g").attr("transform",`translate(0,${u})`).call(tr(3,m).tickFormat(t=>`${t}`)).append("text").attr("x",l/2).attr("y",35).attr("fill","black").style("text-anchor","middle").text("BPM (Beats Per Minute)"),c.append("g").call(tr(4,g)).append("text").attr("transform","rotate(-90)").attr("y",-35).attr("x",-u/2).attr("fill","black").style("text-anchor","middle").text("Frequency");let x=c.append("g").attr("transform",`translate(${l-120}, 20)`);x.append("line").attr("x1",0).attr("x2",15).attr("y1",0).attr("y2",0).attr("stroke","#dc2626").attr("stroke-width",2).attr("stroke-dasharray","4,4"),x.append("text").attr("x",20).attr("y",0).attr("dy","0.35em").attr("font-size","12px").text(`Mean: ${h.toFixed(1)}`),x.append("line").attr("x1",0).attr("x2",15).attr("y1",15).attr("y2",15).attr("stroke","#16a34a").attr("stroke-width",2).attr("stroke-dasharray","4,4"),x.append("text").attr("x",20).attr("y",15).attr("dy","0.35em").attr("font-size","12px").text(`Median: ${p.toFixed(1)}`)},[t,n,i]),(0,k.jsx)("div",{className:"w-full flex justify-center",children:(0,k.jsx)("svg",{ref:r})})};process.env.NEXT_PUBLIC_BASE_PATH;let u2=[{id:"france",name:"France"},{id:"usa-south",name:"USA (South)"},{id:"argentina-latin-america",name:"Argentina/Latin America"},{id:"caribbean",name:"Caribbean"},{id:"brazil",name:"Brazil"},{id:"uk-scotland-ireland",name:"UK (Scotland/Ireland)"},{id:"germany",name:"Germany"},{id:"uk-england",name:"UK (England)"},{id:"mexico",name:"Mexico"},{id:"spain",name:"Spain"},{id:"nordic",name:"Nordic"},{id:"portugal",name:"Portugal"},{id:"italy",name:"Italy"},{id:"japan",name:"Japan"}],u3=[{emoji:"\uD83D\uDE22",percentage:15},{emoji:"\uD83D\uDE21",percentage:9},{emoji:"\uD83D\uDE0A❤️",percentage:55},{emoji:"\uD83D\uDE0A",percentage:4},{emoji:"\uD83D\uDE34",percentage:15}],u4=["Tenderness","Surprise","Excited","Fear","Anger","Sadness","Tired","Relaxed"],u5=[{key:"0-45 deg (e.g., Energetic/Joyful)",angle:22.5,label:"Energetic/Joyful"},{key:"45-90 deg (e.g., Excited/Surprised)",angle:67.5,label:"Excited/Surprised"},{key:"90-135 deg (e.g., Tense/Aggressive)",angle:112.5,label:"Tense/Aggressive"},{key:"135-180 deg (e.g., Angry/Frustrated)",angle:157.5,label:"Angry/Frustrated"},{key:"180-225 deg (e.g., Sad/Depressed)",angle:202.5,label:"Sad/Depressed"},{key:"225-270 deg (e.g., Bored/Tired)",angle:247.5,label:"Bored/Tired"},{key:"270-315 deg (e.g., Calm/Peaceful)",angle:292.5,label:"Calm/Peaceful"},{key:"315-360 deg (e.g., Content/Happy)",angle:337.5,label:"Content/Happy"}];function u8(){let[t,e]=(0,E.useState)("cultureToChord"),[n,i]=(0,E.useState)(null),[r,s]=(0,E.useState)(0),[a,o]=(0,E.useState)(0),[l,u]=(0,E.useState)(u2[0]),[c,h]=(0,E.useState)({}),[p,d]=(0,E.useState)({gain:[],bpm:[]}),[f,m]=(0,E.useState)("0-45 deg (e.g., Energetic/Joyful)"),g=(0,E.useCallback)(t=>{if(i({x:t.x,y:t.y}),o(t.angle),t.sector!==r){s(t.sector);let e=u5[t.sector]?.key;e&&c[e]&&e!==f&&(m(e),d(c[e]))}console.log("Page - Current Mood Data:",t)},[r,f,c]),v=(0,E.useCallback)(t=>{u(t)},[]);return(0,k.jsxs)("main",{className:M().main,children:[(0,k.jsx)("header",{className:M().brand,children:"Moved to the Core"}),(0,k.jsx)("h1",{className:M().title,children:"Welcome to your exploration of the music chords world"}),(0,k.jsxs)("div",{className:M().buttonContainer,children:[(0,k.jsx)("button",{className:`${M().button} ${"cultureToChord"===t?M().activeButton:""}`,onClick:()=>e("cultureToChord"),children:"Culture to Chord"}),(0,k.jsx)("button",{className:`${M().button} ${"moodToHarmony"===t?M().activeButton:""}`,onClick:()=>e("moodToHarmony"),children:"Mood to Harmony"})]}),"cultureToChord"===t&&(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)("section",{className:M().gallery,children:[(0,k.jsxs)("section",{className:M().genreExplorer,children:[(0,k.jsx)("h2",{className:M().genreExplorerTitle,children:"Choose a culture to explore!"}),(0,k.jsx)("div",{className:M().genreBubblesContainer,children:u2.map(t=>(0,k.jsx)("div",{className:`${M().bubble} ${M()[t.id]} ${l.id===t.id?M().selectedBubble:""}`,onClick:()=>v(t),style:{cursor:"pointer"},children:(0,k.jsx)("span",{className:M().genreName,children:t.name})},t.id))})]}),(0,k.jsxs)("section",{className:M().genreDetailPanel,children:[(0,k.jsxs)("h2",{className:M().detailPanelTitle,children:["Details for:\xa0",(0,k.jsx)("span",{className:M().selectedGenreNameText,children:l.name})]}),(0,k.jsxs)("div",{className:M().chordAndEmojiContainer,children:[(0,k.jsx)("div",{className:M().chordGraph,children:(0,k.jsx)(uK,{cultureId:l.id,width:400,height:300})}),(0,k.jsxs)("div",{className:M().emojiBoard,children:[(0,k.jsx)("h3",{className:M().panelSubTitle,children:"Emoji mood board of your selection"}),(0,k.jsx)("div",{className:M().emojiContainer,children:u3.map((t,e)=>(0,k.jsxs)("div",{className:M().emojiItem,children:[(0,k.jsx)("span",{className:M().emoji,children:t.emoji}),(0,k.jsxs)("span",{className:M().percentage,children:[t.percentage,"%"]})]},e))})]})]}),(0,k.jsxs)("div",{className:M().cultureInfo,children:[(0,k.jsxs)("h3",{className:M().panelSubTitle,children:["Musical characteristics of ",l.name]}),(0,k.jsxs)("div",{className:M().cultureDescription,children:[(0,k.jsxs)("p",{children:["Explore the unique chord progressions and harmonic patterns that define the musical traditions of ",l.name,". Click on any chord in the network above to hear how it sounds and discover the most common progressions used in this culture's music."]}),(0,k.jsxs)("div",{className:M().networkStats,children:[(0,k.jsxs)("div",{className:M().statItem,children:[(0,k.jsx)("strong",{children:"\uD83C\uDFB5 Interactive Network:"})," Click nodes to play chords"]}),(0,k.jsxs)("div",{className:M().statItem,children:[(0,k.jsx)("strong",{children:"\uD83D\uDCCA Data-Driven:"})," Based on analysis of popular songs"]}),(0,k.jsxs)("div",{className:M().statItem,children:[(0,k.jsx)("strong",{children:"\uD83D\uDD17 Chord Transitions:"})," Arrow thickness shows probability"]})]})]})]})]})]})}),"moodToHarmony"===t&&(0,k.jsx)(k.Fragment,{children:(0,k.jsx)("section",{className:M().gallery,children:(0,k.jsxs)("div",{className:M().moodToHarmonyLayout,children:[(0,k.jsx)("div",{className:M().leftBox,children:(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%"},children:[(0,k.jsx)("div",{style:{marginBottom:"2rem"},children:(0,k.jsx)(uJ,{onMoodChange:g})}),(0,k.jsxs)("div",{style:{width:"100%",maxWidth:"400px",padding:"20px",backgroundColor:"#e6f0fa",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)"},children:[(0,k.jsx)("h3",{style:{marginTop:"0",marginBottom:"15px",fontSize:"1.2rem",color:"#1a365d",textAlign:"center"},children:"Current Mood State"}),n?(0,k.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.6"},children:[(0,k.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,k.jsx)("strong",{children:"Sector:"})," ",u4[r]," (#",r+1,")"]}),(0,k.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,k.jsx)("strong",{children:"Angle:"})," ",a.toFixed(1),"\xb0"]}),(0,k.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,k.jsx)("strong",{children:"X:"})," ",n.x.toFixed(3)," | ",(0,k.jsx)("strong",{children:"Y:"})," ",n.y.toFixed(3)]}),(0,k.jsxs)("div",{style:{marginTop:"15px",padding:"12px",backgroundColor:"rgba(255,255,255,0.7)",borderRadius:"6px"},children:[(0,k.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"1rem"},children:"Suggested Music Features:"}),0===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Tender, warm melodies"}),1===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Bright, surprising elements"}),2===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Fast-paced, high-energy music"}),3===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Tense, suspenseful sounds"}),4===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Intense, fiery music"}),5===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Slow, emotionally rich music"}),6===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Low-energy, reflective tunes"}),7===r&&(0,k.jsx)("p",{style:{margin:"0"},children:"\uD83C\uDFB5 Soothing, relaxing rhythms"})]})]}):(0,k.jsx)("p",{style:{textAlign:"center",color:"#666"},children:"Please drag the button on the circle to select a mood state."})]})]})}),(0,k.jsxs)("div",{className:M().rightColumn,children:[(0,k.jsxs)("div",{className:M().rightTopBox,style:{backgroundColor:"#e6f0fa",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",marginBottom:"1.5rem",minHeight:"300px"},children:[(0,k.jsx)("h3",{style:{marginTop:"0",marginBottom:"15px",textAlign:"center",fontSize:"1.2rem",color:"#1a365d"},children:"Gain Distribution"}),p.gain.length>0?(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,k.jsx)(u0,{data:p.gain,title:u5[r]?.label||"Selected Emotion",width:400,height:220})}):(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#666",flexDirection:"column"},children:[(0,k.jsx)("p",{children:"Loading gain data..."}),(0,k.jsxs)("small",{children:["Sector: ",r,", Data length: ",p.gain.length]})]})]}),(0,k.jsxs)("div",{className:M().rightBottomBox,style:{backgroundColor:"#e6f0fa",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",minHeight:"300px"},children:[(0,k.jsx)("h3",{style:{marginTop:"0",marginBottom:"15px",textAlign:"center",fontSize:"1.2rem",color:"#1a365d"},children:"BPM Distribution"}),p.bpm.length>0?(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,k.jsx)(u1,{data:p.bpm,title:u5[r]?.label||"Selected Emotion",width:400,height:220})}):(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#666",flexDirection:"column"},children:[(0,k.jsx)("p",{children:"Loading BPM data..."}),(0,k.jsxs)("small",{children:["Sector: ",r,", Data length: ",p.bpm.length]})]})]})]})]})})}),(0,k.jsxs)("footer",{className:M().contactSection,children:[(0,k.jsx)("h3",{className:M().contactTitle,children:"Contact information"}),(0,k.jsxs)("div",{className:M().contactBox,children:[(0,k.jsx)("p",{className:M().teamName,children:"Team Apple-Pie-Chart"}),(0,k.jsxs)("ul",{className:M().memberList,children:[(0,k.jsxs)("li",{children:["Yiwei\xa0Liu ：",(0,k.jsx)("a",{href:"mailto:blabla@blabla.com",children:"blabla@blabla.com"})]}),(0,k.jsxs)("li",{children:["Tianhao\xa0Dai ：",(0,k.jsx)("a",{href:"mailto:blibli@blibli.com",children:"blibli@blibli.com"})]}),(0,k.jsxs)("li",{children:["Ewan\xa0Golfier ：",(0,k.jsx)("a",{href:"mailto:bloblo@bloblo.com",children:"bloblo@bloblo.com"})]})]})]})]})]})}},6341:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{getPreviouslyRevalidatedTags:function(){return v},getUtils:function(){return g},interpolateDynamicPath:function(){return f},normalizeDynamicRouteParams:function(){return m},normalizeVercelUrl:function(){return d}});let i=n(9551),r=n(1959),s=n(2437),a=n(4396),o=n(8034),l=n(5526),u=n(2887),c=n(4722),h=n(6143),p=n(7912);function d(t,e,n){let r=(0,i.parse)(t.url,!0);for(let t of(delete r.search,Object.keys(r.query))){let i=t!==h.NEXT_QUERY_PARAM_PREFIX&&t.startsWith(h.NEXT_QUERY_PARAM_PREFIX),s=t!==h.NEXT_INTERCEPTION_MARKER_PREFIX&&t.startsWith(h.NEXT_INTERCEPTION_MARKER_PREFIX);(i||s||e.includes(t)||n&&Object.keys(n.groups).includes(t))&&delete r.query[t]}t.url=(0,i.format)(r)}function f(t,e,n){if(!n)return t;for(let i of Object.keys(n.groups)){let r,{optional:s,repeat:a}=n.groups[i],o=`[${a?"...":""}${i}]`;s&&(o=`[${o}]`);let l=e[i];r=Array.isArray(l)?l.map(t=>t&&encodeURIComponent(t)).join("/"):l?encodeURIComponent(l):"",t=t.replaceAll(o,r)}return t}function m(t,e,n,i){let r={};for(let s of Object.keys(e.groups)){let a=t[s];"string"==typeof a?a=(0,c.normalizeRscURL)(a):Array.isArray(a)&&(a=a.map(c.normalizeRscURL));let o=n[s],l=e.groups[s].optional;if((Array.isArray(o)?o.some(t=>Array.isArray(a)?a.some(e=>e.includes(t)):null==a?void 0:a.includes(t)):null==a?void 0:a.includes(o))||void 0===a&&!(l&&i))return{params:{},hasValidParams:!1};l&&(!a||Array.isArray(a)&&1===a.length&&("index"===a[0]||a[0]===`[[...${s}]]`))&&(a=void 0,delete t[s]),a&&"string"==typeof a&&e.groups[s].repeat&&(a=a.split("/")),a&&(r[s]=a)}return{params:r,hasValidParams:!0}}function g({page:t,i18n:e,basePath:n,rewrites:i,pageIsDynamic:c,trailingSlash:h,caseSensitive:g}){let v,y,x;return c&&(v=(0,a.getNamedRouteRegex)(t,{prefixRouteKeys:!1}),x=(y=(0,o.getRouteMatcher)(v))(t)),{handleRewrites:function(a,o){let p={},d=o.pathname,f=i=>{let u=(0,s.getPathMatch)(i.source+(h?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!g});if(!o.pathname)return!1;let f=u(o.pathname);if((i.has||i.missing)&&f){let t=(0,l.matchHas)(a,o.query,i.has,i.missing);t?Object.assign(f,t):f=!1}if(f){let{parsedDestination:s,destQuery:a}=(0,l.prepareDestination)({appendParamsToQuery:!0,destination:i.destination,params:f,query:o.query});if(s.protocol)return!0;if(Object.assign(p,a,f),Object.assign(o.query,s.query),delete s.query,Object.assign(o,s),!(d=o.pathname))return!1;if(n&&(d=d.replace(RegExp(`^${n}`),"")||"/"),e){let t=(0,r.normalizeLocalePath)(d,e.locales);d=t.pathname,o.query.nextInternalLocale=t.detectedLocale||f.nextInternalLocale}if(d===t)return!0;if(c&&y){let t=y(d);if(t)return o.query={...o.query,...t},!0}}return!1};for(let t of i.beforeFiles||[])f(t);if(d!==t){let e=!1;for(let t of i.afterFiles||[])if(e=f(t))break;if(!e&&!(()=>{let e=(0,u.removeTrailingSlash)(d||"");return e===(0,u.removeTrailingSlash)(t)||(null==y?void 0:y(e))})()){for(let t of i.fallback||[])if(e=f(t))break}}return p},defaultRouteRegex:v,dynamicRouteMatcher:y,defaultRouteMatches:x,getParamsFromRouteMatches:function(t){if(!v)return null;let{groups:e,routeKeys:n}=v,i=(0,o.getRouteMatcher)({re:{exec:t=>{let i=Object.fromEntries(new URLSearchParams(t));for(let[t,e]of Object.entries(i)){let n=(0,p.normalizeNextQueryParam)(t);n&&(i[n]=e,delete i[t])}let r={};for(let t of Object.keys(n)){let s=n[t];if(!s)continue;let a=e[s],o=i[t];if(!a.optional&&!o)return null;r[a.pos]=o}return r}},groups:e})(t);return i||null},normalizeDynamicRouteParams:(t,e)=>v&&x?m(t,v,x,e):{params:{},hasValidParams:!1},normalizeVercelUrl:(t,e)=>d(t,e,v),interpolateDynamicPath:(t,e)=>f(t,e,v)}}function v(t,e){return"string"==typeof t[h.NEXT_CACHE_REVALIDATED_TAGS_HEADER]&&t[h.NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER]===e?t[h.NEXT_CACHE_REVALIDATED_TAGS_HEADER].split(","):[]}},6415:t=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var e={};(()=>{e.parse=function(e,n){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var r={},s=e.split(i),a=(n||{}).decode||t,o=0;o<s.length;o++){var l=s[o],u=l.indexOf("=");if(!(u<0)){var c=l.substr(0,u).trim(),h=l.substr(++u,l.length).trim();'"'==h[0]&&(h=h.slice(1,-1)),void 0==r[c]&&(r[c]=function(t,e){try{return e(t)}catch(e){return t}}(h,a))}}return r},e.serialize=function(t,e,i){var s=i||{},a=s.encode||n;if("function"!=typeof a)throw TypeError("option encode is invalid");if(!r.test(t))throw TypeError("argument name is invalid");var o=a(e);if(o&&!r.test(o))throw TypeError("argument val is invalid");var l=t+"="+o;if(null!=s.maxAge){var u=s.maxAge-0;if(isNaN(u)||!isFinite(u))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(u)}if(s.domain){if(!r.test(s.domain))throw TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!r.test(s.path))throw TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if("function"!=typeof s.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var t=decodeURIComponent,n=encodeURIComponent,i=/; */,r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),t.exports=e})()},6759:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"parseUrl",{enumerable:!0,get:function(){return s}});let i=n(2785),r=n(3736);function s(t){if(t.startsWith("/"))return(0,r.parseRelativeUrl)(t);let e=new URL(t);return{hash:e.hash,hostname:e.hostname,href:e.href,pathname:e.pathname,port:e.port,protocol:e.protocol,query:(0,i.searchParamsToUrlQuery)(e.searchParams),search:e.search}}},7733:()=>{},8005:()=>{},8034:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getRouteMatcher",{enumerable:!0,get:function(){return r}});let i=n(4827);function r(t){let{re:e,groups:n}=t;return t=>{let r=e.exec(t);if(!r)return!1;let s=t=>{try{return decodeURIComponent(t)}catch(t){throw Object.defineProperty(new i.DecodeError("failed to decode param"),"__NEXT_ERROR_CODE",{value:"E528",enumerable:!1,configurable:!0})}},a={};for(let[t,e]of Object.entries(n)){let n=r[e.pos];void 0!==n&&(e.repeat?a[t]=n.split("/").map(t=>s(t)):a[t]=s(n))}return a}}},8212:(t,e,n)=>{"use strict";function i(t){return function(){let{cookie:e}=t;if(!e)return{};let{parse:i}=n(6415);return i(Array.isArray(e)?e.join("; "):e)}}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getCookieParser",{enumerable:!0,get:function(){return i}})},8304:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),!function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{DEFAULT_METADATA_ROUTE_EXTENSIONS:function(){return o},STATIC_METADATA_IMAGES:function(){return a},getExtensionRegexString:function(){return l},isMetadataPage:function(){return h},isMetadataRoute:function(){return p},isMetadataRouteFile:function(){return u},isStaticMetadataRoute:function(){return c}});let i=n(2958),r=n(4722),s=n(554),a={icon:{filename:"icon",extensions:["ico","jpg","jpeg","png","svg"]},apple:{filename:"apple-icon",extensions:["jpg","jpeg","png"]},favicon:{filename:"favicon",extensions:["ico"]},openGraph:{filename:"opengraph-image",extensions:["jpg","jpeg","png","gif"]},twitter:{filename:"twitter-image",extensions:["jpg","jpeg","png","gif"]}},o=["js","jsx","ts","tsx"],l=(t,e)=>e&&0!==e.length?`(?:\\.(${t.join("|")})|(\\.(${e.join("|")})))`:`(\\.(?:${t.join("|")}))`;function u(t,e,n){let r=(n?"":"?")+"$",s=`\\d?${n?"":"(-\\w{6})?"}`,o=[RegExp(`^[\\\\/]robots${l(e.concat("txt"),null)}${r}`),RegExp(`^[\\\\/]manifest${l(e.concat("webmanifest","json"),null)}${r}`),RegExp("^[\\\\/]favicon\\.ico$"),RegExp(`[\\\\/]sitemap${l(["xml"],e)}${r}`),RegExp(`[\\\\/]${a.icon.filename}${s}${l(a.icon.extensions,e)}${r}`),RegExp(`[\\\\/]${a.apple.filename}${s}${l(a.apple.extensions,e)}${r}`),RegExp(`[\\\\/]${a.openGraph.filename}${s}${l(a.openGraph.extensions,e)}${r}`),RegExp(`[\\\\/]${a.twitter.filename}${s}${l(a.twitter.extensions,e)}${r}`)],u=(0,i.normalizePathSep)(t);return o.some(t=>t.test(u))}function c(t){let e=t.replace(/\/route$/,"");return(0,s.isAppRouteRoute)(t)&&u(e,[],!0)&&"/robots.txt"!==e&&"/manifest.webmanifest"!==e&&!e.endsWith("/sitemap.xml")}function h(t){return!(0,s.isAppRouteRoute)(t)&&u(t,[],!1)}function p(t){let e=(0,r.normalizeAppPath)(t).replace(/^\/?app\//,"").replace("/[__metadata_id__]","").replace(/\/route$/,"");return"/"!==e[0]&&(e="/"+e),(0,s.isAppRouteRoute)(t)&&u(e,[],!1)}},8720:(t,e,n)=>{Promise.resolve().then(n.t.bind(n,6346,23)),Promise.resolve().then(n.t.bind(n,7924,23)),Promise.resolve().then(n.t.bind(n,5656,23)),Promise.resolve().then(n.t.bind(n,99,23)),Promise.resolve().then(n.t.bind(n,8243,23)),Promise.resolve().then(n.t.bind(n,8827,23)),Promise.resolve().then(n.t.bind(n,2763,23)),Promise.resolve().then(n.t.bind(n,7173,23))},9121:t=>{"use strict";t.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:t=>{"use strict";t.exports=require("url")}};var e=require("../webpack-runtime.js");e.C(t);var n=t=>e(e.s=t),i=e.X(0,[447,435],()=>n(561));module.exports=i})();